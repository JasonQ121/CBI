<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯„æ•°æ®ç®¡ç†åå°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 1400px;
            width: 100%;
            margin: 0 auto;
            padding: 40px;
        }

        h1 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
            font-size: 32px;
        }

        /* ç™»å½•ç•Œé¢ */
        #loginScreen {
            max-width: 400px;
            margin: 100px auto;
        }

        .login-form {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        input[type="password"],
        input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="password"]:focus,
        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
        }

        .error-message {
            color: #e74c3c;
            margin-top: 10px;
            font-size: 14px;
            text-align: center;
        }

        /* ç®¡ç†ç•Œé¢ */
        #adminScreen {
            display: none;
        }

        .stats-bar {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .stat-card {
            flex: 1;
            min-width: 200px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .stat-card .number {
            font-size: 32px;
            font-weight: bold;
        }

        .toolbar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .toolbar .btn {
            width: auto;
            padding: 10px 20px;
            font-size: 14px;
        }

        .search-box {
            flex: 1;
            min-width: 200px;
        }

        .search-box input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            background: #f5f5f5;
            font-weight: 600;
            color: #333;
            position: sticky;
            top: 0;
        }

        tr:hover {
            background: #f9f9f9;
        }

        .action-btns {
            display: flex;
            gap: 5px;
        }

        .action-btns .btn {
            padding: 6px 12px;
            font-size: 12px;
            width: auto;
        }

        /* è¯¦æƒ…æ¨¡æ€æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal-content {
            background: white;
            margin: 50px auto;
            padding: 30px;
            border-radius: 12px;
            max-width: 900px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            color: #333;
        }

        .close-btn {
            background: #e0e0e0;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background: #ccc;
        }

        .detail-section {
            margin-bottom: 25px;
        }

        .detail-section h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .detail-row {
            display: flex;
            padding: 10px;
            border-bottom: 1px solid #f0f0f0;
        }

        .detail-label {
            width: 150px;
            font-weight: 500;
            color: #666;
        }

        .detail-value {
            flex: 1;
            color: #333;
        }

        .score-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }

        .score-high {
            background: #d4edda;
            color: #155724;
        }

        .score-medium {
            background: #fff3cd;
            color: #856404;
        }

        .score-low {
            background: #f8d7da;
            color: #721c24;
        }

        /* é…ç½®æ¨¡æ€æ¡† */
        .config-section {
            margin-bottom: 20px;
        }

        .config-section label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 500;
        }

        .config-section input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
        }

        .config-section .help-text {
            color: #999;
            font-size: 12px;
            margin-top: 5px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ç™»å½•ç•Œé¢ -->
        <div id="loginScreen">
            <div class="login-form">
                <h1 style="margin-bottom: 30px;">ç®¡ç†å‘˜ç™»å½•</h1>
                <div class="form-group">
                    <label>å¯†ç </label>
                    <input type="password" id="passwordInput" placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç " autocomplete="off">
                </div>
                <button class="btn" onclick="handleLogin()">ç™»å½•</button>
                <div id="loginError" class="error-message"></div>
            </div>
        </div>

        <!-- ç®¡ç†ç•Œé¢ -->
        <div id="adminScreen">
            <h1>æµ‹è¯„æ•°æ®ç®¡ç†åå°</h1>
            
            <!-- ç»Ÿè®¡ä¿¡æ¯ -->
            <div class="stats-bar">
                <div class="stat-card">
                    <h3>æ€»æ•°æ®é‡</h3>
                    <div class="number" id="totalCount">0</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <h3>Bç«¯ä¸šåŠ¡</h3>
                    <div class="number" id="bCount">0</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
                    <h3>Cç«¯ä¸šåŠ¡</h3>
                    <div class="number" id="cCount">0</div>
                </div>
            </div>

            <!-- å·¥å…·æ  -->
            <div class="toolbar">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="æœç´¢å§“åã€å…¬å¸ã€ç”µè¯..." oninput="filterData()">
                </div>
                <button class="btn btn-secondary" onclick="exportToJSON()">å¯¼å‡ºJSON</button>
                <button class="btn btn-secondary" onclick="exportToCSV()">å¯¼å‡ºCSV</button>
                <button class="btn btn-success" onclick="showFeishuConfig()">å¯¼å‡ºåˆ°é£ä¹¦</button>
                <button class="btn btn-danger" onclick="clearAllData()">æ¸…ç©ºæ‰€æœ‰æ•°æ®</button>
                <button class="btn" onclick="logout()">é€€å‡ºç™»å½•</button>
            </div>

            <!-- æ•°æ®è¡¨æ ¼ -->
            <div style="overflow-x: auto;">
                <table id="dataTable">
                    <thead>
                        <tr>
                            <th>åºå·</th>
                            <th>æäº¤æ—¶é—´</th>
                            <th>å§“å</th>
                            <th>å…¬å¸åç§°</th>
                            <th>è”ç³»ç”µè¯</th>
                            <th>ä¸šåŠ¡ç±»å‹</th>
                            <th>CBIæŒ‡æ•°</th>
                            <th>ä¼ä¸šç±»å‹</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="dataTableBody">
                    </tbody>
                </table>
            </div>

            <div id="emptyState" class="empty-state" style="display: none;">
                <div class="empty-state-icon">ğŸ“­</div>
                <h3>æš‚æ— æ•°æ®</h3>
                <p>è¿˜æ²¡æœ‰å—æµ‹è€…æäº¤æ•°æ®</p>
            </div>
        </div>
    </div>

    <!-- è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>æ•°æ®è¯¦æƒ…</h2>
                <button class="close-btn" onclick="closeDetailModal()">Ã—</button>
            </div>
            <div id="detailContent"></div>
        </div>
    </div>

    <!-- é£ä¹¦é…ç½®æ¨¡æ€æ¡† -->
    <div id="feishuModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>é£ä¹¦å¤šç»´è¡¨æ ¼é…ç½®</h2>
                <button class="close-btn" onclick="closeFeishuModal()">Ã—</button>
            </div>
            <div class="config-section">
                <label>App ID</label>
                <input type="text" id="feishuAppId" placeholder="è¯·è¾“å…¥é£ä¹¦åº”ç”¨çš„App ID">
                <div class="help-text">åœ¨é£ä¹¦å¼€æ”¾å¹³å°åˆ›å»ºåº”ç”¨åè·å–</div>
            </div>
            <div class="config-section">
                <label>App Secret</label>
                <input type="password" id="feishuAppSecret" placeholder="è¯·è¾“å…¥é£ä¹¦åº”ç”¨çš„App Secret">
                <div class="help-text">åœ¨é£ä¹¦å¼€æ”¾å¹³å°åˆ›å»ºåº”ç”¨åè·å–</div>
            </div>
            <div class="config-section">
                <label>App Token</label>
                <input type="text" id="feishuAppToken" placeholder="è¯·è¾“å…¥å¤šç»´è¡¨æ ¼çš„App Token">
                <div class="help-text">åœ¨å¤šç»´è¡¨æ ¼URLä¸­å¯ä»¥æ‰¾åˆ°ï¼Œä¾‹å¦‚ï¼šbase/AppToken123</div>
            </div>
            <div class="config-section">
                <label>Table ID</label>
                <input type="text" id="feishuTableId" placeholder="è¯·è¾“å…¥æ•°æ®è¡¨çš„Table ID">
                <div class="help-text">åœ¨å¤šç»´è¡¨æ ¼URLä¸­å¯ä»¥æ‰¾åˆ°ï¼Œä¾‹å¦‚ï¼štable=TableId456</div>
            </div>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn btn-success" onclick="exportToFeishu()" style="flex: 1;">å¼€å§‹å¯¼å‡º</button>
                <button class="btn" onclick="closeFeishuModal()" style="flex: 0 0 auto; width: auto;">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <!-- Supabase å®¢æˆ·ç«¯åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Supabase é…ç½®æ–‡ä»¶ï¼ˆéœ€è¦ç”¨æˆ·è‡ªå·±åˆ›å»ºå¹¶å¡«å…¥å¯†é’¥ï¼‰ -->
    <script src="config.js"></script>

    <script>
        // é»˜è®¤å¯†ç ï¼ˆå¯ä»¥ä¿®æ”¹ï¼‰
        const ADMIN_PASSWORD = 'admin123';
        let allData = [];
        let filteredData = [];
        
        // Supabase å®¢æˆ·ç«¯åˆå§‹åŒ–ï¼ˆä½¿ç”¨ secret key ç”¨äºç®¡ç†åå°ï¼‰
        let supabaseAdmin = null;
           if (typeof window.SUPABASE_CONFIG !== 'undefined' && window.SUPABASE_CONFIG.url && window.SUPABASE_CONFIG.publishableKey) {
            try {
                supabaseAdmin = supabase.createClient(
                    window.SUPABASE_CONFIG.url,
                    window.SUPABASE_CONFIG.publishableKey
                );
                console.log('Supabase ç®¡ç†å®¢æˆ·ç«¯åˆå§‹åŒ–æˆåŠŸ');
            } catch (error) {
                console.error('Supabase ç®¡ç†å®¢æˆ·ç«¯åˆå§‹åŒ–å¤±è´¥:', error);
            }
        } else {
            console.warn('Supabase é…ç½®æœªæ‰¾åˆ°ï¼Œå°†ä½¿ç”¨ localStorage ä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ');
        }

        // ç»´åº¦æ˜ å°„
        const dimensionNameMap = {
            'éœ€æ±‚ç»“æ„': { name: 'éœ€æ±‚', index: 0 },
            'ä»·å€¼ç»“æ„': { name: 'ä»·å€¼', index: 1 },
            'æ¸ é“ç»“æ„': { name: 'æ¸ é“', index: 2 },
            'å£å’ç»“æ„': { name: 'å£å’', index: 3 },
            'ç®¡ç†ç»“æ„': { name: 'ç®¡ç†', index: 4 },
            'èƒ½åŠ›ç»“æ„': { name: 'èƒ½åŠ›', index: 5 },
            'æ¿€åŠ±ç»“æ„': { name: 'æ¿€åŠ±', index: 6 },
            'ç«äº‰å£å’': { name: 'å£å’', index: 3 },
            'æ•°å­—åŒ–è½¬å‹': { name: 'æ•°å­—åŒ–è½¬å‹', index: 7 }
        };

        // Bç«¯ä¸šåŠ¡é¢˜ç›®æ•°æ®
        const tobQuestionsData = {
            "Bç«¯ä¸šåŠ¡è‡ªæµ‹é¢˜": [
                {
                    "dimension": "éœ€æ±‚ç»“æ„",
                    "questions": [
                        "é’ˆå¯¹æ ¸å¿ƒå¤§å®¢æˆ·ï¼Œä¸šåŠ¡å›¢é˜Ÿä¼šä¹¦é¢ç»˜åˆ¶è¯¦å°½çš„\"ç»„ç»‡å½±å“å›¾è°±\"ï¼Œä¸ä»…åŒ…å«é‡‡è´­äººä¿¡æ¯ï¼Œæ›´æ¸…æ™°æ ‡æ³¨äº†å†³ç­–è€…ï¼ˆæ‹æ¿äººï¼‰ã€å½±å“è€…ï¼ˆæŠ€æœ¯æˆ–è´¢åŠ¡ï¼‰ã€ä½¿ç”¨è€…ï¼ˆä¸€çº¿äººå‘˜ï¼‰å„è‡ªçš„åˆ©ç›Šè¯‰æ±‚ã€æ‹…å¿§ç‚¹åŠæ€§æ ¼åå¥½ï¼Œå¹¶ä»¥æ­¤åˆ¶å®šå¯¹åº”çš„å…¬å…³å’Œäº¤ä»˜ç­–ç•¥ã€‚",
                        "ä¸šåŠ¡å›¢é˜Ÿä¸ä»…å…³æ³¨äº§å“é”€å”®ï¼Œè¿˜æŠ•å…¥ä¸“é—¨ç²¾åŠ›ç ”ç©¶å¤§å®¢æˆ·æ‰€å¤„çš„è¡Œä¸šè¶‹åŠ¿åŠç«äº‰å¯¹æ‰‹åŠ¨æ€ã€‚æˆ‘ä»¬èƒ½ä¸»åŠ¨å‘å®¢æˆ·æä¾›å…·æœ‰è¡Œä¸šæ´å¯ŸåŠ›çš„å¢å€¼ä¿¡æ¯æˆ–é£é™©é¢„è­¦ï¼Œä½¿å…¶æ„Ÿå—åˆ°æˆ‘ä»¬æ˜¯åœ¨å¸®ä»–ä»¬\"è§£å†³ä¸šåŠ¡å¢é•¿é—®é¢˜\"ï¼Œè€Œä¸ä»…æ˜¯\"æä¾›ä¸€ä¸ªå·¥å…·\"ã€‚",
                        "å›¢é˜Ÿåœ¨æ¥è§¦å®¢æˆ·æ—¶ï¼Œä¸ä»…å…³æ³¨äº§å“åŠŸèƒ½ï¼Œè¿˜ä¼šé€šè¿‡æ ‡å‡†çš„è®¿è°ˆæˆ–è°ƒç ”å·¥å…·ï¼Œä¸»åŠ¨æŒ–æ˜è¯¥å®¢æˆ·ä¸åŒå±‚çº§çš„çœŸå®è¯‰æ±‚ï¼ˆä¾‹å¦‚ï¼šé‡‡è´­å…³æ³¨\"åˆè§„ä¸æ¯”ä»·\"ã€æŠ€æœ¯å…³æ³¨\"å‚æ•°ä¸ç¨³å®šæ€§\"ã€è€æ¿å…³æ³¨\"å¯¹æˆ˜ç•¥çš„æ”¯æ’‘\"ï¼‰ï¼Œå¹¶å½¢æˆæ¸…æ™°çš„\"å®¢æˆ·ä»·å€¼éœ€æ±‚æ¸…å•\"ã€‚"
                    ]
                },
                {
                    "dimension": "ä»·å€¼ç»“æ„",
                    "questions": [
                        "å›¢é˜Ÿåœ¨å‘å®¢æˆ·ææ¡ˆæˆ–äº¤ä»˜æ—¶ï¼Œèƒ½å¤Ÿæ‹¿å‡ºä¸€å¥—é€»è¾‘ä¸¥å¯†çš„\"æ”¶ç›Šè®¡ç®—æ¨¡å‹\"ï¼Œæ¸…æ™°å±•ç¤ºæˆ‘ä»¬çš„äº§å“å¦‚ä½•å¸®å®¢æˆ·çœäº†å¤šå°‘é’±ã€æäº†å¤šå°‘æ•ˆæˆ–é¿äº†å¤šå°‘å‘ï¼Œè€Œä¸æ˜¯ä»…é æ„Ÿæ€§çš„\"è´¨é‡å¥½ã€ä¿¡èª‰å¥½\"æ¥æ‰“åŠ¨å®¢æˆ·ã€‚",
                        "å…¬å¸é’ˆå¯¹å‘ç°çš„å·®å¼‚åŒ–ä»·å€¼è¯‰æ±‚ï¼Œå…·å¤‡çµæ´»çš„è§£å†³æ–¹æ¡ˆåº“ã€‚æˆ‘ä»¬èƒ½å¤Ÿåƒ\"æ­ç§¯æœ¨\"ä¸€æ ·ï¼Œæ ¹æ®å®¢æˆ·å…·ä½“çš„ç—›ç‚¹ï¼ˆå¦‚ï¼šæ˜¯è¿½æ±‚æˆæœ¬æè‡´èŠ‚çº¦ï¼Œè¿˜æ˜¯è¿½æ±‚æŠ€æœ¯é¢†å…ˆï¼Œæˆ–æ˜¯è¿½æ±‚å”®åæ— å¿§ï¼‰ï¼Œä»äº§å“å’ŒæœåŠ¡ä¸­å¿«é€Ÿç»„åˆå‡ºæœ€å¥‘åˆå¯¹æ–¹çš„å·®å¼‚åŒ–æ–¹æ¡ˆï¼Œè€Œéæ¨é”€å•ä¸€çš„æ ‡å‡†åŒ–æ–¹æ¡ˆã€‚",
                        "åœ¨é¢å¯¹ç«äº‰æ—¶ï¼Œå›¢é˜Ÿèƒ½å¤Ÿé’ˆå¯¹è¯¥å®¢æˆ·æœ€æ ¸å¿ƒçš„\"ç—›ç‚¹ç‚¹ä½\"ï¼Œæ‹¿å‡ºä¸“é—¨çš„è®ºè¯æ–¹æ¡ˆæˆ–å®æµ‹æ•°æ®ï¼Œå‘å®¢æˆ·è¯æ˜ï¼š\"åœ¨æ‚¨æœ€å…³å¿ƒçš„è¿™1-2ä¸ªé—®é¢˜ä¸Šï¼Œæˆ‘ä»¬æ˜¯å¦‚ä½•åšåˆ°æ¯”åŒè¡Œæ›´æœ‰é’ˆå¯¹æ€§ã€æ•ˆæœæ›´å¥½çš„\"ã€‚è¿™ç§\"ç‚¹å¯¹ç‚¹\"çš„ä»·å€¼è¯æ˜å·²æˆä¸ºæˆ‘ä»¬çš„ç«æ ‡æ ‡å‡†åŠ¨ä½œã€‚"
                    ]
                },
                {
                    "dimension": "æ¸ é“ç»“æ„",
                    "questions": [
                        "å›¢é˜Ÿä¸ä»…æ˜¯åœ¨æ‰¾\"æ„å‘å…¬å¸\"ï¼Œæ›´æ˜¯åœ¨å¯»æ‰¾è§¦è¾¾\"å…³é”®å†³ç­–äººï¼ˆDMUï¼‰\"çš„æœ‰æ•ˆè·¯å¾„ã€‚æˆ‘ä»¬ä¼šé€šè¿‡è¡Œä¸šä¸“å®¶èƒŒä¹¦ã€ä¸Šä¸‹æ¸¸åˆä½œä¼™ä¼´å¼•èã€æˆ–é«˜è´¨é‡çš„çº¿ä¸‹é—­é—¨äº¤æµä¼šç­‰æ–¹å¼ï¼Œå»ºç«‹ä¸å†³ç­–å±‚çš„é«˜é¢‘è¿æ¥ï¼Œè€Œéå•çº¯ä¾èµ–æ¯ç‡¥çš„ç”µè¯æ¨é”€æˆ–é™Œç”Ÿæ‹œè®¿ã€‚",
                        "å…¬å¸å®šæœŸï¼ˆå¦‚æ¯æœˆ/æ¯å­£ï¼‰åœ¨å®¢æˆ·å…³æ³¨çš„ä¸“ä¸šåª’ä½“ã€è¡Œä¸šåä¼šæˆ–æŠ€æœ¯è®ºå›ä¸Šå‘å¸ƒæ¡ˆä¾‹ã€æ·±åº¦æ–‡ç« æˆ–æ¼”è®²ï¼Œå°†å…¬å¸åŒ…è£…æˆè¯¥ç»†åˆ†é¢†åŸŸçš„\"ä¸“å®¶\"æˆ–\"æ ‡å‡†åˆ¶å®šè€…\"ï¼Œä»è€Œè®©ç²¾å‡†çš„æ½œåœ¨å®¢æˆ·åœ¨äº§ç”Ÿéœ€æ±‚æ—¶ï¼Œèƒ½ä¸»åŠ¨é€šè¿‡ä¸“ä¸šæ¸ é“æ‰¾åˆ°æˆ‘ä»¬ã€‚",
                        "å…¬å¸å»ºç«‹äº†ä¸€å¥—æ ‡å‡†çš„\"è€å¸¦æ–°\"æˆ–\"æˆ˜ç•¥ä¼™ä¼´\"å¥–åŠ±æœºåˆ¶ï¼Œä¸šåŠ¡å›¢é˜Ÿä¼šå®šæœŸå¯¹æ»¡æ„åº¦é«˜çš„è€å®¢æˆ·è¿›è¡Œæ·±åº¦ç»è¥ï¼Œå°†å…¶è½¬åŒ–ä¸ºæˆ‘ä»¬çš„\"å¤–éƒ¨æ¨èå®˜\"ï¼Œé€šè¿‡ä»–ä»¬çš„åœˆå­æ¸—é€åˆ°åŒç±»å‹çš„ç²¾å‡†æ–°å®¢æˆ·ä¸­ï¼Œä½¿\"å…³ç³»é“¾\"æˆä¸ºæœ€ä½æˆæœ¬ä¸”æœ€ç²¾å‡†çš„è·å®¢æ¸ é“ã€‚"
                    ]
                },
                {
                    "dimension": "ç®¡ç†ç»“æ„",
                    "questions": [
                        "é’ˆå¯¹æ—¥å¸¸ä¸šåŠ¡ä¸­çš„çªå‘çŠ¶å†µï¼ˆå¦‚å®¢æˆ·æŠ•è¯‰ã€ç´§æ€¥è°ƒè´§ã€æ–¹æ¡ˆå¾®è°ƒï¼‰ï¼Œå…¬å¸å·²å½¢æˆæ¸…æ™°çš„\"æˆæƒæ‰‹å†Œ\"ï¼Œä¸€çº¿ä¸»ç®¡æˆ–ä¸šåŠ¡å‘˜æ— éœ€å±‚å±‚è¯·ç¤ºå³å¯åœ¨è§„å®šæƒé™å†…è‡ªä¸»å†³ç­–ï¼Œç¡®ä¿å“åº”é€Ÿåº¦èƒ½å¤Ÿè·‘èµ¢ç«äº‰å¯¹æ‰‹ã€‚",
                        "å†…éƒ¨ä¿¡æ¯æµè½¬é€æ˜ï¼Œä¸åŒéƒ¨é—¨ï¼ˆå¦‚é”€å”®ä¸äº¤ä»˜ã€å¸‚åœºä¸è´¢åŠ¡ï¼‰ä¹‹é—´ä¸å†ä¾èµ–æ¼«é•¿çš„\"å…¬æ–‡/é‚®ä»¶æµè½¬\"æˆ–è€æ¿åè°ƒï¼Œè€Œæ˜¯å›´ç»•å…·ä½“çš„\"å®¢æˆ·é¡¹ç›®\"å»ºç«‹ä¸´æ—¶å°ç»„ï¼Œé€šè¿‡é«˜é¢‘ã€éæ­£å¼çš„æ²Ÿé€šå¿«é€Ÿè§£å†³é—®é¢˜ã€‚",
                        "å…¬å¸ç®¡ç†å±‚ä¼šå®šæœŸï¼ˆå¦‚æ¯åŠå¹´ï¼‰å¸¦é¢†æ ¸å¿ƒå‘˜å·¥å…±åŒå®¡è§†ç°æœ‰çš„ç®¡ç†è§„å®šå’Œä¸šåŠ¡æµç¨‹ï¼Œä¸»åŠ¨ç æ‰é‚£äº›\"ä¸ºäº†ç®¡ç†è€Œç®¡ç†\"ã€å¯¹å®¢æˆ·ä»·å€¼å’Œå·¥ä½œæ•ˆç‡æ²¡æœ‰è´¡çŒ®çš„å†—ä½™ç¯èŠ‚ï¼Œä¿æŒç»„ç»‡çš„\"è½»é‡åŒ–\"è¿ä½œã€‚"
                    ]
                },
                {
                    "dimension": "èƒ½åŠ›ç»“æ„",
                    "questions": [
                        "å…¬å¸èƒ½å¤Ÿæ¸…æ™°ç•Œå®šå“ªäº›æ˜¯åº•å±‚æ ¸å¿ƒèƒ½åŠ›ï¼ˆå¦‚ï¼šç‰¹æ®Šçš„ç”Ÿäº§å·¥è‰ºã€å¤§å®¢æˆ·ç»è¥æ–¹æ³•è®ºç­‰ï¼‰ï¼Œå¹¶æŠ•å…¥é‡é‡‘è‡ªå»ºå›¢é˜Ÿã€‚åŒæ—¶ï¼Œè¿™äº›èƒ½åŠ›å·²è¢«æç‚¼ä¸ºå¯å¤åˆ¶çš„å†…éƒ¨æ•™ææˆ–SOPï¼ˆæ ‡å‡†ä½œä¸šç¨‹åºï¼‰ï¼Œä¸å› æŸä¸ªæ ¸å¿ƒå‘˜å·¥ç¦»èŒè€Œå¯¼è‡´èƒ½åŠ›ä¸§å¤±ã€‚",
                        "å›¢é˜Ÿå…·å¤‡æå¼ºçš„\"ä¸ä¸ºæˆ‘æ‰€æœ‰ï¼Œä½†ä¸ºæˆ‘æ‰€ç”¨\"çš„å¼€æ”¾æ„è¯†ã€‚å¯¹äºéæ ¸å¿ƒç¯èŠ‚ï¼ˆå¦‚ï¼šå“ç‰Œè®¾è®¡ã€åŸºç¡€ç ”å‘æ”¯æŒã€åœ°æ¨å›¢é˜Ÿç­‰ï¼‰ï¼Œèƒ½å¤Ÿå¨´ç†Ÿåœ°é€šè¿‡å¤–åŒ…ã€æˆ˜ç•¥åˆä½œã€å’¨è¯¢é¡¾é—®ç­‰æ–¹å¼å€Ÿç”¨å¤–éƒ¨é«˜æ°´å¹³èµ„æºï¼Œä»¥æä½æˆæœ¬å®ç°ç»„ç»‡åŠŸèƒ½çš„æ‰©å……ã€‚",
                        "å…¬å¸å…·å¤‡ç³»ç»Ÿçš„\"åå­—å‹\"äººæ‰åŸ¹å…»è®¡åˆ’ã€‚å‘˜å·¥ä¸ä»…åœ¨æœ¬èŒå²—ä½ä¸“ä¸šï¼Œè¿˜è¢«é¼“åŠ±é€šè¿‡å†…éƒ¨è½®å²—æˆ–äº¤å‰åŸ¹è®­ï¼ŒæŒæ¡ç›¸é‚»å²—ä½çš„åŸºæœ¬é€»è¾‘ï¼Œä»è€Œåœ¨ä¸šåŠ¡é«˜å³°æœŸå®ç°å›¢é˜Ÿå†…éƒ¨çš„çµæ´»è°ƒåº¦ã€‚"
                    ]
                },
                {
                    "dimension": "æ¿€åŠ±ç»“æ„",
                    "questions": [
                        "å¥–é‡‘å‘æ”¾ä¸åªçœ‹å•ä¸€çš„ä¸šç»©æŒ‡æ ‡ï¼Œè€Œæ˜¯ä¸\"å…¬å¸æˆ˜ç•¥ç›®æ ‡é«˜åº¦æŒ‚é’©ã€‚ä¾‹å¦‚ï¼šæˆåŠŸå¼€å‘å‡ºç¬¦åˆ\"éœ€æ±‚ç»“æ„\"çš„æˆ˜ç•¥çº§æ–°å®¢æˆ·ï¼Œæˆ–äº¤ä»˜äº†å…·æœ‰\"å·®å¼‚åŒ–ä»·å€¼\"çš„é¡¹ç›®ï¼Œä¼šæœ‰é¢å¤–çš„å¥–åŠ±æƒé‡ã€‚",
                        "å…¬å¸æ•¢äºæ‹‰å¼€æ¿€åŠ±å·®è·ï¼Œå»ºç«‹\"èƒ½è€…æå¤šå¾—\"çš„åˆ†é…æœºåˆ¶ã€‚åœ¨åŒä¸€èŒçº§å†…ï¼Œå‰20%çš„é¡¶å°–äººæ‰ä¸å¹³å‡æ°´å¹³çš„æŠ¥é…¬å·®è·è¶³å¤Ÿå¤§ï¼Œç¡®ä¿å…¬å¸èµ„æºé›†ä¸­å¥–åŠ±é‚£äº›çœŸæ­£ä¸º\"ç«äº‰å£å’\"åšå‡ºè´¡çŒ®çš„æ ¸å¿ƒéª¨å¹²ï¼Œè€Œéå¹³å‡ç”¨åŠ›ã€‚",
                        "æ¿€åŠ±ä¸ä»…é™äºé’±ã€‚å…¬å¸æœ‰ä¸€å¥—é’ˆå¯¹æ ¸å¿ƒäººæ‰çš„é•¿æœŸæ¿€åŠ±æ–¹æ¡ˆï¼ˆå¦‚ï¼šåˆä¼™äººæœºåˆ¶ã€ä¸“ä¸šè¿›ä¿®æœºä¼šã€å‚ä¸é‡å¤§å†³ç­–æƒç­‰ï¼‰ï¼Œè®©å‘˜å·¥æ¸…æ™°æ„ŸçŸ¥åˆ°ï¼šåœ¨è¿™é‡Œå¹²æ´»ï¼Œä¸ä»…æ˜¯èµšç°åœ¨çš„é’±ï¼Œè¿˜èƒ½é€šè¿‡ç»„ç»‡å¹³å°å®ç°ä¸ªäººèŒåœºä»·å€¼çš„æŒç»­æº¢ä»·ã€‚"
                    ]
                },
                {
                    "dimension": "æ•°å­—åŒ–è½¬å‹",
                    "questions": [
                        "ä»å®¢æˆ·åˆæ¬¡è§¦è¾¾ï¼ˆæ¸ é“ï¼‰ã€åˆ°åˆåŒæ‰§è¡Œï¼ˆä»·å€¼ï¼‰ã€å†åˆ°å”®åç»´æŠ¤ï¼Œæ¯ä¸€ä¸ªå…³é”®èŠ‚ç‚¹éƒ½æœ‰æ•°å­—ç³»ç»Ÿï¼ˆå¦‚CRMã€è¿›é”€å­˜æˆ–ç®€æ˜“è‡ªå»ºè¡¨ï¼‰å®æ—¶è®°å½•ã€‚ç®¡ç†å±‚èƒ½å¤Ÿéšæ—¶è°ƒå–çœŸå®çš„ä¸šåŠ¡è¿›åº¦å’Œè½¬åŒ–æ•°æ®ï¼Œè€Œéé€šè¿‡å¬å–ä¸‹å±å£å¤´æ±‡æŠ¥æ¥æŒæ¡æƒ…å†µã€‚",
                        "å…¬å¸çš„æ—¥å¸¸ç®¡ç†åŠ¨ä½œï¼ˆå¦‚ï¼šå®¡æ‰¹ã€è·¨éƒ¨é—¨åä½œã€çŸ¥è¯†å…±äº«ã€ä»»åŠ¡æŒ‡æ´¾ï¼‰å‡é€šè¿‡æ•°å­—åŒ–å·¥å…·ï¼ˆå¦‚ï¼šé’‰é’‰ã€é£ä¹¦ã€ä¼ä¸šå¾®ä¿¡æˆ–ä¸“ä¸šåŠå…¬ç³»ç»Ÿï¼‰æ²‰æ·€ã€‚ä¿¡æ¯æµè½¬ä¸å†ä¾èµ–äº\"äººæ‰¾äºº\"ï¼Œè€Œæ˜¯é€šè¿‡ç³»ç»Ÿå®ç°çš„è‡ªåŠ¨åŒ–æé†’å’Œè¿›åº¦è¿½è¸ªï¼Œæå¤§åœ°é™ä½äº†æ²Ÿé€šçš„\"æ‘©æ“¦åŠ›\"ã€‚",
                        "å…¬å¸ç§¯æå¼•å¯¼å‘˜å·¥ä½¿ç”¨å‰æ²¿æŠ€æœ¯å·¥å…·ï¼ˆå¦‚ï¼šAIå†™ä½œ/ç»˜å›¾è¾…åŠ©ã€è‡ªåŠ¨åŒ–è¥é”€æœºå™¨äººã€æ•°æ®åˆ†ææ’ä»¶ç­‰ï¼‰æ¥èµ‹èƒ½ä¸šåŠ¡ã€‚è¿™äº›å·¥å…·ä¸ä»…æé«˜äº†å‘˜å·¥çš„å•ä½äº§å‡ºï¼ˆäººæ•ˆï¼‰ï¼Œæ›´è®©åŸæœ¬éœ€è¦é«˜é˜¶ä¸“ä¸šäººæ‰æ‰èƒ½å®Œæˆçš„ä»»åŠ¡ï¼Œé€šè¿‡å·¥å…·è¾…åŠ©å˜æˆäº†æ™®é€šå‘˜å·¥ä¹Ÿèƒ½è¾¾åˆ°çš„æ ‡å‡†åŠ¨ä½œã€‚"
                    ]
                },
                {
                    "dimension": "ç«äº‰å£å’",
                    "questions": [
                        "å…¬å¸èƒ½å¤Ÿæ¸…æ™°è¯†åˆ«å‡ºå“ªäº›æ˜¯ç«äº‰å¯¹æ‰‹\"èŠ±é’±ä¹Ÿä¹°ä¸èµ°\"çš„æ ¸å¿ƒèµ„äº§ï¼ˆå¦‚ï¼šç‹¬ç‰¹çš„å“ç‰Œå¿ƒæ™ºã€ä¸“åˆ©æŠ€æœ¯ã€è¡Œä¸šæ ‡å‡†è¯è¯­æƒã€æˆ–è€…ç‹¬æœ‰çš„ç‰¹è®¸ç»è¥æƒï¼‰ï¼Œå¹¶æœ‰ä¸“é—¨çš„é¢„ç®—å’ŒåŠ¨ä½œå»æŒç»­å¼ºåŒ–ã€ä¿æŠ¤è¿™äº›èµ„äº§ï¼Œä½¿å…¶éšæ—¶é—´æ¨ç§»ä¸æ–­å¢åšã€‚",
                        "å…¬å¸åœ¨äº¤ä»˜äº§å“æˆ–æœåŠ¡çš„è¿‡ç¨‹ä¸­ï¼Œåˆ»æ„å¢åŠ äº†ä¸å®¢æˆ·çš„\"ç²˜æ€§æ·±åº¦\"ã€‚é€šè¿‡æœåŠ¡é›†æˆã€æ•°æ®è¿æ¥ã€ä¼šå‘˜æƒ…æ„Ÿè”ç»“æˆ–ä¸šåŠ¡æµç¨‹çš„æ·±åº¦åµŒå…¥ï¼Œä½¿å¾—å®¢æˆ·å¦‚æœè½¬å‘ç«äº‰å¯¹æ‰‹ï¼Œå°†é¢ä¸´æå¤§çš„æ—¶é—´æˆæœ¬ã€ç»æµæŸå¤±æˆ–å¿ƒç†å‹åŠ›ã€‚",
                        "å…¬å¸ä¸ä»…å…³æ³¨åˆ©æ¶¦ï¼Œæ›´å…³æ³¨\"æ•ˆç‡å£å’\"ã€‚æˆ‘ä»¬é€šè¿‡å·¥è‰ºæ”¹è¿›ã€ä¾›åº”é“¾ä¼˜åŒ–æˆ–ç»„ç»‡ææ•ˆï¼Œä½¿å¾—å…¬å¸åœ¨ç»´æŒåŒç­‰ä»·å€¼äº§å‡ºçš„å‰æä¸‹ï¼Œå…·å¤‡æ¯”è¡Œä¸šå¹³å‡æ°´å¹³æ›´ä½çš„æˆæœ¬ç»“æ„ï¼Œæˆ–è€…æ›´å¿«çš„å‘¨è½¬é€Ÿåº¦ï¼Œè®©å¯¹æ‰‹åœ¨å‘åŠ¨ä»·æ ¼æˆ˜æ—¶æ— ä»ä¸‹æ‰‹ã€‚"
                    ]
                }
            ]
        };

        // Cç«¯ä¸šåŠ¡é¢˜ç›®æ•°æ®
        const tocQuestionsData = [
            {
                "dimension": "éœ€æ±‚ç»“æ„",
                "questions": [
                    "å…¬å¸å»ºç«‹å¹¶è¿è¡Œç€ä¸€å¥—åŠ¨æ€çš„å®¢æˆ·æ•°æ®åº“ï¼Œèƒ½å¤ŸåŸºäºå®¢æˆ·çš„æ¶ˆè´¹è¡Œä¸ºã€ç”Ÿæ´»åœºæ™¯ã€æ½œåœ¨ç—›ç‚¹ç­‰å¤šç»´åº¦æ ‡ç­¾è¿›è¡Œç²¾ç»†åŒ–åˆ†ç±»ï¼ˆä¾‹å¦‚ï¼šä¸å†åªæ˜¯\"30å²å¥³æ€§\"ï¼Œè€Œæ˜¯\"æ³¨é‡å¥åº·ã€å¯¹æ·»åŠ å‰‚æ•æ„Ÿã€æœ‰æ™¨è·‘ä¹ æƒ¯çš„èŒåœºå®å¦ˆ\"ï¼‰ï¼Œä¸”å¸‚åœºåŠ¨ä½œä¼šæ ¹æ®ä¸åŒæ ‡ç­¾äººç¾¤è¿›è¡Œå·®å¼‚åŒ–å®šåˆ¶ã€‚",
                    "ç®¡ç†å±‚å’Œæ ¸å¿ƒä¸šåŠ¡å›¢é˜Ÿä¿æŒç€å®šæœŸèµ°è¿›ä¸€çº¿ï¼ˆå¦‚åº—é¢ã€ç¤¾ç¾¤æˆ–ç›´æ’­é—´ï¼‰çš„ä¹ æƒ¯ï¼Œç›´æ¥ä¸æ¶ˆè´¹è€…è¿›è¡Œæ·±åº¦äº¤æµæˆ–è§‚å¯Ÿå…¶è´­ä¹°è¡Œä¸ºï¼Œå¹¶å°†æ”¶é›†åˆ°çš„ç¬¬ä¸€æ‰‹åé¦ˆè½¬åŒ–ä¸ºå…·ä½“çš„\"äº§å“ä¼˜åŒ–æ¸…å•\"æˆ–\"æœåŠ¡æ”¹è¿›å»ºè®®\"ï¼Œè€Œéä»…çœ‹çº¸é¢é”€å”®æŠ¥è¡¨ã€‚",
                    "åœ¨ä»»ä½•é‡å¤§çš„äº§å“å‡çº§æˆ–è¥é”€æ´»åŠ¨å¤§è§„æ¨¡æŠ•å…¥å‰ï¼Œå…¬å¸å·²å½¢æˆä¸€å¥—æ ‡å‡†æµç¨‹ï¼Œå…ˆé‚€è¯·æ ¸å¿ƒè€å®¢æˆ·æˆ–ç§å­ç”¨æˆ·è¿›è¡Œå°èŒƒå›´\"å‹åŠ›æµ‹è¯•\"æˆ–\"å†…æµ‹è®¿è°ˆ\"ï¼ŒåŸºäºçœŸå®çš„ä½¿ç”¨åé¦ˆæ¥ä¿®æ­£æ–¹æ¡ˆï¼Œç¡®ä¿ä¸Šçº¿å³ç¬¦åˆå¸‚åœºçœŸå®é¢„æœŸã€‚"
                ]
            },
            {
                "dimension": "ä»·å€¼ç»“æ„",
                "questions": [
                    "å…¬å¸å·²æç‚¼å‡ºèƒ½å¤Ÿè®©å®¢æˆ·ä¸€å¬å°±æ‡‚ã€å¹¶ä¸å…¶ä»–å¯¹æ‰‹æ‹‰å¼€æ˜¾è‘—å·®è·çš„\"æ ¸å¿ƒä»·å€¼ç‚¹\"ï¼ˆä¾‹å¦‚ï¼šä¸æ˜¯å–è¡£æœï¼Œè€Œæ˜¯å–\"ä¸çš±çš„è¡¬è¡«\"ï¼‰ã€‚æ‰€æœ‰çš„é—¨å¤´ã€ä¸»å›¾ã€è¯¦æƒ…é¡µåŠåº—å‘˜å£å¾„ï¼Œéƒ½é«˜åº¦èšç„¦åœ¨è¿™ä¸ªç‚¹ä¸Šï¼Œç»ä¸å †ç Œå†—ä½™å–ç‚¹ã€‚",
                    "å…¬å¸é’ˆå¯¹é€‰å®šçš„\"æ ¸å¿ƒä»·å€¼\"ï¼Œè®¾è®¡äº†å…·ä½“çš„ã€å¯æ„ŸçŸ¥çš„æœåŠ¡ç¯èŠ‚ã€‚ä¾‹å¦‚ï¼šæ‰¿è¯º\"ä¸æ»¡æ„åŒ…é€€\"ä¸åªæ˜¯å£å·ï¼Œè€Œæ˜¯æœ‰ä¸€å¥—æ ‡å‡†çš„\"ç§’é€€\"æµç¨‹ï¼Œç¡®ä¿å®¢æˆ·åœ¨æœ€å…³é”®çš„ä»·å€¼ç‚¹ä¸Šè·å¾—è¿œè¶…è¡Œä¸šæ°´å¹³çš„å®é™…ä½“éªŒã€‚",
                    "å…¬å¸å®šæœŸï¼ˆå¦‚æ¯åŠå¹´ï¼‰æ·±åº¦æ‹†è§£æœ¬åœ°æˆ–åŒèµ›é“å‰ä¸‰åå¯¹æ‰‹çš„ä¼˜åŠ£åŠ¿ï¼Œå¹¶åˆ»æ„åœ¨äº§å“æˆ–æœåŠ¡ä¸Šåšå‡º\"åå‘è®¾è®¡\"ï¼ˆä¾‹å¦‚ï¼šå¯¹æ‰‹åšå¤§è€Œå…¨ï¼Œæˆ‘ä»¬åšå°è€Œç¾ï¼›å¯¹æ‰‹åšä½ä»·èµ°é‡ï¼Œæˆ‘ä»¬åšé«˜è´¨é™ªè·‘ï¼‰ï¼Œä»¥ç¡®ä¿æˆ‘ä»¬åœ¨å®¢æˆ·çœ¼ä¸­å…·æœ‰å”¯ä¸€çš„æ›¿ä»£æ€§ã€‚"
                ]
            },
            {
                "dimension": "æ¸ é“ç»“æ„",
                "questions": [
                    "å…¬å¸ä¸ç›²ç›®è·Ÿé£æŠ•æµï¼Œè€Œæ˜¯æ ¹æ®\"éœ€æ±‚ç»“æ„\"ä¸­å®šä¹‰çš„å®¢æˆ·ç”»åƒï¼Œé€šè¿‡æ•°æ®åˆ†ææˆ–å°é‡æµ‹è¯•ï¼Œæ˜ç¡®é”å®šäº†å®¢æˆ·é«˜é¢‘å‡ºç°çš„3-5ä¸ªæ ¸å¿ƒæ¸ é“ï¼ˆå¦‚ï¼šç‰¹å®šçš„å°çº¢ä¹¦è¯é¢˜ã€çº¿ä¸‹ç¤¾åŒºã€æˆ–å‚ç›´ç¤¾ç¾¤ï¼‰ï¼Œå¹¶é’ˆå¯¹ä¸åŒæ¸ é“çš„å±æ€§åˆ¶å®šäº†å·®å¼‚åŒ–çš„å†…å®¹è¡¨è¾¾ã€‚",
                    "å…¬å¸å»ºç«‹äº†ä¸€å¥—æ¸…æ™°çš„æ¸ é“è´¦æœ¬ï¼Œå®šæœŸä¼šæ ¸ç®—æ¯ä¸€ä¸ªè·å®¢æ¥æºçš„çœŸå®æˆæœ¬å’Œè½¬åŒ–ç‡ã€‚å¯¹äºè½¬åŒ–æ•ˆç‡ä½ã€å®¢ç¾¤ä¸ç²¾å‡†çš„æ¸ é“ï¼Œå›¢é˜Ÿèƒ½å¤Ÿè¿…é€Ÿå¤ç›˜å¹¶åšå‡ºåœæŸæˆ–ä¼˜åŒ–å†³ç­–ï¼Œè€Œéå‡­æ„Ÿè§‰æŒç»­æŠ•å…¥ã€‚",
                    "ä»»ä½•æ¸ é“å¸¦æ¥çš„æ–°å®¢æˆ·ï¼Œå…¬å¸éƒ½æœ‰ä¸€å¥—æ ‡å‡†åŒ–çš„æµç¨‹ï¼ˆå¦‚ï¼šæ‰«ç é¢†åˆ¸ã€æ·»åŠ ä¸“å±é¡¾é—®ã€å…³æ³¨å…¬ä¼—å·ç­‰ï¼‰å°†å…¶æ²‰æ·€åˆ°å…¬å¸è‡ªæœ‰çš„ç§åŸŸé˜µåœ°ä¸­ï¼Œå¹¶é…å¥—äº†æŒç»­çš„è¿è¥åŠ¨ä½œï¼Œç¡®ä¿è·å®¢ä¸åªæ˜¯\"ä¸€é”¤å­ä¹°å–\"ï¼Œè€Œæ˜¯èƒ½äº§ç”Ÿåç»­çš„å¤è´­æˆ–æ¨èã€‚"
                ]
            },
            {
                "dimension": "ç®¡ç†ç»“æ„",
                "questions": [
                    "é’ˆå¯¹æ—¥å¸¸ä¸šåŠ¡ä¸­çš„çªå‘çŠ¶å†µï¼ˆå¦‚å®¢æˆ·æŠ•è¯‰ã€ç´§æ€¥è°ƒè´§ã€æ–¹æ¡ˆå¾®è°ƒï¼‰ï¼Œå…¬å¸å·²å½¢æˆæ¸…æ™°çš„\"æˆæƒæ‰‹å†Œ\"ï¼Œä¸€çº¿ä¸»ç®¡æˆ–ä¸šåŠ¡å‘˜æ— éœ€å±‚å±‚è¯·ç¤ºå³å¯åœ¨è§„å®šæƒé™å†…è‡ªä¸»å†³ç­–ï¼Œç¡®ä¿å“åº”é€Ÿåº¦èƒ½å¤Ÿè·‘èµ¢ç«äº‰å¯¹æ‰‹ã€‚",
                    "å†…éƒ¨ä¿¡æ¯æµè½¬é€æ˜ï¼Œä¸åŒéƒ¨é—¨ï¼ˆå¦‚é”€å”®ä¸äº¤ä»˜ã€å¸‚åœºä¸è´¢åŠ¡ï¼‰ä¹‹é—´ä¸å†ä¾èµ–æ¼«é•¿çš„\"å…¬æ–‡/é‚®ä»¶æµè½¬\"æˆ–è€æ¿åè°ƒï¼Œè€Œæ˜¯å›´ç»•å…·ä½“çš„\"å®¢æˆ·é¡¹ç›®\"å»ºç«‹ä¸´æ—¶å°ç»„ï¼Œé€šè¿‡é«˜é¢‘ã€éæ­£å¼çš„æ²Ÿé€šå¿«é€Ÿè§£å†³é—®é¢˜ã€‚",
                    "å…¬å¸ç®¡ç†å±‚ä¼šå®šæœŸï¼ˆå¦‚æ¯åŠå¹´ï¼‰å¸¦é¢†æ ¸å¿ƒå‘˜å·¥å…±åŒå®¡è§†ç°æœ‰çš„ç®¡ç†è§„å®šå’Œä¸šåŠ¡æµç¨‹ï¼Œä¸»åŠ¨ç æ‰é‚£äº›\"ä¸ºäº†ç®¡ç†è€Œç®¡ç†\"ã€å¯¹å®¢æˆ·ä»·å€¼å’Œå·¥ä½œæ•ˆç‡æ²¡æœ‰è´¡çŒ®çš„å†—ä½™ç¯èŠ‚ï¼Œä¿æŒç»„ç»‡çš„\"è½»é‡åŒ–\"è¿ä½œã€‚"
                ]
            },
            {
                "dimension": "èƒ½åŠ›ç»“æ„",
                "questions": [
                    "å…¬å¸èƒ½å¤Ÿæ¸…æ™°ç•Œå®šå“ªäº›æ˜¯åº•å±‚æ ¸å¿ƒèƒ½åŠ›ï¼ˆå¦‚ï¼šç‰¹æ®Šçš„ç”Ÿäº§å·¥è‰ºã€å¤§å®¢æˆ·ç»è¥æ–¹æ³•è®ºç­‰ï¼‰ï¼Œå¹¶æŠ•å…¥é‡é‡‘è‡ªå»ºå›¢é˜Ÿã€‚åŒæ—¶ï¼Œè¿™äº›èƒ½åŠ›å·²è¢«æç‚¼ä¸ºå¯å¤åˆ¶çš„å†…éƒ¨æ•™ææˆ–SOPï¼ˆæ ‡å‡†ä½œä¸šç¨‹åºï¼‰ï¼Œä¸å› æŸä¸ªæ ¸å¿ƒå‘˜å·¥ç¦»èŒè€Œå¯¼è‡´èƒ½åŠ›ä¸§å¤±ã€‚",
                    "å›¢é˜Ÿå…·å¤‡æå¼ºçš„\"ä¸ä¸ºæˆ‘æ‰€æœ‰ï¼Œä½†ä¸ºæˆ‘æ‰€ç”¨\"çš„å¼€æ”¾æ„è¯†ã€‚å¯¹äºéæ ¸å¿ƒç¯èŠ‚ï¼ˆå¦‚ï¼šå“ç‰Œè®¾è®¡ã€åŸºç¡€ç ”å‘æ”¯æŒã€åœ°æ¨å›¢é˜Ÿç­‰ï¼‰ï¼Œèƒ½å¤Ÿå¨´ç†Ÿåœ°é€šè¿‡å¤–åŒ…ã€æˆ˜ç•¥åˆä½œã€å’¨è¯¢é¡¾é—®ç­‰æ–¹å¼å€Ÿç”¨å¤–éƒ¨é«˜æ°´å¹³èµ„æºï¼Œä»¥æä½æˆæœ¬å®ç°ç»„ç»‡åŠŸèƒ½çš„æ‰©å……ã€‚",
                    "å…¬å¸å…·å¤‡ç³»ç»Ÿçš„\"åå­—å‹\"äººæ‰åŸ¹å…»è®¡åˆ’ã€‚å‘˜å·¥ä¸ä»…åœ¨æœ¬èŒå²—ä½ä¸“ä¸šï¼Œè¿˜è¢«é¼“åŠ±é€šè¿‡å†…éƒ¨è½®å²—æˆ–äº¤å‰åŸ¹è®­ï¼ŒæŒæ¡ç›¸é‚»å²—ä½çš„åŸºæœ¬é€»è¾‘ï¼Œä»è€Œåœ¨ä¸šåŠ¡é«˜å³°æœŸå®ç°å›¢é˜Ÿå†…éƒ¨çš„çµæ´»è°ƒåº¦ã€‚"
                ]
            },
            {
                "dimension": "æ¿€åŠ±ç»“æ„",
                "questions": [
                    "å¥–é‡‘å‘æ”¾ä¸åªçœ‹å•ä¸€çš„ä¸šç»©æŒ‡æ ‡ï¼Œè€Œæ˜¯ä¸\"å…¬å¸æˆ˜ç•¥ç›®æ ‡é«˜åº¦æŒ‚é’©ã€‚ä¾‹å¦‚ï¼šæˆåŠŸå¼€å‘å‡ºç¬¦åˆ\"éœ€æ±‚ç»“æ„\"çš„æˆ˜ç•¥çº§æ–°å®¢æˆ·ï¼Œæˆ–äº¤ä»˜äº†å…·æœ‰\"å·®å¼‚åŒ–ä»·å€¼\"çš„é¡¹ç›®ï¼Œä¼šæœ‰é¢å¤–çš„å¥–åŠ±æƒé‡ã€‚",
                    "å…¬å¸æ•¢äºæ‹‰å¼€æ¿€åŠ±å·®è·ï¼Œå»ºç«‹\"èƒ½è€…æå¤šå¾—\"çš„åˆ†é…æœºåˆ¶ã€‚åœ¨åŒä¸€èŒçº§å†…ï¼Œå‰20%çš„é¡¶å°–äººæ‰ä¸å¹³å‡æ°´å¹³çš„æŠ¥é…¬å·®è·è¶³å¤Ÿå¤§ï¼Œç¡®ä¿å…¬å¸èµ„æºé›†ä¸­å¥–åŠ±é‚£äº›çœŸæ­£ä¸º\"ç«äº‰å£å’\"åšå‡ºè´¡çŒ®çš„æ ¸å¿ƒéª¨å¹²ï¼Œè€Œéå¹³å‡ç”¨åŠ›ã€‚",
                    "æ¿€åŠ±ä¸ä»…é™äºé’±ã€‚å…¬å¸æœ‰ä¸€å¥—é’ˆå¯¹æ ¸å¿ƒäººæ‰çš„é•¿æœŸæ¿€åŠ±æ–¹æ¡ˆï¼ˆå¦‚ï¼šåˆä¼™äººæœºåˆ¶ã€ä¸“ä¸šè¿›ä¿®æœºä¼šã€å‚ä¸é‡å¤§å†³ç­–æƒç­‰ï¼‰ï¼Œè®©å‘˜å·¥æ¸…æ™°æ„ŸçŸ¥åˆ°ï¼šåœ¨è¿™é‡Œå¹²æ´»ï¼Œä¸ä»…æ˜¯èµšç°åœ¨çš„é’±ï¼Œè¿˜èƒ½é€šè¿‡ç»„ç»‡å¹³å°å®ç°ä¸ªäººèŒåœºä»·å€¼çš„æŒç»­æº¢ä»·ã€‚"
                ]
            },
            {
                "dimension": "æ•°å­—åŒ–è½¬å‹",
                "questions": [
                    "ä»å®¢æˆ·åˆæ¬¡è§¦è¾¾ï¼ˆæ¸ é“ï¼‰ã€åˆ°åˆåŒæ‰§è¡Œï¼ˆä»·å€¼ï¼‰ã€å†åˆ°å”®åç»´æŠ¤ï¼Œæ¯ä¸€ä¸ªå…³é”®èŠ‚ç‚¹éƒ½æœ‰æ•°å­—ç³»ç»Ÿï¼ˆå¦‚CRMã€è¿›é”€å­˜æˆ–ç®€æ˜“è‡ªå»ºè¡¨ï¼‰å®æ—¶è®°å½•ã€‚ç®¡ç†å±‚èƒ½å¤Ÿéšæ—¶è°ƒå–çœŸå®çš„ä¸šåŠ¡è¿›åº¦å’Œè½¬åŒ–æ•°æ®ï¼Œè€Œéé€šè¿‡å¬å–ä¸‹å±å£å¤´æ±‡æŠ¥æ¥æŒæ¡æƒ…å†µã€‚",
                    "å…¬å¸çš„æ—¥å¸¸ç®¡ç†åŠ¨ä½œï¼ˆå¦‚ï¼šå®¡æ‰¹ã€è·¨éƒ¨é—¨åä½œã€çŸ¥è¯†å…±äº«ã€ä»»åŠ¡æŒ‡æ´¾ï¼‰å‡é€šè¿‡æ•°å­—åŒ–å·¥å…·ï¼ˆå¦‚ï¼šé’‰é’‰ã€é£ä¹¦ã€ä¼ä¸šå¾®ä¿¡æˆ–ä¸“ä¸šåŠå…¬ç³»ç»Ÿï¼‰æ²‰æ·€ã€‚ä¿¡æ¯æµè½¬ä¸å†ä¾èµ–äº\"äººæ‰¾äºº\"ï¼Œè€Œæ˜¯é€šè¿‡ç³»ç»Ÿå®ç°çš„è‡ªåŠ¨åŒ–æé†’å’Œè¿›åº¦è¿½è¸ªï¼Œæå¤§åœ°é™ä½äº†æ²Ÿé€šçš„\"æ‘©æ“¦åŠ›\"ã€‚",
                    "å…¬å¸ç§¯æå¼•å¯¼å‘˜å·¥ä½¿ç”¨å‰æ²¿æŠ€æœ¯å·¥å…·ï¼ˆå¦‚ï¼šAIå†™ä½œ/ç»˜å›¾è¾…åŠ©ã€è‡ªåŠ¨åŒ–è¥é”€æœºå™¨äººã€æ•°æ®åˆ†ææ’ä»¶ç­‰ï¼‰æ¥èµ‹èƒ½ä¸šåŠ¡ã€‚è¿™äº›å·¥å…·ä¸ä»…æé«˜äº†å‘˜å·¥çš„å•ä½äº§å‡ºï¼ˆäººæ•ˆï¼‰ï¼Œæ›´è®©åŸæœ¬éœ€è¦é«˜é˜¶ä¸“ä¸šäººæ‰æ‰èƒ½å®Œæˆçš„ä»»åŠ¡ï¼Œé€šè¿‡å·¥å…·è¾…åŠ©å˜æˆäº†æ™®é€šå‘˜å·¥ä¹Ÿèƒ½è¾¾åˆ°çš„æ ‡å‡†åŠ¨ä½œã€‚"
                ]
            },
            {
                "dimension": "ç«äº‰å£å’",
                "questions": [
                    "å…¬å¸èƒ½å¤Ÿæ¸…æ™°è¯†åˆ«å‡ºå“ªäº›æ˜¯ç«äº‰å¯¹æ‰‹\"èŠ±é’±ä¹Ÿä¹°ä¸èµ°\"çš„æ ¸å¿ƒèµ„äº§ï¼ˆå¦‚ï¼šç‹¬ç‰¹çš„å“ç‰Œå¿ƒæ™ºã€ä¸“åˆ©æŠ€æœ¯ã€è¡Œä¸šæ ‡å‡†è¯è¯­æƒã€æˆ–è€…ç‹¬æœ‰çš„ç‰¹è®¸ç»è¥æƒï¼‰ï¼Œå¹¶æœ‰ä¸“é—¨çš„é¢„ç®—å’ŒåŠ¨ä½œå»æŒç»­å¼ºåŒ–ã€ä¿æŠ¤è¿™äº›èµ„äº§ï¼Œä½¿å…¶éšæ—¶é—´æ¨ç§»ä¸æ–­å¢åšã€‚",
                    "å…¬å¸åœ¨äº¤ä»˜äº§å“æˆ–æœåŠ¡çš„è¿‡ç¨‹ä¸­ï¼Œåˆ»æ„å¢åŠ äº†ä¸å®¢æˆ·çš„\"ç²˜æ€§æ·±åº¦\"ã€‚é€šè¿‡æœåŠ¡é›†æˆã€æ•°æ®è¿æ¥ã€ä¼šå‘˜æƒ…æ„Ÿè”ç»“æˆ–ä¸šåŠ¡æµç¨‹çš„æ·±åº¦åµŒå…¥ï¼Œä½¿å¾—å®¢æˆ·å¦‚æœè½¬å‘ç«äº‰å¯¹æ‰‹ï¼Œå°†é¢ä¸´æå¤§çš„æ—¶é—´æˆæœ¬ã€ç»æµæŸå¤±æˆ–å¿ƒç†å‹åŠ›ã€‚",
                    "å…¬å¸ä¸ä»…å…³æ³¨åˆ©æ¶¦ï¼Œæ›´å…³æ³¨\"æ•ˆç‡å£å’\"ã€‚æˆ‘ä»¬é€šè¿‡å·¥è‰ºæ”¹è¿›ã€ä¾›åº”é“¾ä¼˜åŒ–æˆ–ç»„ç»‡ææ•ˆï¼Œä½¿å¾—å…¬å¸åœ¨ç»´æŒåŒç­‰ä»·å€¼äº§å‡ºçš„å‰æä¸‹ï¼Œå…·å¤‡æ¯”è¡Œä¸šå¹³å‡æ°´å¹³æ›´ä½çš„æˆæœ¬ç»“æ„ï¼Œæˆ–è€…æ›´å¿«çš„å‘¨è½¬é€Ÿåº¦ï¼Œè®©å¯¹æ‰‹åœ¨å‘åŠ¨ä»·æ ¼æˆ˜æ—¶æ— ä»ä¸‹æ‰‹ã€‚"
                ]
            }
        ];

        // è·å–é¢˜ç›®æ•°æ®
        function getQuestionsData(businessType) {
            if (businessType === 'Bç«¯ä¸šåŠ¡') {
                return tobQuestionsData["Bç«¯ä¸šåŠ¡è‡ªæµ‹é¢˜"];
            } else if (businessType === 'Cç«¯ä¸šåŠ¡') {
                return tocQuestionsData;
            }
            return [];
        }

        // è·å–æ‰€æœ‰é¢˜ç›®çš„å¾—åˆ†ï¼ˆç”¨äºå¯¼å‡ºï¼‰
        function getAllQuestionScores(item) {
            const results = item.results || {};
            const questionAnswers = results.questionAnswers || {};
            const businessType = item.businessType || '';
            const questionsData = getQuestionsData(businessType);
            
            const scores = {};
            
            // æ–¹æ³•1ï¼šä»é¢˜ç›®æ•°æ®ä¸­æå–ï¼ˆå¦‚æœä¸šåŠ¡ç±»å‹æ­£ç¡®ï¼‰
            if (questionsData && questionsData.length > 0) {
                questionsData.forEach(dimData => {
                    const dimName = dimensionNameMap[dimData.dimension]?.name || dimData.dimension;
                    const dimAnswers = questionAnswers[dimName] || [];
                    
                    // éå†è¯¥ç»´åº¦çš„æ‰€æœ‰é¢˜ç›®
                    dimData.questions.forEach((question, qIndex) => {
                        const score = dimAnswers[qIndex] !== undefined ? dimAnswers[qIndex] : '';
                        const key = `${dimName}_é¢˜ç›®${qIndex + 1}`;
                        scores[key] = score;
                    });
                });
            } else {
                // æ–¹æ³•2ï¼šå¦‚æœquestionsDataä¸ºç©ºï¼ˆä¸šåŠ¡ç±»å‹æœªçŸ¥ï¼‰ï¼Œç›´æ¥ä»questionAnswersä¸­æå–
                // questionAnswersçš„é”®æ˜¯ç»´åº¦åç§°ï¼Œå€¼æ˜¯é¢˜ç›®å¾—åˆ†æ•°ç»„
                Object.keys(questionAnswers).forEach(dimName => {
                    const dimAnswers = questionAnswers[dimName] || [];
                    if (Array.isArray(dimAnswers)) {
                        dimAnswers.forEach((score, qIndex) => {
                            const key = `${dimName}_é¢˜ç›®${qIndex + 1}`;
                            scores[key] = score !== undefined && score !== null ? score : '';
                        });
                    }
                });
            }
            
            return scores;
        }

        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        function checkLogin() {
            const isLoggedIn = sessionStorage.getItem('adminLoggedIn') === 'true';
            if (isLoggedIn) {
                showAdminScreen();
            } else {
                showLoginScreen();
            }
        }

        // æ˜¾ç¤ºç™»å½•ç•Œé¢
        function showLoginScreen() {
            document.getElementById('loginScreen').style.display = 'block';
            document.getElementById('adminScreen').style.display = 'none';
        }

        // æ˜¾ç¤ºç®¡ç†ç•Œé¢
        function showAdminScreen() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('adminScreen').style.display = 'block';
            loadData();
        }

        // å¤„ç†ç™»å½•
        function handleLogin() {
            const password = document.getElementById('passwordInput').value;
            const errorDiv = document.getElementById('loginError');
            
            if (password === ADMIN_PASSWORD) {
                sessionStorage.setItem('adminLoggedIn', 'true');
                errorDiv.textContent = '';
                showAdminScreen();
            } else {
                errorDiv.textContent = 'å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•';
            }
        }

        // é€€å‡ºç™»å½•
        function logout() {
            sessionStorage.removeItem('adminLoggedIn');
            showLoginScreen();
            document.getElementById('passwordInput').value = '';
        }

        // åŠ è½½æ•°æ®
        async function loadData() {
            if (supabaseAdmin) {
                // ä» Supabase åŠ è½½æ•°æ®
                try {
                    const { data, error } = await supabaseAdmin
                        .from('assessments')
                        .select('*')
                        .order('created_at', { ascending: false });
                    
                    if (error) {
                        throw error;
                    }
                    
                    // è½¬æ¢æ•°æ®æ ¼å¼ä»¥å…¼å®¹ç°æœ‰ä»£ç 
                    allData = (data || []).map(item => ({
                        id: item.id,
                        userName: item.user_name,
                        companyName: item.company_name,
                        userPhone: item.user_phone,
                        businessType: item.business_type,
                        submitTime: item.submit_time,
                        results: item.results
                    }));
                    
                    filteredData = [...allData];
                    renderTable();
                    updateStats();
                    console.log('ä» Supabase åŠ è½½äº†', allData.length, 'æ¡æ•°æ®');
                } catch (error) {
                    console.error('ä» Supabase åŠ è½½æ•°æ®å¤±è´¥:', error);
                    // å¦‚æœ Supabase å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨ localStorage
                    loadDataFromLocalStorage();
                }
            } else {
                // ä½¿ç”¨ localStorage
                loadDataFromLocalStorage();
            }
        }
        
        // ä» localStorage åŠ è½½æ•°æ®ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰
        function loadDataFromLocalStorage() {
            try {
                const storedData = localStorage.getItem('assessmentUserData');
                if (storedData) {
                    allData = JSON.parse(storedData);
                } else {
                    allData = [];
                }
                filteredData = [...allData].reverse(); // æœ€æ–°çš„åœ¨å‰
                renderTable();
                updateStats();
                console.log('ä» localStorage åŠ è½½äº†', allData.length, 'æ¡æ•°æ®');
            } catch (e) {
                console.error('åŠ è½½æ•°æ®å¤±è´¥:', e);
                allData = [];
                filteredData = [];
                renderTable();
                updateStats();
            }
        }

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            document.getElementById('totalCount').textContent = allData.length;
            const bCount = allData.filter(d => d.businessType === 'Bç«¯ä¸šåŠ¡').length;
            const cCount = allData.filter(d => d.businessType === 'Cç«¯ä¸šåŠ¡').length;
            document.getElementById('bCount').textContent = bCount;
            document.getElementById('cCount').textContent = cCount;
        }

        // è¿‡æ»¤æ•°æ®
        function filterData() {
            const searchText = document.getElementById('searchInput').value.toLowerCase();
            if (!searchText) {
                filteredData = [...allData].reverse();
            } else {
                filteredData = allData.filter(item => {
                    return (
                        (item.userName && item.userName.toLowerCase().includes(searchText)) ||
                        (item.companyName && item.companyName.toLowerCase().includes(searchText)) ||
                        (item.userPhone && item.userPhone.includes(searchText))
                    );
                }).reverse();
            }
            renderTable();
        }

        // æ¸²æŸ“è¡¨æ ¼
        function renderTable() {
            const tbody = document.getElementById('dataTableBody');
            const emptyState = document.getElementById('emptyState');
            
            if (filteredData.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            tbody.innerHTML = filteredData.map((item, index) => {
                const results = item.results || {};
                const cbi = results.CBI !== undefined ? results.CBI.toFixed(2) : '-';
                const enterpriseType = results.enterpriseType || '-';
                
                return `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${item.submitTime || '-'}</td>
                        <td>${item.userName || '-'}</td>
                        <td>${item.companyName || '-'}</td>
                        <td>${item.userPhone || '-'}</td>
                        <td>${item.businessType || '-'}</td>
                        <td>${cbi}</td>
                        <td>${enterpriseType}</td>
                        <td>
                            <div class="action-btns">
                                <button class="btn btn-secondary" onclick="viewDetail(${item.id})">æŸ¥çœ‹</button>
                                <button class="btn btn-danger" onclick="deleteData(${item.id})">åˆ é™¤</button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // æŸ¥çœ‹è¯¦æƒ…
        function viewDetail(id) {
            const item = allData.find(d => d.id === id);
            if (!item) return;

            const results = item.results || {};
            const dimensionScores = results.dimensionScores || {};
            
            const detailHTML = `
                <div class="detail-section">
                    <h3>åŸºæœ¬ä¿¡æ¯</h3>
                    <div class="detail-row">
                        <div class="detail-label">æäº¤æ—¶é—´</div>
                        <div class="detail-value">${item.submitTime || '-'}</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">å§“å</div>
                        <div class="detail-value">${item.userName || '-'}</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">å…¬å¸åç§°</div>
                        <div class="detail-value">${item.companyName || '-'}</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">è”ç³»ç”µè¯</div>
                        <div class="detail-value">${item.userPhone || '-'}</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">ä¸šåŠ¡ç±»å‹</div>
                        <div class="detail-value">${item.businessType || '-'}</div>
                    </div>
                </div>

                <div class="detail-section">
                    <h3>æµ‹è¯„ç»“æœ</h3>
                    <div class="detail-row">
                        <div class="detail-label">ä¸šç»©å‡åˆ† (P_avg)</div>
                        <div class="detail-value">${results.P_avg !== undefined ? results.P_avg.toFixed(2) : '-'}</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">ç»„ç»‡å‡åˆ† (O_avg)</div>
                        <div class="detail-value">${results.O_avg !== undefined ? results.O_avg.toFixed(2) : '-'}</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">å£å’å‡åˆ† (B_avg)</div>
                        <div class="detail-value">${results.B_avg !== undefined ? results.B_avg.toFixed(2) : '-'}</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">æ•°å­—åŒ–å‡åˆ† (D_avg)</div>
                        <div class="detail-value">${results.D_avg !== undefined ? results.D_avg.toFixed(2) : '-'}</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">CBIæŒ‡æ•°</div>
                        <div class="detail-value"><strong>${results.CBI !== undefined ? results.CBI.toFixed(2) : '-'}</strong></div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">ä¼ä¸šç±»å‹</div>
                        <div class="detail-value"><strong>${results.enterpriseType || '-'}</strong></div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">ç±»å‹æè¿°</div>
                        <div class="detail-value">${results.typeDesc || '-'}</div>
                    </div>
                </div>

                <div class="detail-section">
                    <h3>å„ç»´åº¦å¾—åˆ†</h3>
                    ${Object.entries(dimensionScores).map(([dim, score]) => {
                        let badgeClass = 'score-medium';
                        if (score >= 7) badgeClass = 'score-high';
                        else if (score < 5) badgeClass = 'score-low';
                        return `
                            <div class="detail-row">
                                <div class="detail-label">${dim}</div>
                                <div class="detail-value">
                                    <span class="score-badge ${badgeClass}">${score.toFixed(2)}</span>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>

                <div class="detail-section">
                    <h3>å„é¢˜ç›®å¾—åˆ†</h3>
                    ${(() => {
                        const results = item.results || {};
                        const questionAnswers = results.questionAnswers || {};
                        const businessType = item.businessType || '';
                        const questionsData = getQuestionsData(businessType);
                        let html = '';
                        
                        questionsData.forEach(dimData => {
                            const dimName = dimensionNameMap[dimData.dimension]?.name || dimData.dimension;
                            const dimAnswers = questionAnswers[dimName] || [];
                            
                            html += `<div style="margin-bottom: 20px; padding: 15px; background: #f9f9f9; border-radius: 8px;">`;
                            html += `<h4 style="color: #667eea; margin-bottom: 10px;">${dimName}ç»“æ„</h4>`;
                            
                            dimData.questions.forEach((question, qIndex) => {
                                const score = dimAnswers[qIndex] !== undefined ? dimAnswers[qIndex] : '-';
                                let badgeClass = 'score-medium';
                                if (score >= 7) badgeClass = 'score-high';
                                else if (score < 5) badgeClass = 'score-low';
                                
                                html += `
                                    <div class="detail-row" style="margin-bottom: 10px;">
                                        <div class="detail-label" style="width: 100%; margin-bottom: 5px;">
                                            <strong>é¢˜ç›®${qIndex + 1}:</strong> ${question}
                                        </div>
                                        <div class="detail-value" style="width: 100%;">
                                            <span class="score-badge ${badgeClass}">å¾—åˆ†: ${score}</span>
                                        </div>
                                    </div>
                                `;
                            });
                            
                            html += `</div>`;
                        });
                        
                        return html || '<p style="color: #999;">æš‚æ— é¢˜ç›®å¾—åˆ†æ•°æ®</p>';
                    })()}
                </div>
            `;

            document.getElementById('detailContent').innerHTML = detailHTML;
            document.getElementById('detailModal').style.display = 'block';
        }

        // å…³é—­è¯¦æƒ…æ¨¡æ€æ¡†
        function closeDetailModal() {
            document.getElementById('detailModal').style.display = 'none';
        }

        // åˆ é™¤æ•°æ®
        async function deleteData(id) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚')) {
                return;
            }
            
            if (supabaseAdmin) {
                // ä» Supabase åˆ é™¤
                try {
                    const { error } = await supabaseAdmin
                        .from('assessments')
                        .delete()
                        .eq('id', id);
                    
                    if (error) {
                        throw error;
                    }
                    
                    console.log('å·²ä» Supabase åˆ é™¤æ•°æ® ID:', id);
                    // é‡æ–°åŠ è½½æ•°æ®
                    await loadData();
                } catch (error) {
                    console.error('ä» Supabase åˆ é™¤æ•°æ®å¤±è´¥:', error);
                    alert('åˆ é™¤å¤±è´¥ï¼š' + error.message);
                    // å¦‚æœ Supabase å¤±è´¥ï¼Œå°è¯•ä» localStorage åˆ é™¤
                    deleteFromLocalStorage(id);
                }
            } else {
                // ä» localStorage åˆ é™¤
                deleteFromLocalStorage(id);
            }
        }
        
        // ä» localStorage åˆ é™¤æ•°æ®ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰
        function deleteFromLocalStorage(id) {
            allData = allData.filter(d => d.id !== id);
            localStorage.setItem('assessmentUserData', JSON.stringify(allData));
            loadData();
        }

        // å¯¼å‡ºJSON
        function exportToJSON() {
            const dataStr = JSON.stringify(allData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `æµ‹è¯„æ•°æ®_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // å¯¼å‡ºCSV
        function exportToCSV() {
            // è·å–æ‰€æœ‰å¯èƒ½çš„é¢˜ç›®åˆ—ï¼ˆå§‹ç»ˆä»é¢˜ç›®æ¨¡æ¿ä¸­ç”Ÿæˆï¼Œç¡®ä¿åŒ…å«æ‰€æœ‰åˆ—ï¼‰
            let allQuestionHeadersSet = new Set();
            
            // å§‹ç»ˆä»é¢˜ç›®æ¨¡æ¿ä¸­ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„é¢˜ç›®åˆ—ï¼ˆä¸ä¾èµ–æ•°æ®ï¼‰
            // éå†æ‰€æœ‰ä¸šåŠ¡ç±»å‹ï¼Œç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„é¢˜ç›®åˆ—
            ['Bç«¯ä¸šåŠ¡', 'Cç«¯ä¸šåŠ¡'].forEach(businessType => {
                const questionsData = getQuestionsData(businessType);
                if (questionsData && questionsData.length > 0) {
                    questionsData.forEach(dimData => {
                        const dimName = dimensionNameMap[dimData.dimension]?.name || dimData.dimension;
                        if (dimData.questions && dimData.questions.length > 0) {
                            dimData.questions.forEach((question, qIndex) => {
                                const key = `${dimName}_é¢˜ç›®${qIndex + 1}`;
                                allQuestionHeadersSet.add(key);
                            });
                        }
                    });
                }
            });
            
            // åŒæ—¶ä»å®é™…æ•°æ®ä¸­æ”¶é›†ï¼Œç¡®ä¿åŒ…å«æ•°æ®ä¸­å¯èƒ½å­˜åœ¨çš„é¢å¤–åˆ—
            allData.forEach(item => {
                const questionScores = getAllQuestionScores(item);
                Object.keys(questionScores).forEach(key => allQuestionHeadersSet.add(key));
            });
            
            const allQuestionHeaders = Array.from(allQuestionHeadersSet).sort();
            
            // å¦‚æœé¢˜ç›®åˆ—ä¸ºç©ºï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ
            if (allQuestionHeaders.length === 0) {
                const fallbackHeaders = [];
                // æ‰‹åŠ¨ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„é¢˜ç›®åˆ—
                const dimensions = ['éœ€æ±‚', 'ä»·å€¼', 'æ¸ é“', 'å£å’', 'ç®¡ç†', 'èƒ½åŠ›', 'æ¿€åŠ±', 'æ•°å­—åŒ–è½¬å‹'];
                dimensions.forEach(dim => {
                    for (let i = 1; i <= 3; i++) {
                        fallbackHeaders.push(`${dim}_é¢˜ç›®${i}`);
                    }
                });
                if (fallbackHeaders.length > 0) {
                    allQuestionHeaders.push(...fallbackHeaders);
                } else {
                    alert('é”™è¯¯ï¼šæ— æ³•ç”Ÿæˆé¢˜ç›®åˆ—ï¼\nè¯·æ£€æŸ¥é¢˜ç›®æ•°æ®æ˜¯å¦æ­£ç¡®åŠ è½½ã€‚\n\nå°è¯•é‡æ–°åŠ è½½é¡µé¢ã€‚');
                    return;
                }
            }
            // åŸºç¡€åˆ—
            const baseHeaders = ['æäº¤æ—¶é—´', 'å§“å', 'å…¬å¸åç§°', 'è”ç³»ç”µè¯', 'ä¸šåŠ¡ç±»å‹', 'ä¸šç»©å‡åˆ†', 'ç»„ç»‡å‡åˆ†', 'å£å’å‡åˆ†', 'æ•°å­—åŒ–å‡åˆ†', 'CBIæŒ‡æ•°', 'ä¼ä¸šç±»å‹'];
            
            // ç¡®ä¿é¢˜ç›®åˆ—è¢«æ­£ç¡®æ·»åŠ åˆ°headersä¸­
            const headers = [];
            headers.push(...baseHeaders);
            headers.push(...allQuestionHeaders);

            const rows = allData.map((item, index) => {
                const results = item.results || {};
                const questionScores = getAllQuestionScores(item);
                
                const baseRow = [
                    item.submitTime || '',
                    item.userName || '',
                    item.companyName || '',
                    item.userPhone || '',
                    item.businessType || '',
                    results.P_avg !== undefined ? results.P_avg.toFixed(2) : '',
                    results.O_avg !== undefined ? results.O_avg.toFixed(2) : '',
                    results.B_avg !== undefined ? results.B_avg.toFixed(2) : '',
                    results.D_avg !== undefined ? results.D_avg.toFixed(2) : '',
                    results.CBI !== undefined ? results.CBI.toFixed(2) : '',
                    results.enterpriseType || ''
                ];

                // æ·»åŠ é¢˜ç›®å¾—åˆ†
                const questionRow = allQuestionHeaders.map(key => {
                    const value = questionScores[key] !== undefined && questionScores[key] !== '' ? questionScores[key] : '';
                    return value;
                });

                return [...baseRow, ...questionRow];
            });

            // éªŒè¯rowsé•¿åº¦ä¸headersé•¿åº¦åŒ¹é…
            if (rows.length > 0 && rows[0].length !== headers.length) {
                alert('é”™è¯¯ï¼šCSVè¡Œé•¿åº¦ä¸åŒ¹é…ï¼\nè¡¨å¤´æ•°é‡: ' + headers.length + '\nç¬¬ä¸€è¡Œæ•°æ®æ•°é‡: ' + rows[0].length);
            }
            
            // ç¡®ä¿æ‰€æœ‰è¡Œéƒ½æœ‰æ­£ç¡®çš„åˆ—æ•°
            const fixedRows = rows.map(row => {
                if (row.length !== headers.length) {
                    // è¡¥é½è¡Œæ•°æ®ä»¥åŒ¹é…headersé•¿åº¦
                    const fixedRow = [...row];
                    while (fixedRow.length < headers.length) {
                        fixedRow.push('');
                    }
                    return fixedRow.slice(0, headers.length);
                }
                return row;
            });
            
            // ç”ŸæˆCSVå†…å®¹ï¼Œç¡®ä¿è¡¨å¤´åŒ…å«æ‰€æœ‰åˆ—
            const csvHeaderLine = headers.map(h => `"${String(h).replace(/"/g, '""')}"`).join(',');
            const csvDataLines = fixedRows.map(row => 
                row.map(cell => `"${String(cell).replace(/"/g, '""')}"`).join(',')
            );
            const csvContent = [csvHeaderLine, ...csvDataLines].join('\n');
            
            // æ·»åŠ BOMä»¥æ”¯æŒExcelæ­£ç¡®æ˜¾ç¤ºä¸­æ–‡
            const BOM = '\uFEFF';
            const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `æµ‹è¯„æ•°æ®_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // æ˜¾ç¤ºé£ä¹¦é…ç½®
        function showFeishuConfig() {
            // åŠ è½½å·²ä¿å­˜çš„é…ç½®
            const savedConfig = localStorage.getItem('feishuConfig');
            if (savedConfig) {
                const config = JSON.parse(savedConfig);
                document.getElementById('feishuAppId').value = config.appId || '';
                document.getElementById('feishuAppSecret').value = config.appSecret || '';
                document.getElementById('feishuAppToken').value = config.appToken || '';
                document.getElementById('feishuTableId').value = config.tableId || '';
            }
            document.getElementById('feishuModal').style.display = 'block';
        }

        // å…³é—­é£ä¹¦é…ç½®æ¨¡æ€æ¡†
        function closeFeishuModal() {
            document.getElementById('feishuModal').style.display = 'none';
        }

        // å¯¼å‡ºåˆ°é£ä¹¦
        async function exportToFeishu() {
            const config = {
                appId: document.getElementById('feishuAppId').value.trim(),
                appSecret: document.getElementById('feishuAppSecret').value.trim(),
                appToken: document.getElementById('feishuAppToken').value.trim(),
                tableId: document.getElementById('feishuTableId').value.trim()
            };

            if (!config.appId || !config.appSecret || !config.appToken || !config.tableId) {
                alert('è¯·å¡«å†™å®Œæ•´çš„é…ç½®ä¿¡æ¯');
                return;
            }

            // ä¿å­˜é…ç½®
            localStorage.setItem('feishuConfig', JSON.stringify(config));

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'å¯¼å‡ºä¸­...';
            btn.disabled = true;

            try {
                // è·å–è®¿é—®ä»¤ç‰Œ
                const tokenResponse = await fetch('https://open.feishu.cn/open-apis/auth/v3/app_access_token/internal/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        app_id: config.appId,
                        app_secret: config.appSecret
                    })
                });

                const tokenData = await tokenResponse.json();
                if (tokenData.code !== 0) {
                    throw new Error(tokenData.msg || 'è·å–è®¿é—®ä»¤ç‰Œå¤±è´¥');
                }

                const accessToken = tokenData.app_access_token;

                // è½¬æ¢æ•°æ®æ ¼å¼
                const records = allData.map(item => {
                    const results = item.results || {};
                    const dimensionScores = results.dimensionScores || {};
                    const questionScores = getAllQuestionScores(item);
                    
                    // åŸºç¡€å­—æ®µ
                    const fields = {
                        'æäº¤æ—¶é—´': item.submitTime || '',
                        'å§“å': item.userName || '',
                        'å…¬å¸åç§°': item.companyName || '',
                        'è”ç³»ç”µè¯': item.userPhone || '',
                        'ä¸šåŠ¡ç±»å‹': item.businessType || '',
                        'ä¸šç»©å‡åˆ†': results.P_avg !== undefined ? results.P_avg.toFixed(2) : '',
                        'ç»„ç»‡å‡åˆ†': results.O_avg !== undefined ? results.O_avg.toFixed(2) : '',
                        'å£å’å‡åˆ†': results.B_avg !== undefined ? results.B_avg.toFixed(2) : '',
                        'æ•°å­—åŒ–å‡åˆ†': results.D_avg !== undefined ? results.D_avg.toFixed(2) : '',
                        'CBIæŒ‡æ•°': results.CBI !== undefined ? results.CBI.toFixed(2) : '',
                        'ä¼ä¸šç±»å‹': results.enterpriseType || '',
                        'éœ€æ±‚ç»“æ„å¾—åˆ†': dimensionScores['éœ€æ±‚'] !== undefined ? dimensionScores['éœ€æ±‚'].toFixed(2) : '',
                        'ä»·å€¼ç»“æ„å¾—åˆ†': dimensionScores['ä»·å€¼'] !== undefined ? dimensionScores['ä»·å€¼'].toFixed(2) : '',
                        'æ¸ é“ç»“æ„å¾—åˆ†': dimensionScores['æ¸ é“'] !== undefined ? dimensionScores['æ¸ é“'].toFixed(2) : '',
                        'å£å’ç»“æ„å¾—åˆ†': dimensionScores['å£å’'] !== undefined ? dimensionScores['å£å’'].toFixed(2) : '',
                        'ç®¡ç†ç»“æ„å¾—åˆ†': dimensionScores['ç®¡ç†'] !== undefined ? dimensionScores['ç®¡ç†'].toFixed(2) : '',
                        'èƒ½åŠ›ç»“æ„å¾—åˆ†': dimensionScores['èƒ½åŠ›'] !== undefined ? dimensionScores['èƒ½åŠ›'].toFixed(2) : '',
                        'æ¿€åŠ±ç»“æ„å¾—åˆ†': dimensionScores['æ¿€åŠ±'] !== undefined ? dimensionScores['æ¿€åŠ±'].toFixed(2) : '',
                        'æ•°å­—åŒ–è½¬å‹å¾—åˆ†': dimensionScores['æ•°å­—åŒ–è½¬å‹'] !== undefined ? dimensionScores['æ•°å­—åŒ–è½¬å‹'].toFixed(2) : ''
                    };
                    
                    // æ·»åŠ æ‰€æœ‰é¢˜ç›®çš„å¾—åˆ†
                    Object.keys(questionScores).forEach(key => {
                        const score = questionScores[key];
                        if (score !== undefined && score !== '') {
                            fields[key] = String(score);
                        }
                    });
                    
                    return { fields };
                });

                // åˆ†æ‰¹å†™å…¥ï¼ˆæ¯æ¬¡æœ€å¤š100æ¡ï¼‰
                const batchSize = 100;
                let successCount = 0;
                let failCount = 0;

                for (let i = 0; i < records.length; i += batchSize) {
                    const batch = records.slice(i, i + batchSize);
                    try {
                        const response = await fetch(`https://open.feishu.cn/open-apis/bitable/v1/apps/${config.appToken}/tables/${config.tableId}/records`, {
                            method: 'POST',
                            headers: {
                                'Authorization': `Bearer ${accessToken}`,
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                records: batch
                            })
                        });

                        const data = await response.json();
                        if (data.code === 0) {
                            successCount += batch.length;
                        } else {
                            throw new Error(data.msg || 'å†™å…¥æ•°æ®å¤±è´¥');
                        }
                    } catch (error) {
                        failCount += batch.length;
                        console.error(`æ‰¹æ¬¡ ${Math.floor(i / batchSize) + 1} å¯¼å‡ºå¤±è´¥:`, error);
                    }
                }

                if (successCount > 0) {
                    alert(`å¯¼å‡ºæˆåŠŸï¼\næ€»è®¡: ${records.length} æ¡\næˆåŠŸ: ${successCount} æ¡\nå¤±è´¥: ${failCount} æ¡`);
                    closeFeishuModal();
                } else {
                    alert('å¯¼å‡ºå¤±è´¥ï¼Œè¯·æ£€æŸ¥é…ç½®ä¿¡æ¯å’Œç½‘ç»œè¿æ¥');
                }
            } catch (error) {
                alert('å¯¼å‡ºå¤±è´¥: ' + error.message);
                console.error('å¯¼å‡ºé”™è¯¯:', error);
            } finally {
                btn.textContent = originalText;
                btn.disabled = false;
            }
        }

        // æ¸…ç©ºæ‰€æœ‰æ•°æ®
        async function clearAllData() {
            if (!confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                return;
            }
            if (!confirm('å†æ¬¡ç¡®è®¤ï¼šè¿™å°†åˆ é™¤æ‰€æœ‰æµ‹è¯„æ•°æ®ï¼Œè¯·ç¡®ä¿å·²å¤‡ä»½ï¼')) {
                return;
            }
            
            if (supabaseAdmin) {
                // ä» Supabase åˆ é™¤æ‰€æœ‰æ•°æ®
                try {
                    const { error } = await supabaseAdmin
                        .from('assessments')
                        .delete()
                        .neq('id', 0); // åˆ é™¤æ‰€æœ‰è®°å½•ï¼ˆid ä¸å¯èƒ½ä¸º 0ï¼‰
                    
                    if (error) {
                        throw error;
                    }
                    
                    console.log('å·²ä» Supabase æ¸…ç©ºæ‰€æœ‰æ•°æ®');
                    allData = [];
                    filteredData = [];
                    renderTable();
                    updateStats();
                    alert('æ‰€æœ‰æ•°æ®å·²æ¸…ç©º');
                } catch (error) {
                    console.error('ä» Supabase æ¸…ç©ºæ•°æ®å¤±è´¥:', error);
                    alert('æ¸…ç©ºå¤±è´¥ï¼š' + error.message);
                    // å¦‚æœ Supabase å¤±è´¥ï¼Œå°è¯•æ¸…ç©º localStorage
                    clearLocalStorage();
                }
            } else {
                // æ¸…ç©º localStorage
                clearLocalStorage();
            }
        }
        
        // æ¸…ç©º localStorageï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰
        function clearLocalStorage() {
            localStorage.removeItem('assessmentUserData');
            allData = [];
            filteredData = [];
            renderTable();
            updateStats();
            alert('æ‰€æœ‰æ•°æ®å·²æ¸…ç©º');
        }

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        window.onclick = function(event) {
            const detailModal = document.getElementById('detailModal');
            const feishuModal = document.getElementById('feishuModal');
            if (event.target === detailModal) {
                closeDetailModal();
            }
            if (event.target === feishuModal) {
                closeFeishuModal();
            }
        }

        // å›è½¦é”®ç™»å½•
        document.getElementById('passwordInput')?.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                handleLogin();
            }
        });

        // åˆå§‹åŒ–
        checkLogin();
    </script>
</body>
</html>
