<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼ä¸šå¸‚åœºç«äº‰åŠ›è‡ªæµ‹</title>
    <script>
        // Chart.js åŠ è½½çŠ¶æ€
        let chartJSLoaded = false;
        let chartJSLoadPromise = null;
        
        // å°è¯•åŠ è½½ Chart.jsï¼ˆä¸»CDNï¼‰
        function loadChartJS() {
            if (chartJSLoadPromise) {
                return chartJSLoadPromise;
            }
            
            chartJSLoadPromise = new Promise((resolve, reject) => {
                // å¦‚æœå·²ç»åŠ è½½ï¼Œç›´æ¥è¿”å›
                if (typeof Chart !== 'undefined') {
                    chartJSLoaded = true;
                    resolve();
                    return;
                }
                
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js';
                script.async = true;
                
                script.onload = function() {
                    chartJSLoaded = true;
                    console.log('Chart.js åŠ è½½æˆåŠŸ');
                    resolve();
                };
                
                script.onerror = function() {
                    console.warn('ä¸»CDNåŠ è½½å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨CDN');
                    // å°è¯•å¤‡ç”¨CDN
                    loadBackupChartJS().then(resolve).catch(reject);
                };
                
                document.head.appendChild(script);
            });
            
            return chartJSLoadPromise;
        }
        
        // å¤‡ç”¨CDN
        function loadBackupChartJS() {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = 'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js';
                script.async = true;
                
                script.onload = function() {
                    chartJSLoaded = true;
                    console.log('Chart.js ä»å¤‡ç”¨CDNåŠ è½½æˆåŠŸ');
                    resolve();
                };
                
                script.onerror = function() {
                    console.error('æ‰€æœ‰CDNéƒ½åŠ è½½å¤±è´¥');
                    chartJSLoaded = false;
                    reject(new Error('Chart.js åŠ è½½å¤±è´¥'));
                };
                
                document.head.appendChild(script);
            });
        }
        
        // é¡µé¢åŠ è½½æ—¶å¼€å§‹åŠ è½½ Chart.js
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadChartJS);
        } else {
            loadChartJS();
        }
        
        // å¤„ç†å­˜å‚¨è®¿é—®è¢«é˜»æ­¢çš„æƒ…å†µï¼ˆæµè§ˆå™¨è·Ÿè¸ªé˜²æŠ¤ï¼‰
        // è¿™ä¸ªè­¦å‘Šä¸å½±å“åº”ç”¨åŠŸèƒ½ï¼Œå¯ä»¥å®‰å…¨å¿½ç•¥
        window.addEventListener('error', function(e) {
            if (e.message && e.message.includes('Tracking Prevention')) {
                // å¿½ç•¥è·Ÿè¸ªé˜²æŠ¤ç›¸å…³çš„é”™è¯¯ï¼Œä¸å½±å“åŠŸèƒ½
                e.preventDefault();
                return false;
            }
        }, true);
        
        // æ•è·æ§åˆ¶å°è­¦å‘Š
        const originalWarn = console.warn;
        console.warn = function(...args) {
            if (args[0] && typeof args[0] === 'string' && args[0].includes('Tracking Prevention')) {
                // å¿½ç•¥è·Ÿè¸ªé˜²æŠ¤è­¦å‘Š
                return;
            }
            originalWarn.apply(console, args);
        };
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Supabase å®¢æˆ·ç«¯åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Supabase é…ç½®æ–‡ä»¶ï¼ˆéœ€è¦ç”¨æˆ·è‡ªå·±åˆ›å»ºå¹¶å¡«å…¥å¯†é’¥ï¼‰ -->
    <script src="config.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            padding: 40px;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 32px;
        }

        h2 {
            color: #555;
            margin-bottom: 20px;
            font-size: 24px;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        /* ä¸šåŠ¡ç±»å‹é€‰æ‹© */
        .business-type-options {
            display: flex;
            gap: 30px;
            justify-content: center;
            margin: 40px 0;
        }

        .business-type-card {
            flex: 1;
            max-width: 300px;
            padding: 40px 30px;
            border: 3px solid #e0e0e0;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f9f9f9;
            text-align: center;
            position: relative;
            z-index: 1;
            pointer-events: auto;
            user-select: none;
            -webkit-user-select: none;
        }

        .business-type-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .business-type-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .business-type-card h3 {
            font-size: 28px;
            margin-bottom: 15px;
        }

        /* ç­”é¢˜ç•Œé¢ */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
            border-radius: 10px;
        }

        .question-container {
            margin-bottom: 30px;
        }

        .question-number {
            color: #667eea;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .dimension-label {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .question-text {
            font-size: 18px;
            color: #333;
            margin-bottom: 30px;
            line-height: 1.8;
        }

        .slider-container {
            margin: 30px 0;
        }

        .slider-wrapper {
            position: relative;
            margin: 20px 0;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #e0e0e0;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 12px;
            color: #666;
        }

        .slider-value {
            text-align: center;
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
            margin: 20px 0;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 50px;
            font-size: 18px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
            display: block;
            margin: 20px auto;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            box-shadow: none;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #333;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        /* ç»“æœå±•ç¤º */
        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }

        .result-card {
            background: #f9f9f9;
            border-radius: 15px;
            padding: 25px;
        }

        .result-card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }

        .cbi-gauge {
            text-align: center;
            margin: 30px 0;
        }

        .cbi-score {
            font-size: 64px;
            font-weight: bold;
            color: #667eea;
            margin: 20px 0;
        }

        .quadrant-chart {
            position: relative;
            width: 100%;
            height: 450px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            margin: 20px 0;
            background: #fafafa;
            padding: 50px 60px 50px 60px;
        }

        .quadrant-axis {
            position: absolute;
            background: #333;
        }

        .quadrant-axis-x {
            width: 2px;
            height: calc(100% - 100px);
            left: 60px;
            bottom: 50px;
        }

        .quadrant-axis-y {
            width: calc(100% - 120px);
            height: 2px;
            left: 60px;
            bottom: 50px;
        }

        .quadrant-label {
            position: absolute;
            font-size: 16px;
            font-weight: bold;
            color: #333;
        }

        .axis-label-x {
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
        }

        .axis-label-y {
            left: 15px;
            top: 50%;
            transform: translateY(-50%) rotate(-90deg);
        }

        .quadrant-point {
            position: absolute;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #667eea;
            border: 3px solid white;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.6);
            transform: translate(-50%, 50%);
            z-index: 10;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quadrant-point:hover {
            width: 20px;
            height: 20px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.8);
        }

        .quadrant-type {
            position: absolute;
            font-size: 18px;
            font-weight: bold;
            color: #666;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
        }

        .quadrant-type.top-left {
            top: 20px;
            left: 20px;
            color: #4caf50;
        }

        .quadrant-type.top-right {
            top: 20px;
            right: 20px;
            color: #ff9800;
        }

        .quadrant-type.bottom-left {
            bottom: 20px;
            left: 20px;
            color: #2196f3;
        }

        .quadrant-type.bottom-right {
            bottom: 20px;
            right: 20px;
            color: #f44336;
        }

        .axis-tick {
            position: absolute;
            background: #999;
        }

        .axis-tick-x {
            width: 1px;
            height: 8px;
            bottom: 50px;
        }

        .axis-tick-y {
            width: 8px;
            height: 1px;
            left: 60px;
        }

        .axis-tick-label {
            position: absolute;
            font-size: 12px;
            color: #666;
        }

        .axis-tick-label-x {
            bottom: 35px;
            transform: translateX(-50%);
        }

        .axis-tick-label-y {
            left: 45px;
            transform: translateY(-50%);
        }

        .center-line {
            position: absolute;
            background: #ddd;
            opacity: 0.5;
        }

        .center-line-x {
            width: 1px;
            height: calc(100% - 100px);
            left: 60px;
            bottom: 50px;
        }

        .center-line-y {
            width: calc(100% - 120px);
            height: 1px;
            left: 60px;
            bottom: 50px;
        }

        .diagnosis-result {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
        }

        .diagnosis-type {
            font-size: 36px;
            font-weight: bold;
            margin: 20px 0;
        }

        .diagnosis-desc {
            font-size: 18px;
            line-height: 1.8;
        }

        /* ç•™èµ„è¡¨å• */
        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: bold;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .dimension-scores {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .dimension-score-item {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .dimension-score-item .name {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .dimension-score-item .score {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }

        /* é¦–é¡µå†…å®¹åŒºå—æ ·å¼ */
        .intro-section,
        .instruction-section,
        .scoring-section {
            margin-bottom: 40px;
            padding: 25px;
            background: #f9f9f9;
            border-radius: 15px;
        }

        .intro-section h2,
        .instruction-section h2,
        .scoring-section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .intro-section p,
        .instruction-section ul,
        .scoring-section ul {
            font-size: 16px;
            line-height: 1.8;
            color: #333;
        }

        .instruction-section ul,
        .scoring-section ul {
            list-style: none;
            padding-left: 0;
        }

        .instruction-section ul li,
        .scoring-section ul li {
            margin-bottom: 12px;
            padding-left: 25px;
            position: relative;
        }

        .instruction-section ul li:before,
        .scoring-section ul li:before {
            content: "â€¢";
            position: absolute;
            left: 0;
            color: #667eea;
            font-weight: bold;
            font-size: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é¦–é¡µï¼ˆæµ‹è¯„è¯´æ˜ï¼‰ -->
        <div class="screen active" id="introScreen">
            <h1>ä¼ä¸šå¸‚åœºç«äº‰åŠ›è‡ªæµ‹</h1>
            
            <!-- æµ‹è¯„æè¿° -->
            <div class="intro-section">
                <h2>æµ‹è¯„ç®€ä»‹</h2>
                <p>
                    ä¼ä¸šå¸‚åœºç«äº‰åŠ›æµ‹è¯„æ—¨åœ¨å¸®åŠ©ä¼ä¸šå…¨é¢äº†è§£è‡ªèº«åœ¨å¸‚åœºä¸­çš„ç«äº‰åœ°ä½ï¼Œ
                    æœ¬æµ‹è¯„åŸºäºç¿Œç¨¼å’¨è¯¢ç‹¬åˆ›çš„"å¢é•¿æ²™æ¼æ¨¡å‹"ã€‚è¯¥æ¨¡å‹æ‘’å¼ƒäº†ä¼ ç»Ÿè´¢åŠ¡
                    æŒ‡æ ‡çš„æ»åæ€§ï¼Œé€šè¿‡"ä¸šç»©ä¸‰ç»“æ„"ï¼ˆè¿›æ”»ç«¯ï¼šéœ€æ±‚ã€ä»·å€¼ã€æ¸ é“ï¼‰ä¸
                    "ç»„ç»‡ä¸‰ç»“æ„"ï¼ˆæ”¯æ’‘ç«¯ï¼šç®¡ç†ã€èƒ½åŠ›ã€æ¿€åŠ±ï¼‰çš„é—­ç¯åˆ†æï¼Œæ­ç¤ºä¼ä¸š
                    å¢é•¿çš„åº•å±‚åŠ¨å› ã€‚è¯†åˆ«ä¼ä¸šåœ¨éœ€æ±‚ã€ä»·å€¼ã€æ¸ é“ã€å£å’ã€ç®¡ç†ã€èƒ½åŠ›ã€
                    æ¿€åŠ±å’Œæ•°å­—åŒ–è½¬å‹ç­‰å…«ä¸ªæ ¸å¿ƒç»´åº¦çš„è¡¨ç°ï¼Œä»è€Œä¸ºä¼ä¸šçš„æˆ˜ç•¥è§„åˆ’å’Œç»„ç»‡èƒ½åŠ›æå‡æä¾›æ•°æ®æ”¯æ’‘ã€‚
                </p>
            </div>
            
            <!-- æµ‹è¯„è¯´æ˜ -->
            <div class="instruction-section">
                <h2>ğŸ“‹ æµ‹è¯„è¯´æ˜</h2>
                <ul>
                    <li>æµ‹è¯„å¯¹è±¡ï¼šé€‚ç”¨äº To C ä¸šåŠ¡å’Œ To B ä¸šåŠ¡çš„ä¼ä¸š</li>
                    <li>æµ‹è¯„ç»´åº¦ï¼š8ä¸ªæ ¸å¿ƒç»“æ„ç»´åº¦ï¼Œæ¯ä¸ªç»´åº¦3é“é¢˜ç›®ï¼Œå…±24é“é¢˜</li>
                    <li>é¢„è®¡æ—¶é•¿ï¼š10-15åˆ†é’Ÿ</li>
                    <li>ç»“æœå‘ˆç°ï¼šåŒ…å«å››è±¡é™å®šä½åˆ†æã€CBIç«äº‰åŠ›æŒ‡æ•°ã€ç«äº‰åŠ›é›·è¾¾å›¾å’Œè¯¦ç»†å¾—åˆ†</li>
                </ul>
            </div>
            
            <!-- æ‰“åˆ†æ ‡å‡† -->
            <div class="scoring-section">
                <h2>ğŸ“Š æ‰“åˆ†æ ‡å‡†</h2>
                <ul>
                    <li>1åˆ† - ç›®å‰è¿˜æ˜¯ç©ºç™½ï¼Œæˆ–è€…ä¸»è¦å¤„äº"éšç›´è§‰è€Œè¡Œ"çš„çŠ¶æ€ã€‚</li>
                    <li>2åˆ† - åˆšå¼€å§‹æ„è¯†åˆ°å¹¶å°è¯•å»åšï¼Œç›®å‰ä¸»è¦é é›¶æ˜Ÿçš„ä¸ªäººåŠªåŠ›ã€‚</li>
                    <li>3åˆ† - åšåˆ°äº†åŠæ ¼æ°´å¹³ï¼Œä½†å¶å°”ä¸ç¨³å®šï¼Œå°šæœªå½¢æˆç³»ç»Ÿæ€§ä¼˜åŠ¿ã€‚</li>
                    <li>4åˆ† - å·²ç»æˆå‹å¹¶ç¨³å®šè¿è¡Œï¼Œä½†åœ¨æŸäº›ç»†èŠ‚ä¸Šè¿˜æœ‰æå‡ç©ºé—´ã€‚</li>
                    <li>5åˆ† - æˆ‘ä»¬å®Œå…¨åšåˆ°äº†ï¼Œä¸”å·²æˆä¸ºæˆ‘ä»¬çš„æ ¸å¿ƒç«äº‰ä¼˜åŠ¿ã€‚</li>
                </ul>
            </div>
            
            <!-- å¼€å§‹æµ‹è¯„æŒ‰é’® -->
            <button class="btn" id="startIntroBtn">å¼€å§‹æµ‹è¯„</button>
        </div>

        <!-- ä¸šåŠ¡ç±»å‹é€‰æ‹©ç•Œé¢ -->
        <div class="screen" id="businessTypeScreen">
            <h1>ä¼ä¸šå¸‚åœºç«äº‰åŠ›è‡ªæµ‹</h1>
            <h2 style="text-align: center; margin-bottom: 40px;">è¯·é€‰æ‹©æ‚¨çš„ä¸šåŠ¡ç±»å‹</h2>
            <div class="business-type-options">
                <div class="business-type-card" data-type="toc">
                    <h3>To C ä¸šåŠ¡</h3>
                    <p>é¢å‘æ¶ˆè´¹è€…çš„ä¸šåŠ¡æ¨¡å¼</p>
                </div>
                <div class="business-type-card" data-type="tob">
                    <h3>To B ä¸šåŠ¡</h3>
                    <p>é¢å‘ä¼ä¸šçš„ä¸šåŠ¡æ¨¡å¼</p>
                </div>
            </div>
            <button class="btn" id="startBtn" disabled>è¿›å…¥æµ‹è¯„</button>
        </div>

        <!-- ç­”é¢˜ç•Œé¢ -->
        <div class="screen" id="quizScreen">
            <h1>ä¼ä¸šå¸‚åœºç«äº‰åŠ›è‡ªæµ‹</h1>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="question-container" id="questionContainer"></div>
            <div class="navigation-buttons">
                <button class="btn btn-secondary" id="prevBtn" style="display: none;">ä¸Šä¸€é¢˜</button>
                <button class="btn" id="nextBtn">ä¸‹ä¸€é¢˜</button>
            </div>
        </div>

        <!-- ç»“æœå±•ç¤ºç•Œé¢ -->
        <div class="screen" id="resultScreen">
            <h1>æµ‹è¯„ç»“æœ</h1>
            
            <div class="diagnosis-result" id="diagnosisResult"></div>
            
            <div class="result-grid">
                <div class="result-card">
                    <h3>å››å®«æ ¼å®šä½åˆ†æ</h3>
                    <div style="position: relative; margin: 30px 0;">
                        <!-- ä¸šç»©èƒ½åŠ›æ ‡ç­¾ï¼ˆå·¦ä¾§ï¼‰ -->
                        <div style="position: absolute; left: 0; top: 50%; transform: translateY(-50%) rotate(-90deg); font-size: 16px; font-weight: bold; color: #333; white-space: nowrap;">
                            ä¸šç»©èƒ½åŠ›
                        </div>
                        <!-- å›¾è¡¨å®¹å™¨ -->
                        <div style="margin-left: 50px; margin-right: 50px; position: relative;">
                            <!-- ç»„ç»‡èƒ½åŠ›æ ‡ç­¾ï¼ˆé¡¶éƒ¨ï¼‰ -->
                            <div style="text-align: center; margin-bottom: 10px; font-size: 16px; font-weight: bold; color: #333;">
                                ç»„ç»‡èƒ½åŠ›
                            </div>
                            <!-- Canvaså›¾è¡¨ -->
                            <div style="text-align: center;">
                                <canvas id="quadrantChart" width="400" height="400" style="max-width: 100%; height: auto; border-radius: 10px; background: #fafafa;"></canvas>
                            </div>
                        </div>
                    </div>
                    <div id="quadrantDescription" style="padding: 20px; background: #f9f9f9; border-radius: 10px; margin-top: 20px;">
                        <!-- è±¡é™æè¿°å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                    </div>
                </div>
                
                <div class="result-card">
                    <h3>CBI ç«äº‰åŠ›æŒ‡æ•°</h3>
                    <div class="cbi-gauge">
                        <div class="cbi-score" id="cbiScore">0</div>
                        <div>ç«äº‰åŠ›æŒ‡æ•°</div>
                    </div>
                    <div id="cbiDiagnosis" style="margin-top: 20px; padding: 20px; background: #f9f9f9; border-radius: 10px; line-height: 1.8; color: #333;">
                        <!-- CBIè¯Šæ–­åˆ†æå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                    </div>
                </div>
            </div>

            <div class="result-card">
                <h3>ä¸ƒç»“æ„é›·è¾¾å›¾</h3>
                <div class="chart-container">
                    <canvas id="radarChart"></canvas>
                </div>
            </div>

            <div class="result-card">
                <h3>ç»“æ„å¾—åˆ†è¯¦æƒ…</h3>
                <div class="dimension-scores" id="dimensionScores"></div>
            </div>

            <button class="btn" id="getReportBtn">è·å–è¯¦ç»†è¯Šæ–­èµ„æ–™</button>
        </div>

        <!-- ç•™èµ„ç•Œé¢ -->
        <div class="screen" id="contactScreen">
            <h1>è·å–è¯¦ç»†è¯Šæ–­èµ„æ–™</h1>
            <p style="text-align: center; color: #666; margin-bottom: 30px;">è¯·å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼Œæˆ‘ä»¬å°†ä¸ºæ‚¨æä¾›è¯¦ç»†çš„è¯Šæ–­èµ„æ–™</p>
            
            <form id="contactForm">
                <div class="form-group">
                    <label>å§“å *</label>
                    <input type="text" id="userName" required placeholder="è¯·è¾“å…¥æ‚¨çš„å§“å">
                </div>
                <div class="form-group">
                    <label>å…¬å¸åç§° *</label>
                    <input type="text" id="companyName" required placeholder="è¯·è¾“å…¥å…¬å¸åç§°">
                </div>
                <div class="form-group">
                    <label>è”ç³»ç”µè¯ *</label>
                    <input type="tel" id="userPhone" required placeholder="è¯·è¾“å…¥è”ç³»ç”µè¯">
                </div>
                <button type="submit" class="btn">æäº¤ä»¥è·å–è¯¦ç»†è¯Šæ–­èµ„æ–™</button>
            </form>
        </div>

        <!-- æäº¤æˆåŠŸç•Œé¢ -->
        <div class="screen" id="successScreen">
            <div style="text-align: center; max-width: 600px; margin: 0 auto;">
                <div style="font-size: 80px; color: #667eea; margin-bottom: 30px;">âœ“</div>
                <h1 style="color: #333; margin-bottom: 20px; font-size: 32px;">æ„Ÿè°¢æ‚¨çš„å‚ä¸</h1>
                <p style="color: #666; margin-bottom: 40px; line-height: 1.8; font-size: 18px;">
                    æˆ‘ä»¬ä¼šæœ‰èµ„æ·±çš„è¡Œä¸šé¡¾é—®è”ç³»æ‚¨
                </p>
                <div style="background: #f5f5f5; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
                    <p style="color: #999; font-size: 14px; line-height: 1.6;">
                        æ‚¨çš„æµ‹è¯„æ•°æ®å·²æˆåŠŸæäº¤<br>
                        è¯·ä¿æŒç”µè¯ç•…é€šï¼Œæˆ‘ä»¬çš„é¡¾é—®å°†åœ¨è¿‘æœŸä¸æ‚¨å–å¾—è”ç³»
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // é¢˜ç›®æ•°æ®ç»“æ„ - 8ä¸ªç»“æ„ï¼Œæ¯ä¸ªç»“æ„3é“é¢˜
        const dimensions = ['éœ€æ±‚', 'ä»·å€¼', 'æ¸ é“', 'å£å’', 'ç®¡ç†', 'èƒ½åŠ›', 'æ¿€åŠ±', 'æ•°å­—åŒ–è½¬å‹'];
        
        // Supabase å®¢æˆ·ç«¯åˆå§‹åŒ–
        let supabaseClient = null;
        if (typeof window.SUPABASE_CONFIG !== 'undefined' && window.SUPABASE_CONFIG.url && window.SUPABASE_CONFIG.publishableKey) {
            try {
                supabaseClient = supabase.createClient(
                    window.SUPABASE_CONFIG.url,
                    window.SUPABASE_CONFIG.publishableKey
                );
                console.log('Supabase å®¢æˆ·ç«¯åˆå§‹åŒ–æˆåŠŸ');
            } catch (error) {
                console.error('Supabase å®¢æˆ·ç«¯åˆå§‹åŒ–å¤±è´¥:', error);
            }
        } else {
            console.warn('Supabase é…ç½®æœªæ‰¾åˆ°ï¼Œå°†ä½¿ç”¨ localStorage ä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ');
        }
        
        // ç»“æ„åç§°æ˜ å°„ï¼ˆä»JSONæ ¼å¼åˆ°ä»£ç æ ¼å¼ï¼‰
        const dimensionNameMap = {
            'éœ€æ±‚ç»“æ„': { name: 'éœ€æ±‚', index: 0 },
            'ä»·å€¼ç»“æ„': { name: 'ä»·å€¼', index: 1 },
            'æ¸ é“ç»“æ„': { name: 'æ¸ é“', index: 2 },
            'å£å’ç»“æ„': { name: 'å£å’', index: 3 },
            'ç®¡ç†ç»“æ„': { name: 'ç®¡ç†', index: 4 },
            'èƒ½åŠ›ç»“æ„': { name: 'èƒ½åŠ›', index: 5 },
            'æ¿€åŠ±ç»“æ„': { name: 'æ¿€åŠ±', index: 6 },
            'ç«äº‰å£å’': { name: 'å£å’', index: 3 }, // ç«äº‰å£å’ä¹Ÿæ˜ å°„åˆ°å£å’ç»“æ„
            'æ•°å­—åŒ–è½¬å‹': { name: 'æ•°å­—åŒ–è½¬å‹', index: 7 } // æ•°å­—åŒ–è½¬å‹ä½œä¸ºç‹¬ç«‹ç»“æ„
        };
        
        // Bç«¯ä¸šåŠ¡é¢˜ç›®æ•°æ®
        const tobQuestionsData = {
            "Bç«¯ä¸šåŠ¡è‡ªæµ‹é¢˜": [
                {
                    "dimension": "éœ€æ±‚ç»“æ„",
                    "questions": [
                        "æˆ‘ä»¬å¯¹æ ¸å¿ƒå¤§å®¢æˆ·çš„å†…éƒ¨å†³ç­–é€»è¾‘æœ‰é€å½»ç†è§£ã€‚ä¸ä»…è®¤è¯†é‡‡è´­çª—å£ï¼Œæ›´æ¸…æ™°æŒæ¡äº†æ‹æ¿è€…ï¼ˆè€æ¿ï¼‰ã€åˆ©ç›Šç›¸å…³è€…ã€ä»¥åŠæœ€ç»ˆä½¿ç”¨è€…å„è‡ªçš„çœŸå®ç—›ç‚¹ä¸éšå¿§ã€‚æˆ‘ä»¬èƒ½é’ˆå¯¹ä¸åŒè§’è‰²åˆ¶å®šå·®å¼‚åŒ–çš„å…¬å…³ä¸è¯´æœç­–ç•¥ï¼Œç¡®ä¿åœ¨å¤æ‚çš„å†³ç­–åšå¼ˆä¸­å æ®ä¸»åŠ¨ã€‚",
                        "æˆ‘ä»¬ä¸ä»…æ‡‚è‡ªå·±çš„äº§å“ï¼Œæ›´æ·±åˆ»ç†è§£å®¢æˆ·æ‰€å¤„çš„è¡Œä¸šè¶‹åŠ¿åŠå…¶é¢ä¸´çš„ç«äº‰å‹åŠ›ã€‚æˆ‘ä»¬èƒ½èµ°åœ¨å®¢æˆ·å‰é¢ï¼Œä¸ºå…¶æä¾›å…·æœ‰å‰ç»æ€§çš„å»ºè®®æˆ–é¢„è­¦ï¼ˆå³ï¼šå¸®å®¢æˆ·è§£å†³ä»–å®¢æˆ·çš„é—®é¢˜ï¼‰ã€‚åœ¨å¯¹æ–¹çœ¼ä¸­ï¼Œæˆ‘ä»¬æ˜¯ä¸å¯æˆ–ç¼ºçš„\"ä¸šåŠ¡ä¼™ä¼´\"ï¼Œè€Œéç®€å•çš„\"ä¾›åº”å•†\"ã€‚",
                        "æˆ‘ä»¬å…·å¤‡æå…¶çµæ•çš„éœ€æ±‚å›ä¼ æœºåˆ¶ã€‚ä¸€çº¿é”€å”®æˆ–äº¤ä»˜å›¢é˜Ÿè·å–çš„å®¢æˆ·ç‰¹æ®Šéœ€æ±‚ã€åæ§½æˆ–è¡Œä¸šæ–°è¶‹åŠ¿ï¼Œèƒ½è¿…é€Ÿåé¦ˆè‡³äº§å“/æœåŠ¡ç ”å‘ç«¯ã€‚æˆ‘ä»¬èƒ½é«˜æ•ˆåœ°å°†\"ä¸ªåˆ«å®¢æˆ·çš„ç—›ç‚¹\"è½¬åŒ–ä¸º\"è¡Œä¸šçš„é€šç”¨æ ‡å‡†åŠŸèƒ½\"ï¼Œç¡®ä¿äº§å“å§‹ç»ˆä¿æŒå¸‚åœºé¢†å…ˆçš„é€‚é…åº¦ã€‚"
                    ]
                },
                {
                    "dimension": "ä»·å€¼ç»“æ„",
                    "questions": [
                        "æˆ‘ä»¬ä¸åªæ‰¿è¯º\"è´¨é‡å¥½\"ï¼Œæ›´èƒ½é€šè¿‡ä¸¥å¯†çš„é€»è¾‘æˆ–æ•°æ®ï¼ˆå¦‚ï¼šæŠ•èµ„å›æŠ¥ç‡ ROIã€é™æœ¬æ¯”ä¾‹ã€å¢æ•ˆæ—¶é•¿ï¼‰ï¼Œå‘å®¢æˆ·æ¸…æ™°è¯æ˜äº§å“èƒ½å¸¦æ¥çš„çœŸé‡‘ç™½é“¶çš„æ”¶ç›Šã€‚æˆ‘ä»¬èƒ½å¸®å®¢æˆ·å†™å¥½é‚£ä»½æäº¤ç»™å…¶é«˜å±‚çš„\"ä¹°å•ç†ç”±\"ï¼Œè®©å†³ç­–å˜å¾—æå…¶ç†æ€§ä¸”ç®€å•ã€‚",
                        "æˆ‘ä»¬ä¸éœ€è¦æ¯æ¬¡éƒ½é‡æ–°å‘æ˜è½®å­ã€‚æˆ‘ä»¬èƒ½å¤Ÿåƒ\"æ­ç§¯æœ¨\"ä¸€æ ·ï¼Œé’ˆå¯¹ä¸åŒéœ€æ±‚çš„å®¢æˆ·å¿«é€Ÿç»„åˆå‡ºå·®å¼‚åŒ–çš„è§£å†³æ–¹æ¡ˆï¼ˆå¦‚ï¼šé’ˆå¯¹æˆé•¿å‹ä¼ä¸šçš„æè‡´æ€§ä»·æ¯”æ–¹æ¡ˆ vs. é’ˆå¯¹å¤´éƒ¨ä¼ä¸šçš„å…¨åŠŸèƒ½æ–¹æ¡ˆï¼‰ã€‚è¿™ç§æ ‡å‡†åŒ–åŸºç¡€ä¸Šçš„çµæ´»æ€§ï¼Œç¡®ä¿äº†äº¤ä»˜çš„é«˜æ•ˆç‡ã€‚",
                        "æˆ‘ä»¬ä¸ä»…äº†è§£å¯¹æ‰‹ï¼Œæ›´èƒ½åœ¨æŠ•æ ‡æˆ–æ²Ÿé€šä¸­ï¼Œç²¾å‡†ç‚¹å‡ºè‡ªå·±åœ¨ç‰¹å®šåœºæ™¯ä¸‹ä¼˜äºå¯¹æ‰‹çš„å…³é”®ç‚¹ã€‚æˆ‘ä»¬èƒ½ç»™å®¢æˆ·ä¸€ä¸ª\"éä½ ä¸å¯\"çš„ã€ç†æ€§çš„é€‰æ‹©è¯æ®ï¼Œç¡®ä¿å®¢æˆ·åœ¨è¿›è¡Œå¤šæ–¹æ¯”ä»·å’Œè¯„ä¼°åï¼Œä¾ç„¶è®¤ä¸ºæˆ‘ä»¬æ˜¯é£é™©æœ€ä½ã€æ”¶ç›Šæœ€é«˜çš„é€‰æ‹©ã€‚"
                    ]
                },
                {
                    "dimension": "æ¸ é“ç»“æ„",
                    "questions": [
                        "æˆ‘ä»¬ä¸ä¾èµ–å•ä¸€çš„\"ä¸šåŠ¡ç‰›äºº\"æˆ–å•ä¸€çš„è¡Œä¸šå…³ç³»ã€‚å…¬å¸å·²å»ºç«‹èµ·ç”±ä¸»åŠ¨ç›´é”€ã€åˆä½œä¼™ä¼´/ä»£ç†ä½“ç³»ã€ä»¥åŠçº¿ä¸Šå†…å®¹/è¡Œä¸šå£ç¢‘æ„æˆçš„å¤šå…ƒè·å®¢çŸ©é˜µã€‚å½“æŸä¸€æ¸ é“å—é˜»æ—¶ï¼Œå…¶ä»–è·¯å¾„èƒ½æŒç»­ä¾›è¡€ï¼Œç¡®ä¿å…¬å¸å§‹ç»ˆæŒæ¡è·å®¢çš„ä¸»åŠ¨æƒã€‚",
                        "æ— è®ºé€šè¿‡å“ªä¸ªåˆä½œä¼™ä¼´è§¦è¾¾å®¢æˆ·ï¼Œæˆ‘ä»¬éƒ½èƒ½ç¡®ä¿å…¶ä¼ é€’çš„ä¸“ä¸šæ–¹æ¡ˆã€æœåŠ¡æ ‡å‡†ä¸ä»·æ ¼ç­–ç•¥é«˜åº¦ç»Ÿä¸€ã€‚æˆ‘ä»¬é€šè¿‡æ ‡å‡†åŒ–çš„èµ‹èƒ½æœºåˆ¶ï¼ˆè€Œéå•çº¯çš„æ§ä»·ï¼‰ï¼Œè®©åˆä½œä¼™ä¼´æˆä¸ºæˆ‘ä»¬èƒ½åŠ›çš„å»¶ä¼¸ï¼Œç¡®ä¿å®¢æˆ·ä½“æ„Ÿä¸å› ä¸­é—´ç¯èŠ‚è€Œæ‰“æŠ˜ã€‚",
                        "æˆ‘ä»¬èƒ½æ¸…æ™°è¿½è¸ªæ¯ä¸€ä¸ªçº¿ç´¢ä»åˆæ¬¡è§¦è¾¾ã€æ–¹æ¡ˆåšå¼ˆåˆ°æœ€ç»ˆæˆäº¤çš„å…¨è¿‡ç¨‹è½¬åŒ–æ•ˆç‡ï¼ˆROIï¼‰ã€‚æˆ‘ä»¬ä¸ä»…å…³æ³¨ä¸€æ¬¡æ€§åˆåŒï¼Œæ›´å…·å¤‡æ•°å­—åŒ–æ‰‹æ®µè¿è¥å®¢æˆ·çš„\"å…¨ç”Ÿå‘½å‘¨æœŸä»·å€¼\"ï¼Œå®ç°äº†ä»\"ç›²ç›®æ‰¾å®¢æˆ·\"å‘\"ç²¾å‡†ç»è¥å•†æœº\"çš„è·¨è¶Šã€‚"
                    ]
                },
                {
                    "dimension": "ç®¡ç†ç»“æ„",
                    "questions": [
                        "ç»„ç»‡å†…éƒ¨ä¸å­˜åœ¨æ¨è¯¿å’Œå†—é•¿çš„å®¡æ‰¹æµç¨‹ã€‚ä¸€çº¿äººå‘˜åœ¨é¢å¯¹å®¢æˆ·æå‡ºçš„å•†åŠ¡æ¡ä»¶ã€æŠ€æœ¯å˜æ›´æˆ–æœåŠ¡è¯‰æ±‚æ—¶ï¼Œèƒ½å¤Ÿæé€Ÿè·å¾—å†…éƒ¨å†³ç­–æ”¯æŒå’Œèµ„æºè°ƒé…ã€‚æˆ‘ä»¬å§‹ç»ˆä¿æŒç€è·‘èµ¢ç«äº‰å¯¹æ‰‹çš„å“åº”é€Ÿåº¦ï¼Œä¸è®©å•†æœºæ­»åœ¨\"ç­‰å¾…å®¡æ‰¹\"çš„è·¯ä¸Šã€‚",
                        "é¢å¯¹å¤æ‚é¡¹ç›®ï¼Œé”€å”®ã€æŠ€æœ¯ï¼ˆé¢„å”®ï¼‰ä¸äº¤ä»˜å›¢é˜Ÿèƒ½è‡ªåŠ¨ç»„æˆç´§å¯†çš„ä½œæˆ˜å•å…ƒï¼ˆå¦‚ï¼šé“ä¸‰è§’æ¨¡å¼ï¼‰ã€‚å„èŒèƒ½ä¹‹é—´åˆ©ç›Šä¸€è‡´ã€ä¿¡æ¯åŒæ­¥ï¼Œä¸å­˜åœ¨\"éƒ¨é—¨å¢™\"æˆ–è´£ä»»æ¨è¯¿ï¼Œèƒ½å¤Ÿä»¥æ•´ä½“ä¸“ä¸šçš„å½¢è±¡ä¸ºå®¢æˆ·æä¾›ä¸€ç«™å¼ã€é—­ç¯å¼çš„æœåŠ¡ä½“éªŒã€‚",
                        "ç®¡ç†å±‚å…·å¤‡æ¸…æ™°çš„æœåŠ¡æ„è¯†ï¼Œå®šæœŸä¸»åŠ¨è¯†åˆ«å¹¶æ¸…ç†é‚£äº›é˜»ç¢ä¸šåŠ¡æµåŠ¨çš„å†—ä½™è§„å®šæˆ–æ— æ•ˆæ±‡æŠ¥ã€‚å…¬å¸çš„ç®¡ç†åŠ¨ä½œå§‹ç»ˆèšç„¦äºè§£å†³å®¢æˆ·é—®é¢˜ï¼Œç¡®ä¿ç»„ç»‡çš„æ¯ä¸€åˆ†ç²¾åŠ›éƒ½èŠ±åœ¨æå‡å®¢æˆ·æ»¡æ„åº¦å’ŒåˆåŒè¾¾æˆä¸Šï¼Œè€Œéæ¶ˆè€—åœ¨å†…éƒ¨å†…è€—ä¸­ã€‚"
                    ]
                },
                {
                    "dimension": "èƒ½åŠ›ç»“æ„",
                    "questions": [
                        "æˆ‘ä»¬å·²æˆåŠŸå°†æ ¸å¿ƒçš„ä¸šåŠ¡ç»éªŒã€æŠ€æœ¯æ–¹æ¡ˆå’Œé¡¹ç›®å¤ç›˜è½¬åŒ–ä¸ºç»„ç»‡çš„å…¬å…±èµ„äº§ï¼ˆè€Œéä»…åœ¨ç‰›äººè„‘å­é‡Œï¼‰ã€‚å³ä¾¿æ˜¯æ ¸å¿ƒäººå‘˜å˜åŠ¨ï¼Œæ–°äººä¹Ÿèƒ½é€šè¿‡ç°æœ‰çš„æ²‰æ·€å¿«é€Ÿè¾¾åˆ° 80 åˆ†çš„æœåŠ¡æ°´å¹³ï¼Œäº¤ä»˜è´¨é‡ä¸ä¼šäº§ç”Ÿå‰§çƒˆæ³¢åŠ¨ã€‚",
                        "å…·å¤‡æå¼ºçš„å¤–éƒ¨ç”Ÿæ€æ•´åˆèƒ½åŠ›ã€‚æˆ‘ä»¬éµå¾ª\"ä¸ä¸ºæˆ‘æ‰€æœ‰ï¼Œä½†ä¸ºæˆ‘æ‰€ç”¨\"çš„åŸåˆ™ï¼Œèƒ½ç†Ÿç»ƒè°ƒç”¨ä¸Šä¸‹æ¸¸åˆä½œä¼™ä¼´è§£å†³éæ ¸å¿ƒç¯èŠ‚ï¼Œä»è€Œä»¥æè½»çš„ç»„ç»‡æˆæœ¬ï¼Œä¸ºå®¢æˆ·æä¾›è¶…è¶Šè‡ªèº«è§„æ¨¡é™åˆ¶çš„å¤æ‚æ–¹æ¡ˆäº¤ä»˜èƒ½åŠ›ã€‚",
                        "æˆ‘ä»¬çš„æ ¸å¿ƒå›¢é˜Ÿæˆå‘˜å…·å¤‡äº¤å‰è§†è§’ï¼šé”€å”®æ‡‚æŠ€æœ¯å¯è¡Œæ€§ï¼ŒæŠ€æœ¯æ‡‚å•†åŠ¡ROIã€‚è¿™ä½¿å¾—æˆ‘ä»¬åœ¨é¢å¯¹å®¢æˆ·æ—¶ï¼Œèƒ½å¤Ÿæä¾›æå…·è½åœ°æ€§çš„å»ºè®®ï¼Œé¿å…äº†\"é”€å”®ä¹±æ‰¿è¯ºã€æŠ€æœ¯éš¾äº¤ä»˜\"çš„æ–­å±‚ï¼Œå±•ç°å‡ºæé«˜çš„èŒä¸šç´ å…»ã€‚"
                    ]
                },
                {
                    "dimension": "æ¿€åŠ±ç»“æ„",
                    "questions": [
                        "åˆ†é…æœºåˆ¶ä¸åªçœ‹çŸ­æœŸç­¾å•é¢ï¼Œæ›´èƒ½ç‰µå¼•å‘˜å·¥å»åšå¯¹å…¬å¸æˆ˜ç•¥æœ‰ç›Šçš„äº‹ï¼ˆå¦‚ï¼šè·å–è¡Œä¸šå¤´éƒ¨æ ‡æ†ã€ä¿è¯å›æ¬¾è´¨é‡ã€è¿½æ±‚é«˜è´¨é‡æ¯›åˆ©ï¼‰ã€‚å‘˜å·¥çš„ä¸ªäººæ”¶ç›Šä¸\"å®¢æˆ·æ˜¯å¦çœŸæ­£æˆåŠŸ\"é«˜åº¦å…³è”ï¼Œé¿å…äº†æ€é¸¡å–åµå¼çš„çŸ­æœŸé”€å”®è¡Œä¸ºã€‚",
                        "é’ˆå¯¹å¤æ‚é¡¹ç›®ï¼Œå…¬å¸å»ºç«‹äº†é”€å”®ã€æŠ€æœ¯ã€äº¤ä»˜å›¢é˜Ÿçš„åˆ©ç›Šåˆ†äº«æœºåˆ¶ã€‚å¤§å®¶ä¸å†æ˜¯\"å„æ‰«é—¨å‰é›ª\"ï¼Œè€Œæ˜¯ä¸ºäº†åŒä¸€ä¸ªåˆåŒç»“æœè´Ÿè´£ã€‚è¿™ç§\"åˆ©ç›Šå…±åŒä½“\"ç¡®ä¿äº†å‰åç«¯åœ¨é¡¹ç›®å…¨ç”Ÿå‘½å‘¨æœŸå†…çš„ç´§å¯†åä½œï¼Œå½»åº•æ¶ˆç­äº†å†…éƒ¨æ¨è¯¿ã€‚",
                        "å‘˜å·¥å¯¹è‡ªå·±çš„æ¿€åŠ±è·å–è§„åˆ™æ¸…æ™°é€æ˜ï¼Œä¸”åé¦ˆè¶³å¤Ÿå³æ—¶ï¼ˆä¸ä¸€å®šè¦ç­‰åˆ°å¹´åº•ï¼‰ã€‚é™¤äº†ç‰©è´¨å¥–åŠ±ï¼Œå…¬å¸èƒ½é€šè¿‡é¡¹ç›®å¤ç›˜ã€è£èª‰ä½“ç³»ç­‰æ–¹å¼ï¼Œè®©å‘˜å·¥æ„Ÿå—åˆ°è§£å†³è¡Œä¸šéš¾é¢˜çš„ä¸“ä¸šå°Šä¸¥ä¸æˆå°±æ„Ÿï¼Œä»è€Œæ¿€å‘å‡ºæ›´å¼ºçš„å†…åœ¨åŠ¨åŠ›ã€‚"
                    ]
                },
                {
                    "dimension": "æ•°å­—åŒ–è½¬å‹",
                    "questions": [
                        "ä»å®¢æˆ·åˆæ¬¡è§¦è¾¾ã€åˆåŒæ‰§è¡Œåˆ°å”®åç»´æŠ¤ï¼Œæ‰€æœ‰å…³é”®èŠ‚ç‚¹å‡å®ç°æ•°å­—åŒ–è®°å½•ï¼ˆè€Œéå£å¤´æ±‡æŠ¥ï¼‰ã€‚ç®¡ç†å±‚èƒ½éšæ—¶è°ƒå–çœŸå®ã€å®¢è§‚çš„ä¸šåŠ¡è¿›åº¦ä¸è½¬åŒ–æ•°æ®ï¼Œå†³ç­–å»ºç«‹åœ¨ç¡®å‡¿çš„äº‹å®åŸºç¡€ä¹‹ä¸Šï¼Œå½»åº•æ¶ˆç­äº†å†…éƒ¨çš„\"ä¿¡æ¯é»‘ç®±\"ã€‚",
                        "å†…éƒ¨ç®¡ç†ï¼ˆå®¡æ‰¹ã€ä»»åŠ¡æŒ‡æ´¾ã€çŸ¥è¯†å…±äº«ï¼‰æ·±åº¦ä¾èµ–æ•°å­—åŒ–å·¥å…·ã€‚ä¿¡æ¯æµè½¬ä¸å†ä¾èµ–\"äººæ‰¾äºº\"æˆ–åå¤å‚¬ä¿ƒï¼Œè€Œæ˜¯é€šè¿‡ç³»ç»Ÿçš„è‡ªåŠ¨åŒ–æé†’ä¸è¿›åº¦è¿½è¸ªå®ç°ã€‚è¿™ç§\"è‡ªè¿è¡Œ\"çš„æµç¨‹æå¤§åœ°é™ä½äº†è·¨éƒ¨é—¨åä½œçš„æ‘©æ“¦åŠ›ä¸å†…è€—ã€‚",
                        "æˆ‘ä»¬çš„æ ¸å¿ƒå†³ç­–ï¼ˆå¦‚è¿›è´§é‡ã€ä¸»æ¨æ¬¾ã€å®šä»·ï¼‰ä¸å†ä»…å‡­ç›´è§‰æˆ–ç»éªŒï¼Œè€Œæ˜¯å»ºç«‹åœ¨å¯¹çœŸå®ç»è¥æ•°æ®çš„é—­ç¯åˆ†æä¹‹ä¸Šã€‚æˆ‘ä»¬èƒ½é€šè¿‡å†å²æ•°æ®é¢„åˆ¤è¶‹åŠ¿ï¼Œé¿å…äº†ç”±äºç›²ç›®å†³ç­–å¯¼è‡´çš„åº“å­˜ç§¯å‹æˆ–é”™å¤±è‰¯æœºã€‚"
                    ]
                },
                {
                    "dimension": "ç«äº‰å£å’",
                    "questions": [
                        "æˆ‘ä»¬èƒ½æ¸…æ™°è¯†åˆ«å‡ºé‚£äº›\"å¯¹æ‰‹èŠ±é’±ä¹Ÿä¹°ä¸èµ°\"çš„ç­¹ç ï¼ˆå¦‚ï¼šä¸“æœ‰æŠ€æœ¯ã€æ ‡æ†å®¢æˆ·çš„æ·±åº¦ä¿¡ä»»ã€æˆ–è¡Œä¸šæ ‡å‡†è¯è¯­æƒï¼‰ã€‚å…¬å¸ä¸ä»…åœ¨ç›ˆåˆ©ï¼Œæ›´åœ¨æŒç»­æŠ•å…¥èµ„æºå»å¼ºåŒ–è¿™äº›èµ„äº§ï¼Œç¡®ä¿éšç€æ—¶é—´æ¨ç§»ï¼Œè¿™é“æŠ¤åŸæ²³å˜å¾—è¶Šæ¥è¶Šå®½ã€‚",
                        "æˆ‘ä»¬ä¸å®¢æˆ·çš„å…³ç³»ä¸åªæ˜¯ç®€å•çš„ä¹°å–ï¼Œè€Œæ˜¯å®ç°äº†ä¸šåŠ¡æµç¨‹ã€æ•°æ®è¿æ¥æˆ–æœåŠ¡ä½“ç³»çš„æ·±åº¦åµŒå…¥ã€‚è¿™ä½¿å¾—å®¢æˆ·å¦‚æœè½¬å‘ç«äº‰å¯¹æ‰‹ï¼Œå°†é¢ä¸´å·¨å¤§çš„æ—¶é—´æˆæœ¬ã€ä¸šåŠ¡é£é™©æˆ–ååŒæƒ¯æ€§ï¼Œå½¢æˆäº†\"éä½ ä¸å¯\"çš„é•¿æœŸç²˜æ€§ã€‚",
                        "æˆ‘ä»¬çš„ç«äº‰åŠ›å»ºç«‹åœ¨**\"æ¯”åŒè¡Œæ›´é«˜æ•ˆ\"çš„ç»„ç»‡é€»è¾‘ä¹‹ä¸Šï¼ˆå¦‚ï¼šæä¼˜çš„ä¾›åº”é“¾é…å¥—ã€æ›´çŸ­çš„äº¤ä»˜å‘¨æœŸã€æˆ–æ›´ä½çš„è·å®¢æˆæœ¬ï¼‰ã€‚å³ä¾¿å¸‚åœºå‘ç”Ÿä»·æ ¼æˆ˜ï¼Œæˆ‘ä»¬ä¾ç„¶èƒ½å‡­å€Ÿå“è¶Šçš„æˆæœ¬å¼¹æ€§å’Œå‘¨è½¬é€Ÿåº¦**ç«‹äºä¸è´¥ä¹‹åœ°ï¼Œè®©å¯¹æ‰‹æ— ä»ä¸‹æ‰‹ã€‚"
                    ]
                }
            ]
        };

        // Cç«¯ä¸šåŠ¡é¢˜ç›®æ•°æ®
        const tocQuestionsData = [
            {
                "dimension": "éœ€æ±‚ç»“æ„",
                "questions": [
                    "æˆ‘ä»¬èƒ½ç©¿é€è¡¨é¢çš„ç»Ÿè®¡æ•°æ®ï¼ˆå¦‚æ€§åˆ«ã€å¹´é¾„ï¼‰ï¼Œç²¾å‡†æ•æ‰å®¢æˆ·çš„ç”Ÿæ´»åœºæ™¯ã€åŠ¨æœºä¸æ½œåœ¨ç—›ç‚¹ï¼ˆä¾‹å¦‚ï¼šçŸ¥é“ç”¨æˆ·ä¹°å•æ˜¯ä¸ºäº†\"æˆåˆ†å®‰å…¨\"è¿˜æ˜¯\"ç¤¾äº¤é¢å­\"ï¼‰ã€‚å¹¶ä¸”ï¼Œæˆ‘ä»¬èƒ½é’ˆå¯¹ä¸åŒéœ€æ±‚çš„å®¢æˆ·ç¾¤ä½“æä¾›å·®å¼‚åŒ–çš„ä¿¡æ¯æˆ–æ–¹æ¡ˆï¼Œå®ç°æé«˜çš„è½¬åŒ–æ•ˆç‡ã€‚",
                    "å†³ç­–å±‚ä¸æ ¸å¿ƒå›¢é˜Ÿå…·å¤‡æå¼ºçš„\"ç”¨æˆ·è§¦è§‰\"ï¼Œä¸ä¾èµ–äºŒæ‰‹æ±‡æŠ¥ï¼Œèƒ½é€šè¿‡ç›´æ¥å¯¹è¯æˆ–ä¸€çº¿è§‚å¯Ÿè·å–æœ€çœŸå®çš„ç”¨æˆ·åé¦ˆã€‚è¿™ç§ç¬¬ä¸€æ‰‹æ´å¯Ÿèƒ½è¿…é€Ÿè½¬åŒ–ä¸ºäº§å“ä¼˜åŒ–æˆ–æœåŠ¡è¿­ä»£çš„å…·ä½“åŠ¨ä½œï¼Œè€Œéä»…åœç•™åœ¨è®¨è®ºé˜¶æ®µã€‚",
                    "åœ¨é‡å¤§èµ„æºæŠ•å…¥ï¼ˆå¦‚æ–°äº§å“å‘å¸ƒã€å¤§ä¿ƒï¼‰å‰ï¼Œæˆ‘ä»¬å…·å¤‡ä¸€å¥—æœ‰æ•ˆçš„éªŒè¯æœºåˆ¶ï¼ˆå¦‚ç§å­ç”¨æˆ·å†…æµ‹ã€æ ·æ¿è¯•é”™ç­‰ï¼‰ã€‚é€šè¿‡çœŸå®åé¦ˆå¯¹æ–¹æ¡ˆè¿›è¡Œå¿«é€Ÿä¿®æ­£ï¼Œç¡®ä¿æœ€ç»ˆæ¨å‘å¸‚åœºæ—¶ç²¾å‡†å‡»ä¸­éœ€æ±‚ï¼Œæå¤§é™ä½äº†å†³ç­–çš„ç›²ç›®æ€§ä¸èµ„æºæµªè´¹ã€‚"
                ]
            },
            {
                "dimension": "ä»·å€¼ç»“æ„",
                "questions": [
                    "æˆ‘ä»¬æ‹¥æœ‰èƒ½è®©ç”¨æˆ·ç§’æ‡‚ã€å¥½è®°ã€ä¸”ä¸å¯¹æ‰‹å½¢æˆæ˜¾è‘—å·®å¼‚çš„\"æ ¸å¿ƒè´­ä¹°ç†ç”±\"ï¼ˆä¾‹å¦‚ï¼šè§£å†³æŸä¸ªå…·ä½“ç—›ç‚¹æˆ–æä¾›ç‹¬ç‰¹æ ‡ç­¾ï¼‰ã€‚æ— è®ºæ˜¯åœ¨çº¿ä¸Šé¡µé¢è¿˜æ˜¯çº¿ä¸‹æ²Ÿé€šï¼Œæˆ‘ä»¬å§‹ç»ˆæå…¶å…‹åˆ¶åœ°èšç„¦åœ¨è¿™ä¸ªç‚¹ä¸Šï¼Œç»ä¸è®©å†—ä½™ä¿¡æ¯å¹²æ‰°ç”¨æˆ·çš„è´­ä¹°å†³ç­–ã€‚",
                    "æˆ‘ä»¬ä¸ä»…åœ¨å£å¤´æ‰¿è¯ºä»·å€¼ï¼Œæ›´åœ¨ç”¨æˆ·æœ€åœ¨æ„çš„\"å…³é”®æ—¶åˆ»\"ï¼ˆå¦‚æ”¯ä»˜ã€äº¤ä»˜ã€å”®åï¼‰è®¾è®¡äº†å…·ä½“çš„åŠ¨ä½œï¼Œç¡®ä¿ç”¨æˆ·èƒ½å®å®åœ¨åœ¨åœ°\"æŠ“\"åˆ°è¿™ç§å¥½æ„Ÿã€‚è¿™ç§ä½“éªŒæ˜¯ç¨³å®šä¸”å…·æœ‰ç¡®å®šæ€§çš„ï¼Œèƒ½è®©ç”¨æˆ·æ„Ÿå—åˆ°æˆ‘ä»¬è¿œè¶…è¡Œä¸šå¹³å‡æ°´å¹³çš„è¯šæ„ã€‚",
                    "æˆ‘ä»¬å¯¹èµ›é“å†…ä¸»è¦å¯¹æ‰‹çš„ä¼˜ç¼ºç‚¹äº†å¦‚æŒ‡æŒã€‚æˆ‘ä»¬èƒ½æå…¶å…·ä½“åœ°æŒ‡å‡ºï¼šåœ¨å“ªä¸ªç‰¹å®šåœºæ™¯æˆ–ç»´åº¦ä¸‹ï¼Œæˆ‘ä»¬æ¯”å¯¹æ‰‹åšå¾—æ›´å¥½ï¼Œå¹¶ä¸”èƒ½ç»™ç”¨æˆ·ä¸€ä¸ª\"æ— æ³•æ‹’ç»\"çš„ã€ç†æ€§çš„é€‰æ‹©ç†ç”±ï¼Œè€Œéä»…ä»…åœç•™åœ¨\"æˆ‘ä»¬æœåŠ¡æ›´å¥½\"è¿™ç§æ¨¡ç³Šçš„è¡¨è¿°ä¸Šã€‚"
                ]
            },
            {
                "dimension": "æ¸ é“ç»“æ„",
                "questions": [
                    "æˆ‘ä»¬æ‹’ç»ç›²ç›®æŠ•æµï¼Œè€Œæ˜¯åŸºäºå¯¹æ ¸å¿ƒå®¢æˆ·ç”»åƒçš„æ·±åˆ»ç†è§£ï¼Œé€šè¿‡éªŒè¯é”å®šäº†æœ€é«˜æ•ˆçš„ 3-5 ä¸ªæ ¸å¿ƒè·å®¢è·¯å¾„ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé’ˆå¯¹ä¸åŒæ¸ é“çš„å±æ€§ï¼ˆå¦‚ç¤¾äº¤æ°›å›´ã€ç¤¾åŒºå…³ç³»ç­‰ï¼‰å®šåˆ¶å·®å¼‚åŒ–çš„è¡¨è¾¾æ–¹æ¡ˆï¼Œç¡®ä¿åœ¨æ¯ä¸ªæ¥è§¦ç‚¹éƒ½èƒ½ç²¾å‡†å‡»ä¸­ç›®æ ‡ç”¨æˆ·çš„éœ€æ±‚ã€‚",
                    "æˆ‘ä»¬æ‹¥æœ‰ä¸€å¥—ç†æ€§çš„\"æ¸ é“è´¦æœ¬\"ï¼Œèƒ½æ¸…æ™°æ´å¯Ÿæ¯ä¸ªè·å®¢æ¥æºçš„çœŸå®æˆæœ¬ä¸è½¬åŒ–æ•ˆç‡ã€‚å›¢é˜Ÿä¸å‡­æ„Ÿè§‰æŠ•å…¥èµ„æºï¼Œå¯¹äºè½¬åŒ–ä½ã€å®¢ç¾¤ä¸ç²¾å‡†çš„æ¸ é“å…·å¤‡æå¼ºçš„åœæŸä¸è°ƒä¼˜æ‰§è¡ŒåŠ›ï¼Œç¡®ä¿è¥é”€èµ„æºå§‹ç»ˆæµå‘äº§å‡ºæœ€é«˜çš„è·¯å¾„ã€‚",
                    "æˆ‘ä»¬å°†è·å®¢è§†ä¸ºé•¿æœŸç»è¥çš„å¼€å§‹è€Œéç»“æŸã€‚æ¯ä¸€ä¸ªæ–°å®¢æˆ·éƒ½ä¼šé€šè¿‡æ ‡å‡†åŒ–çš„ç•™å­˜è·¯å¾„æ²‰æ·€ä¸ºå…¬å¸çš„è‡ªæœ‰æ•°å­—åŒ–èµ„äº§ã€‚é€šè¿‡é…å¥—çš„æŒç»­ç»è¥åŠ¨ä½œï¼Œæˆ‘ä»¬å°†å•æ¬¡äº¤æ˜“è½¬åŒ–ä¸ºé«˜é¢‘å¤è´­ä¸å£ç¢‘æ¨èï¼Œæ˜¾è‘—é™ä½äº†é•¿æœŸçš„è·å®¢æˆæœ¬ã€‚"
                ]
            },
            {
                "dimension": "ç®¡ç†ç»“æ„",
                "questions": [
                    "ç»„ç»‡å†…éƒ¨æ²¡æœ‰å†—é•¿çš„æ±‡æŠ¥å±‚çº§ã€‚ä¸€çº¿äººå‘˜å‘ç°çš„å¸‚åœºæœºä¼šæˆ–ç”¨æˆ·æŠ±æ€¨ï¼Œèƒ½è¿…é€Ÿè§¦è¾¾å†³ç­–è€…ã€‚å›¢é˜Ÿèƒ½ä»¥æçŸ­çš„æ—¶é—´å®Œæˆ\"å†³ç­–-è¡ŒåŠ¨-åé¦ˆ\"çš„é—­ç¯ï¼Œç¡®ä¿åœ¨ç¬æ¯ä¸‡å˜çš„å¸‚åœºä¸­å§‹ç»ˆæ¯”å¯¹æ‰‹å¿«åŠæ‹ã€‚",
                    "æ ¸å¿ƒæˆå‘˜å¯¹è‡ªå·±çš„æƒåŠ›è¾¹ç•Œæœ‰æ¸…æ™°å…±è¯†ï¼ˆæ— è®ºæœ‰æ— ä¹¦é¢æˆæƒæ‰‹å†Œï¼‰ã€‚åœ¨èŒè´£èŒƒå›´å†…ï¼Œæˆå‘˜æ•¢äºç›´æ¥æ‹æ¿å¹¶å¯¹ç»“æœè´Ÿè´£ï¼Œæ— éœ€å‡¡äº‹è¯·ç¤ºè€æ¿ã€‚è¿™ç¡®ä¿äº†ä¸šåŠ¡ä¸ä¼šå› ä¸º\"ç­‰å¾…è€æ¿å®¡æ‰¹\"è€Œä¸§å¤±æ—¶æœºã€‚",
                    "ç®¡ç†å±‚å…·å¤‡æå¼ºçš„\"åç†µå¢\"æ„è¯†ï¼Œèƒ½éšæ—¶è¯†åˆ«å¹¶æœæ–­ç æ‰é‚£äº›\"ä¸ºäº†ç®¡ç†è€Œç®¡ç†\"ã€å¯¹å®¢æˆ·ä»·å€¼è´¡çŒ®å¾®å¼±çš„ä½æ•ˆæµç¨‹ã€‚ç»„ç»‡å§‹ç»ˆä¿æŒç€åˆ›ä¸šåˆæœŸçš„è½»é‡æ„Ÿï¼Œç¡®ä¿æ¯ä¸€åˆ†ç²¾åŠ›éƒ½èŠ±åœ¨åˆ›é€ ä»·å€¼ä¸Šã€‚"
                ]
            },
            {
                "dimension": "èƒ½åŠ›ç»“æ„",
                "questions": [
                    "æ ¸å¿ƒä¸šåŠ¡èƒ½åŠ›å·²æˆåŠŸä»\"ä¸ªäººç»éªŒ\"è½¬åŒ–ä¸º\"ç»„ç»‡èµ„äº§\"ã€‚å³ä¾¿æ˜¯å…³é”®å²—ä½æ¢äººï¼Œæ–°äººä¹Ÿèƒ½é€šè¿‡ç°æˆçš„æ–¹æ³•è®ºå’Œå·¥å…·å¿«é€Ÿä¸Šæ‰‹å¹¶è¾¾åˆ°æ ‡å‡†æ°´å¹³ï¼Œä¸šåŠ¡è´¨é‡ä¸ä¼šå› ä¸ªåˆ«ç‰›äººçš„ç¦»å¼€è€Œäº§ç”Ÿå‰§çƒˆæ³¢åŠ¨ã€‚",
                    "å…·å¤‡æå¼ºçš„\"èµ„æºè°ƒåº¦\"æ„è¯†ï¼Œéµå¾ª\"ä¸ä¸ºæˆ‘æ‰€æœ‰ï¼Œä½†ä¸ºæˆ‘æ‰€ç”¨\"çš„åŸåˆ™ã€‚èƒ½ç†Ÿç»ƒè°ƒç”¨å¤–éƒ¨ä¸“ä¸šåŠ›é‡å¤„ç†éæ ¸å¿ƒç¯èŠ‚ï¼Œç¡®ä¿å…¬å¸å§‹ç»ˆèšç„¦äºé«˜ä»·å€¼æ ¸å¿ƒä¸šåŠ¡ï¼Œä»¥æè½»çš„ç»„ç»‡æˆæœ¬å®ç°ä¸šåŠ¡è§„æ¨¡çš„å¿«é€Ÿæ‰©å……ã€‚",
                    "æ ¸å¿ƒå›¢é˜Ÿæˆå‘˜å…·å¤‡å…¨å±€è§†é‡ï¼Œèƒ½å¤Ÿç†è§£ä¸Šä¸‹æ¸¸ç¯èŠ‚ã€‚ç»„ç»‡å†…éƒ¨ä¸å­˜åœ¨\"ä¿¡æ¯å­¤å²›\"æˆ–\"å…¨æ‘å”¯ä¸€çš„å¸Œæœ›\"ï¼Œåœ¨çªå‘çŠ¶å†µæˆ–ä¸šåŠ¡é«˜å³°æœŸï¼Œå†…éƒ¨äººåŠ›èƒ½çµæ´»äº’è¡¥ï¼Œç¡®ä¿æ•´ä¸ªäº¤ä»˜é“¾æ¡ä¸ä¼šå› ä¸ºæŸä¸ªç¯èŠ‚çš„äººæ‰‹çŸ­ç¼ºè€Œç˜«ç—ªã€‚"
                ]
            },
            {
                "dimension": "æ¿€åŠ±ç»“æ„",
                "questions": [
                    "å…¬å¸çš„åˆ†é…æœºåˆ¶ä¸ä»…æ˜¯ä¸ºäº†\"å¥–åŠ±ä¸šç»©\"ï¼Œæ›´èƒ½æœ‰æ•ˆç‰µå¼•å‘˜å·¥å»åšå¯¹å…¬å¸é•¿è¿œå‘å±•æœ‰ç›Šçš„äº‹ï¼ˆå¦‚ï¼šç»´æŠ¤å“ç‰Œå£ç¢‘ã€æå‡è€å®¢å¤è´­ã€æ²‰æ·€ç»„ç»‡èƒ½åŠ›ï¼‰ã€‚å‘˜å·¥çš„ä¸ªäººæ”¶ç›Šä¸å…¬å¸é˜¶æ®µæ€§ç›®æ ‡çš„è¾¾æˆæ·±åº¦æ†ç»‘ï¼Œå®ç°\"åŠ›å¾€ä¸€å¤„ä½¿\"ã€‚",
                    "åˆ†é…æ–¹æ¡ˆæœ‰æ•ˆæ¶ˆç­äº†\"éƒ¨é—¨å¢™\"ï¼Œæ ¸å¿ƒå›¢é˜Ÿæ„è¯†åˆ°åªæœ‰å…¬å¸æ•´ä½“ä¸šç»©å¢é•¿å’Œç”¨æˆ·ä½“æ„Ÿæå‡ï¼Œä¸ªäººæ‰èƒ½è·å¾—æœ€å¤§å›æŠ¥ã€‚åœ¨é¢å¯¹è·¨èŒèƒ½ä»»åŠ¡æ—¶ï¼Œå›¢é˜Ÿèƒ½è‡ªå‘åä½œè€Œéäº’ç›¸æ¨è¯¿ï¼Œå½¢æˆäº†\"æ•´ä½“åˆ©ç›Šå¤§äºå±€éƒ¨åˆ©ç›Š\"çš„å…±è¯†ã€‚",
                    "å‘˜å·¥èƒ½æ¸…æ™°çŸ¥æ™“è‡ªå·±çš„æ¯ä¸€åˆ†æŠ•å…¥å°†å¦‚ä½•è½¬åŒ–ä¸ºå›æŠ¥ã€‚æ¿€åŠ±åé¦ˆè¶³å¤ŸåŠæ—¶ä¸”é€æ˜ï¼Œèƒ½å¤Ÿæ¿€å‘ä¸€çº¿äººå‘˜çš„è‡ªé©±åŠ¨åŠ›ï¼Œè®©ä»–ä»¬åœ¨èµšé’±çš„åŒæ—¶ï¼Œå¯¹èŒä¸šå‘å±•æˆ–å“ç‰Œæ„¿æ™¯äº§ç”Ÿå¼ºçƒˆçš„å¿ƒç†è®¤åŒä¸æˆå°±æ„Ÿã€‚"
                ]
            },
            {
                "dimension": "æ•°å­—åŒ–è½¬å‹",
                "questions": [
                    "è·å®¢åˆ°äº¤ä»˜çš„å…¨è¿‡ç¨‹å‡å®ç°æ•°å­—åŒ–ç•™ç—•ï¼ˆæ— è®ºé€šè¿‡ CRM è¿˜æ˜¯ç²¾ç»†çš„è‡ªå»ºè¡¨ï¼‰ã€‚ç®¡ç†å±‚èƒ½å®æ—¶ã€çœŸå®åœ°æŒæ¡ä¸šåŠ¡è¿›åº¦ä¸è½¬åŒ–æ•°æ®ï¼Œå†³ç­–åŸºäºå®¢è§‚äº‹å®è€Œéä¸‹å±çš„å£å¤´æ±‡æŠ¥ï¼Œå½»åº•æœç»äº†\"ä¿¡æ¯é»‘ç®±\"ã€‚",
                    "æ—¥å¸¸ç®¡ç†ï¼ˆå®¡æ‰¹ã€ååŒã€ä»»åŠ¡æŒ‡æ´¾ï¼‰æ·±åº¦ä¾èµ–æ•°å­—åŒ–å·¥å…·ï¼Œæ¶ˆç­äº†å¤§é‡\"äººæ‰¾äºº\"çš„æ²Ÿé€šå†…è€—ã€‚ç³»ç»Ÿèƒ½è‡ªåŠ¨è¿½è¸ªè¿›åº¦å¹¶å®æ—¶æé†’ï¼Œä½¿ç»„ç»‡å†…éƒ¨çš„ä¿¡æ¯æµè½¬åƒæµæ°´ä¸€æ ·é¡ºç•…ï¼Œæå¤§åœ°é™ä½äº†ç®¡ç†çš„\"æ‘©æ“¦åŠ›\"ã€‚",
                    "æˆ‘ä»¬çš„æ ¸å¿ƒå†³ç­–ï¼ˆå¦‚è¿›è´§é‡ã€ä¸»æ¨æ¬¾ã€å®šä»·ï¼‰ä¸å†ä»…å‡­ç›´è§‰æˆ–ç»éªŒï¼Œè€Œæ˜¯å»ºç«‹åœ¨å¯¹çœŸå®ç»è¥æ•°æ®çš„é—­ç¯åˆ†æä¹‹ä¸Šã€‚æˆ‘ä»¬èƒ½é€šè¿‡å†å²æ•°æ®é¢„åˆ¤è¶‹åŠ¿ï¼Œé¿å…äº†ç”±äºç›²ç›®å†³ç­–å¯¼è‡´çš„åº“å­˜ç§¯å‹æˆ–é”™å¤±è‰¯æœºã€‚"
                ]
            },
            {
                "dimension": "ç«äº‰å£å’",
                "questions": [
                    "æˆ‘ä»¬æ¸…æ™°åœ°çŸ¥é“å“ªäº›æ˜¯å¯¹æ‰‹\"èŠ±é’±ä¹Ÿä¹°ä¸èµ°\"çš„ç­¹ç ï¼ˆå¦‚ï¼šç‹¬ç‰¹çš„å“ç‰Œå¿ƒæ™ºã€ä¸“æœ‰æŠ€æœ¯æˆ–æé«˜çš„å®¢æˆ·ä¿¡ä»»ï¼‰ã€‚å…¬å¸ä¸ä»…åœ¨è¿è¥ï¼Œæ›´åœ¨æœ‰æ„è¯†åœ°æŠ•å…¥èµ„æºå»å¼ºåŒ–è¿™äº›èµ„äº§ï¼Œç¡®ä¿éšç€æ—¶é—´æ¨ç§»ï¼Œè¿™é“æŠ¤åŸæ²³å˜å¾—è¶Šæ¥è¶Šå®½ï¼Œäº§ç”Ÿæ›´å¼ºçš„å¤åˆ©æ•ˆåº”ã€‚",
                    "æˆ‘ä»¬ä¸å®¢æˆ·ä¹‹é—´å½¢æˆäº†ä¸ä»…é™äºä¹°å–çš„å…³ç³»ã€‚é€šè¿‡ä¼šå‘˜ä½“ç³»ã€å¢å€¼æœåŠ¡æˆ–æƒ…æ„Ÿè¿æ¥ï¼Œæˆ‘ä»¬è®©å®¢æˆ·ç¦»å¼€æˆ‘ä»¬çš„ä»£ä»·æé«˜ï¼ˆæˆ–æä¸æ–¹ä¾¿ï¼‰ã€‚å®¢æˆ·å¯¹æˆ‘ä»¬çš„ä¾èµ–åº¦æå¼ºï¼Œå½¢æˆäº†é•¿æœŸç¨³å®šçš„\"éä½ ä¸å¯\"çš„è´­ä¹°æƒ¯æ€§ã€‚",
                    "æˆ‘ä»¬çš„ç«äº‰åŠ›å»ºç«‹åœ¨**\"æ¯”å¯¹æ‰‹æ›´é«˜æ•ˆ\"çš„åŸºç¡€ä¸Šï¼ˆå¦‚ï¼šæä¼˜çš„ä¾›åº”é“¾ã€æé«˜çš„å‘¨è½¬æˆ–æç®€çš„ç»„ç»‡ï¼‰ã€‚è¿™ä½¿å¾—æˆ‘ä»¬åœ¨ç»´æŒåŒç­‰ä»·å€¼äº§å‡ºçš„å‰æä¸‹ï¼Œå…·å¤‡è¿œè¶…è¡Œä¸šå¹³å‡æ°´å¹³çš„æˆæœ¬å¼¹æ€§å’Œååº”é€Ÿåº¦**ï¼Œè®©å¯¹æ‰‹åœ¨å‘åŠ¨ä»·æ ¼æˆ˜æˆ–èµ„æºæˆ˜æ—¶ç”±äº\"è·Ÿä¸èµ·\"è€Œæ— ä»ä¸‹æ‰‹ã€‚"
                ]
            }
        ];

        // é¢˜ç›®æ¨¡æ¿
        const questionsTemplate = {
            toc: [],
            tob: []
        };
        
        // åˆå§‹åŒ–To Bé¢˜ç›®
        function initToBQuestions() {
            const tobData = tobQuestionsData["Bç«¯ä¸šåŠ¡è‡ªæµ‹é¢˜"];
            questionsTemplate.tob = [];
            
            console.log('åˆå§‹åŒ–To Bé¢˜ç›®ï¼Œå…±', tobData.length, 'ä¸ªç»“æ„');
            
            tobData.forEach(dimData => {
                const dimInfo = dimensionNameMap[dimData.dimension];
                if (dimInfo) {
                    console.log(`å¤„ç†ç»“æ„: ${dimData.dimension} -> ${dimInfo.name} (ç´¢å¼•: ${dimInfo.index}), é¢˜ç›®æ•°: ${dimData.questions.length}`);
                    dimData.questions.forEach((question, qIndex) => {
                        questionsTemplate.tob.push({
                            dimension: dimInfo.name,
                            dimensionIndex: dimInfo.index,
                            questionIndex: qIndex,
                            question: question
                        });
                    });
                } else {
                    console.warn(`æœªæ‰¾åˆ°æ˜ å°„çš„ç»“æ„: ${dimData.dimension}`);
                }
            });
            
            console.log('To Bé¢˜ç›®åˆå§‹åŒ–å®Œæˆï¼Œå…±', questionsTemplate.tob.length, 'é“é¢˜');
        }
        
        // åˆå§‹åŒ–To Cé¢˜ç›®
        function initToCQuestions() {
            questionsTemplate.toc = [];
            
            console.log('åˆå§‹åŒ–To Cé¢˜ç›®ï¼Œå…±', tocQuestionsData.length, 'ä¸ªç»“æ„');
            
            // æŒ‰ç»“æ„åˆ†ç»„é¢˜ç›®ï¼Œå› ä¸ºæœ‰äº›ç»“æ„å¯èƒ½æœ‰å¤šä¸ªæ¥æºï¼ˆå¦‚ä»·å€¼ç»“æ„+æ•°å­—åŒ–è½¬å‹ï¼‰
            const dimensionQuestions = {};
            dimensions.forEach((dim, index) => {
                dimensionQuestions[dim] = [];
            });
            
            tocQuestionsData.forEach(dimData => {
                const dimInfo = dimensionNameMap[dimData.dimension];
                if (dimInfo) {
                    console.log(`å¤„ç†ç»“æ„: ${dimData.dimension} -> ${dimInfo.name} (ç´¢å¼•: ${dimInfo.index}), é¢˜ç›®æ•°: ${dimData.questions.length}`);
                    // å°†é¢˜ç›®æ·»åŠ åˆ°å¯¹åº”ç»“æ„
                    dimData.questions.forEach((question, qIndex) => {
                        dimensionQuestions[dimInfo.name].push({
                            dimension: dimInfo.name,
                            dimensionIndex: dimInfo.index,
                            questionIndex: qIndex,
                            question: question
                        });
                    });
                } else {
                    console.warn(`æœªæ‰¾åˆ°æ˜ å°„çš„ç»“æ„: ${dimData.dimension}`);
                }
            });
            
            // æŒ‰ç»“æ„é¡ºåºæ•´ç†é¢˜ç›®ï¼Œæ¯ä¸ªç»“æ„æœ€å¤š3é“é¢˜
            dimensions.forEach((dim, dimIndex) => {
                const questions = dimensionQuestions[dim] || [];
                console.log(`ç»“æ„ ${dim} (ç´¢å¼•${dimIndex}): ${questions.length} é“é¢˜`);
                // å¦‚æœæŸä¸ªç»“æ„é¢˜ç›®ä¸è¶³3é“ï¼Œä¿æŒåŸæ ·ï¼ˆå¦‚ç®¡ç†ç»“æ„åªæœ‰2é“é¢˜ï¼‰
                questions.forEach((q, qIndex) => {
                    questionsTemplate.toc.push({
                        ...q,
                        questionIndex: qIndex
                    });
                });
            });
            
            console.log('To Cé¢˜ç›®åˆå§‹åŒ–å®Œæˆï¼Œå…±', questionsTemplate.toc.length, 'é“é¢˜');
        }
        
        // åˆå§‹åŒ–To Bå’ŒTo Cé¢˜ç›®
        initToBQuestions();
        initToCQuestions();

        // To Cå’ŒTo Bé¢˜ç›®éƒ½å·²å†…ç½®ï¼Œä¸éœ€è¦ä»JSONåŠ è½½
        // æ³¨æ„ï¼šæœ¬åœ°æ–‡ä»¶ï¼ˆfile://åè®®ï¼‰æ— æ³•ä½¿ç”¨fetchï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨å†…ç½®æ•°æ®
        function loadQuestionsFromJSON() {
            // é¢˜ç›®æ•°æ®å·²å†…ç½®åœ¨ä»£ç ä¸­ï¼Œä¸éœ€è¦ä»å¤–éƒ¨æ–‡ä»¶åŠ è½½
            console.log('To Cå’ŒTo Bé¢˜ç›®å·²ä½¿ç”¨å†…ç½®æ•°æ®');
            return true;
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–ï¼ˆä»…ç”¨äºæ—¥å¿—è®°å½•ï¼‰
        loadQuestionsFromJSON();

        // åº”ç”¨çŠ¶æ€
        let currentBusinessType = null;
        let currentQuestions = [];
        let currentDimensionIndex = 0; // å½“å‰ç»“æ„ç´¢å¼•ï¼ˆ0-7ï¼Œå…±8ä¸ªç»“æ„ï¼‰
        let answers = [];
        let radarChart = null;
        
        // æŒ‰ç»“æ„ç»„ç»‡é¢˜ç›®
        function organizeQuestionsByDimension(questions) {
            const organized = {};
            dimensions.forEach((dim, index) => {
                organized[index] = questions.filter(q => q.dimensionIndex === index);
            });
            return organized;
        }

        // ç­‰å¾…DOMåŠ è½½å®Œæˆååˆå§‹åŒ–
        function initApp() {
            console.log('åˆå§‹åŒ–åº”ç”¨...');
            
            // DOM å…ƒç´ 
            const screens = document.querySelectorAll('.screen');
            const selectionScreen = document.getElementById('selectionScreen');
            const quizScreen = document.getElementById('quizScreen');
            const resultScreen = document.getElementById('resultScreen');
            const contactScreen = document.getElementById('contactScreen');
            const startIntroBtn = document.getElementById('startIntroBtn');
            const startBtn = document.getElementById('startBtn');
            const businessTypeCards = document.querySelectorAll('.business-type-card');
            
            // é¦–é¡µ"å¼€å§‹æµ‹è¯„"æŒ‰é’®
            if (startIntroBtn) {
                startIntroBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    showScreen('businessTypeScreen');
                });
            }
            const questionContainer = document.getElementById('questionContainer');
            const progressFill = document.getElementById('progressFill');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const getReportBtn = document.getElementById('getReportBtn');
            const contactForm = document.getElementById('contactForm');

            console.log('DOMå…ƒç´ æ£€æŸ¥:', {
                startBtn: !!startBtn,
                businessTypeCards: businessTypeCards.length,
                questionContainer: !!questionContainer
            });

            // æ£€æŸ¥å…³é”®å…ƒç´ æ˜¯å¦å­˜åœ¨
            if (!startBtn) {
                console.error('startBtnå…ƒç´ æœªæ‰¾åˆ°');
                return;
            }
            
            if (!businessTypeCards || businessTypeCards.length === 0) {
                console.error('businessTypeCardså…ƒç´ æœªæ‰¾åˆ°');
                return;
            }

            console.log('æ‰¾åˆ°', businessTypeCards.length, 'ä¸ªä¸šåŠ¡ç±»å‹å¡ç‰‡');

            // é€‰æ‹©ä¸šåŠ¡ç±»å‹
            businessTypeCards.forEach((card, index) => {
                console.log(`ç»‘å®šå¡ç‰‡${index}çš„ç‚¹å‡»äº‹ä»¶ï¼Œç±»å‹:`, card.dataset.type);
                
                // ç¡®ä¿å¡ç‰‡å¯ç‚¹å‡»
                card.style.cursor = 'pointer';
                card.style.pointerEvents = 'auto';
                
                card.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('å¡ç‰‡è¢«ç‚¹å‡»ï¼Œç±»å‹:', card.dataset.type);
                    
                    businessTypeCards.forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    currentBusinessType = card.dataset.type;
                    // è®¾ç½®å…¨å±€å˜é‡ï¼Œç”¨äºä¿å­˜æ•°æ®æ—¶ä½¿ç”¨
                    window.selectedBusinessType = card.dataset.type === 'toc' ? 'Cç«¯ä¸šåŠ¡' : 'Bç«¯ä¸šåŠ¡';
                    startBtn.disabled = false;
                    
                    console.log('å½“å‰é€‰æ‹©çš„ä¸šåŠ¡ç±»å‹:', currentBusinessType);
                    console.log('è®¾ç½®çš„ä¸šåŠ¡ç±»å‹åç§°:', window.selectedBusinessType);
                });
            });

            // å¼€å§‹æµ‹è¯•
            startBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                console.log('å¼€å§‹æµ‹è¯•æŒ‰é’®è¢«ç‚¹å‡»ï¼Œå½“å‰ä¸šåŠ¡ç±»å‹:', currentBusinessType);
                
                if (!currentBusinessType) {
                    alert('è¯·å…ˆé€‰æ‹©ä¸šåŠ¡ç±»å‹');
                    return;
                }
                currentQuestions = questionsTemplate[currentBusinessType];
                if (!currentQuestions || currentQuestions.length === 0) {
                    alert('é¢˜ç›®æ•°æ®æœªåŠ è½½ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                    console.error('é¢˜ç›®æ•°æ®ä¸ºç©º:', currentBusinessType, questionsTemplate);
                    return;
                }
                console.log('å¼€å§‹æµ‹è¯•ï¼Œé¢˜ç›®æ•°é‡:', currentQuestions.length);
                answers = new Array(currentQuestions.length).fill(3); // é»˜è®¤å€¼ä»5æ”¹ä¸º3
                currentDimensionIndex = 0;
                window.organizedQuestions = organizeQuestionsByDimension(currentQuestions);
                showQuestion();
                showScreen('quizScreen');
            });
            
            console.log('äº‹ä»¶ç›‘å¬å™¨ç»‘å®šå®Œæˆ');

            // ä¸Šä¸€ä¸ªç»“æ„
            if (prevBtn) {
                prevBtn.addEventListener('click', () => {
                    if (currentDimensionIndex > 0) {
                        currentDimensionIndex--;
                        showQuestion();
                    }
                });
            }

            // ä¸‹ä¸€ä¸ªç»“æ„/æŸ¥çœ‹ç»“æœ
            if (nextBtn) {
                nextBtn.addEventListener('click', () => {
                    // ç¡®ä¿å½“å‰ç»“æ„çš„æ‰€æœ‰é¢˜ç›®éƒ½æœ‰ç­”æ¡ˆï¼ˆå¦‚æœæ²¡æœ‰ï¼Œè®¾ä¸ºé»˜è®¤å€¼3ï¼‰
                    const dimensionQuestions = window.organizedQuestions[currentDimensionIndex] || [];
                    dimensionQuestions.forEach(question => {
                        const globalIndex = currentQuestions.indexOf(question);
                        if (answers[globalIndex] === null || answers[globalIndex] === undefined) {
                            answers[globalIndex] = 3; // é»˜è®¤å€¼ä»5æ”¹ä¸º3
                        }
                    });

                    if (currentDimensionIndex < dimensions.length - 1) {
                        currentDimensionIndex++;
                        showQuestion();
                    } else {
                        calculateResults();
                    }
                });
            }

            // è·å–æŠ¥å‘Š
            if (getReportBtn) {
                getReportBtn.addEventListener('click', () => {
                    showScreen('contactScreen');
                });
            }

            // æäº¤ç•™èµ„è¡¨å•
            if (contactForm) {
                contactForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const userName = document.getElementById('userName').value;
                    const companyName = document.getElementById('companyName').value;
                    const userPhone = document.getElementById('userPhone').value;

                    // å‡†å¤‡ç”¨æˆ·æ•°æ®
                    const userData = {
                        user_name: userName,
                        company_name: companyName,
                        user_phone: userPhone,
                        business_type: window.selectedBusinessType || 'æœªçŸ¥',
                        submit_time: new Date().toLocaleString('zh-CN'),
                        results: window.testResults || {}
                    };

                    // æäº¤æ•°æ®åˆ° Supabase æˆ– localStorageï¼ˆå¤‡ç”¨ï¼‰
                    async function submitData() {
                        if (supabaseClient) {
                            // ä½¿ç”¨ Supabase æäº¤æ•°æ®
                            try {
                                const { data, error } = await supabaseClient
                                    .from('assessments')
                                    .insert([userData])
                                    .select();
                                
                                if (error) {
                                    throw error;
                                }
                                
                                console.log('æ•°æ®å·²æˆåŠŸæäº¤åˆ° Supabase:', data);
                                // æ˜¾ç¤ºæˆåŠŸç•Œé¢
                                showScreen('successScreen');
                            } catch (error) {
                                console.error('æäº¤æ•°æ®åˆ° Supabase å¤±è´¥:', error);
                                // å¦‚æœ Supabase å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨ localStorage ä½œä¸ºå¤‡ç”¨
                                fallbackToLocalStorage(userData);
                            }
                        } else {
                            // å¦‚æœæ²¡æœ‰é…ç½® Supabaseï¼Œä½¿ç”¨ localStorage
                            fallbackToLocalStorage(userData);
                        }
                    }
                    
                    // localStorage å¤‡ç”¨æ–¹æ¡ˆ
                    function fallbackToLocalStorage(data) {
                        try {
                            // æ·»åŠ  id å­—æ®µç”¨äºå…¼å®¹
                            const localData = {
                                id: Date.now(),
                                userName: data.user_name,
                                companyName: data.company_name,
                                userPhone: data.user_phone,
                                businessType: data.business_type,
                                submitTime: data.submit_time,
                                results: data.results
                            };
                            
                            let allUserData = [];
                            const storedData = localStorage.getItem('assessmentUserData');
                            if (storedData) {
                                allUserData = JSON.parse(storedData);
                            }
                            allUserData.push(localData);
                            localStorage.setItem('assessmentUserData', JSON.stringify(allUserData));
                            
                            console.log('æ•°æ®å·²ä¿å­˜åˆ° localStorageï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰');
                            showScreen('successScreen');
                        } catch (e) {
                            console.error('ä¿å­˜æ•°æ®å¤±è´¥:', e);
                            alert('æ•°æ®ä¿å­˜å¤±è´¥ï¼š' + e.message + '\nè¯·æ£€æŸ¥æµè§ˆå™¨è®¾ç½®æˆ–ç½‘ç»œè¿æ¥ã€‚');
                            // å³ä½¿ä¿å­˜å¤±è´¥ï¼Œä¹Ÿæ˜¾ç¤ºæˆåŠŸé¡µé¢ï¼ˆç”¨æˆ·ä½“éªŒä¼˜å…ˆï¼‰
                            showScreen('successScreen');
                        }
                    }
                    
                    // æ‰§è¡Œæäº¤
                    submitData();
                });
            }

            // ä¿å­˜DOMå…ƒç´ å¼•ç”¨åˆ°å…¨å±€ï¼Œä¾›å…¶ä»–å‡½æ•°ä½¿ç”¨
            window.questionContainer = questionContainer;
            window.progressFill = progressFill;
            window.prevBtn = prevBtn;
            window.nextBtn = nextBtn;
        }

        // DOMåŠ è½½å®Œæˆååˆå§‹åŒ–
        function startApp() {
            console.log('å¼€å§‹åˆå§‹åŒ–åº”ç”¨ï¼ŒDOMçŠ¶æ€:', document.readyState);
            if (document.readyState === 'loading') {
                console.log('ç­‰å¾…DOMåŠ è½½...');
                document.addEventListener('DOMContentLoaded', function() {
                    console.log('DOMåŠ è½½å®Œæˆï¼Œæ‰§è¡ŒinitApp');
                    initApp();
                });
            } else {
                console.log('DOMå·²å°±ç»ªï¼Œç«‹å³æ‰§è¡ŒinitApp');
                // DOMå·²ç»åŠ è½½å®Œæˆï¼Œå»¶è¿Ÿä¸€ç‚¹ç¡®ä¿æ‰€æœ‰å…ƒç´ éƒ½å·²æ¸²æŸ“
                setTimeout(function() {
                    initApp();
                }, 100);
            }
        }
        
        // å¯åŠ¨åº”ç”¨
        startApp();

        // æ˜¾ç¤ºæŒ‡å®šå±å¹•
        function showScreen(screenId) {
            const allScreens = document.querySelectorAll('.screen');
            allScreens.forEach(s => {
                s.classList.remove('active');
                s.style.display = 'none';
            });
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
                targetScreen.style.display = 'block';
            }
        }

        // æ˜¾ç¤ºé¢˜ç›®ï¼ˆæ˜¾ç¤ºå½“å‰ç»“æ„ä¸‹çš„æ‰€æœ‰3é“é¢˜ï¼‰
        function showQuestion() {
            const dimensionQuestions = window.organizedQuestions[currentDimensionIndex] || [];
            const currentDimension = dimensions[currentDimensionIndex];
            const totalDimensions = dimensions.length;
            const progress = ((currentDimensionIndex + 1) / totalDimensions) * 100;
            
            if (window.progressFill) {
                window.progressFill.style.width = progress + '%';
            }
            
            if (window.questionContainer) {
                let questionsHTML = `
                    <div class="question-number">ç¬¬ ${currentDimensionIndex + 1} ä¸ªç»“æ„ / å…± ${totalDimensions} ä¸ªç»“æ„</div>
                    <div class="dimension-label">${currentDimension}ç»“æ„</div>
                `;
                
                dimensionQuestions.forEach((question, qIndex) => {
                    const globalIndex = currentQuestions.indexOf(question);
                    const currentAnswer = answers[globalIndex] || 3; // é»˜è®¤å€¼ä»5æ”¹ä¸º3
                    
                    questionsHTML += `
                        <div class="question-item" style="margin-bottom: 40px;">
                            <div class="question-text" style="margin-bottom: 20px;">${qIndex + 1}. ${question.question}</div>
                            <div class="slider-container">
                                <div class="slider-value" id="sliderValue${qIndex}">${currentAnswer}</div>
                                <div class="slider-wrapper">
                                    <input type="range" min="1" max="5" value="${currentAnswer}" class="slider" id="answerSlider${qIndex}" data-global-index="${globalIndex}">
                                </div>
                                <div class="slider-labels">
                                    <span>1åˆ†<br>å®Œå…¨ä¸ç¬¦åˆ</span>
                                    <span>3åˆ†<br>éƒ¨åˆ†ç¬¦åˆ</span>
                                    <span>5åˆ†<br>å®Œå…¨ç¬¦åˆ</span>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                window.questionContainer.innerHTML = questionsHTML;

                // ä¸ºæ¯ä¸ªæ»‘åŠ¨æ¡ç»‘å®šäº‹ä»¶
                dimensionQuestions.forEach((question, qIndex) => {
                    const globalIndex = currentQuestions.indexOf(question);
                    const slider = document.getElementById(`answerSlider${qIndex}`);
                    const sliderValue = document.getElementById(`sliderValue${qIndex}`);
                    
                    if (slider && sliderValue) {
                        slider.addEventListener('input', (e) => {
                            const value = parseInt(e.target.value);
                            sliderValue.textContent = value;
                            answers[globalIndex] = value;
                        });
                    }
                });
            }

            updateNavigationButtons();
        }

        // æ›´æ–°å¯¼èˆªæŒ‰é’®
        function updateNavigationButtons() {
            if (window.prevBtn) {
                window.prevBtn.style.display = currentDimensionIndex > 0 ? 'block' : 'none';
            }
            
            if (window.nextBtn) {
                if (currentDimensionIndex === dimensions.length - 1) {
                    window.nextBtn.textContent = 'æŸ¥çœ‹ç»“æœ';
                } else {
                    window.nextBtn.textContent = 'ä¸‹ä¸€ä¸ªç»“æ„';
                }
            }
        }

        // è®¡ç®—ç»“æœ
        function calculateResults() {
            // è®¡ç®—å„ç»“æ„å¾—åˆ†
            const dimensionScores = {};
            dimensions.forEach((dim, dimIndex) => {
                const dimQuestions = window.organizedQuestions[dimIndex] || [];
                // ä½¿ç”¨é¢˜ç›®åœ¨currentQuestionsä¸­çš„å®é™…ç´¢å¼•
                const dimAnswers = dimQuestions.map((q) => {
                    const globalIndex = currentQuestions.indexOf(q);
                    return answers[globalIndex] || 3; // é»˜è®¤å€¼ä»5æ”¹ä¸º3
                });
                if (dimAnswers.length > 0) {
                    dimensionScores[dim] = dimAnswers.reduce((a, b) => a + b, 0) / dimAnswers.length;
                } else {
                    dimensionScores[dim] = 3; // å¦‚æœæ²¡æœ‰é¢˜ç›®ï¼Œé»˜è®¤3åˆ†
                }
            });

            // è®¡ç®—ä¸šç»©å‡åˆ†(P_avg)ã€ç»„ç»‡å‡åˆ†(O_avg)ã€å£å’å‡åˆ†(B_avg)ã€æ•°å­—åŒ–å‡åˆ†(D_avg)
            // ä¸šç»©ç›¸å…³ï¼šéœ€æ±‚ã€ä»·å€¼ã€æ¸ é“ï¼ˆå¸‚åœºè¡¨ç°ç›¸å…³ï¼‰
            // ç»„ç»‡ç›¸å…³ï¼šç®¡ç†ã€èƒ½åŠ›ã€æ¿€åŠ±ï¼ˆå†…éƒ¨ç»„ç»‡èƒ½åŠ›ï¼‰
            // å£å’ï¼šå£å’ç»“æ„
            // æ•°å­—åŒ–ï¼šä»ä»·å€¼ç»“æ„ä¸­æå–ï¼ˆé€šå¸¸ä»·å€¼ç»“æ„åŒ…å«æ•°å­—åŒ–ç›¸å…³å†…å®¹ï¼‰
            const P_avg = (dimensionScores['éœ€æ±‚'] + dimensionScores['ä»·å€¼'] + dimensionScores['æ¸ é“']) / 3;
            const O_avg = (dimensionScores['ç®¡ç†'] + dimensionScores['èƒ½åŠ›'] + dimensionScores['æ¿€åŠ±']) / 3;
            const B_avg = dimensionScores['å£å’'];
            // æ•°å­—åŒ–å‡åˆ†ï¼šä½¿ç”¨æ•°å­—åŒ–è½¬å‹ç»“æ„çš„å¾—åˆ†
            const D_avg = dimensionScores['æ•°å­—åŒ–è½¬å‹'];

            // è®¡ç®—CBIæŒ‡æ•°ï¼ˆé€‚é…1-5åˆ†èŒƒå›´ï¼‰
            const CBI = ((P_avg + O_avg) / 2) * (B_avg / 5) * (1 + D_avg / 25);

            // åˆ¤æ–­ä¼ä¸šç±»å‹ï¼ˆé€‚é…1-5åˆ†èŒƒå›´ï¼Œé˜ˆå€¼ä¸º3.5ï¼‰
            let enterpriseType = '';
            let typeDesc = '';
            if (P_avg >= 3.5 && O_avg >= 3.5) {
                enterpriseType = 'è¡Œä¸šé¢†è·‘å‹';
                typeDesc = 'æ‚¨çš„ä¼ä¸šåœ¨ä¸šç»©å’Œç»„ç»‡èƒ½åŠ›æ–¹é¢éƒ½è¡¨ç°ä¼˜ç§€ï¼Œå¤„äºè¡Œä¸šé¢†å…ˆåœ°ä½ã€‚å»ºè®®ç»§ç»­ä¿æŒä¼˜åŠ¿ï¼ŒæŒç»­åˆ›æ–°ï¼Œæ‰©å¤§å¸‚åœºä»½é¢ã€‚';
            } else if (P_avg >= 3.5 && O_avg < 3.5) {
                enterpriseType = 'æœºä¼šé©±åŠ¨å‹';
                typeDesc = 'æ‚¨çš„ä¼ä¸šä¸šç»©è¡¨ç°è‰¯å¥½ï¼Œä½†ç»„ç»‡èƒ½åŠ›æœ‰å¾…æå‡ã€‚å»ºè®®åŠ å¼ºå†…éƒ¨ç®¡ç†ï¼Œæå‡ç»„ç»‡æ•ˆèƒ½ï¼Œé¿å…ä¸šç»©è™šé«˜ä½†ååŠ²ä¸è¶³çš„æƒ…å†µã€‚';
            } else if (P_avg < 3.5 && O_avg >= 3.5) {
                enterpriseType = 'èƒ½åŠ›å‚¨å¤‡å‹';
                typeDesc = 'æ‚¨çš„ä¼ä¸šç»„ç»‡èƒ½åŠ›è¾ƒå¼ºï¼Œä½†ä¸šç»©è¡¨ç°ä¸ä½³ã€‚å»ºè®®ä¼˜åŒ–ä¸šåŠ¡æ¨¡å¼ï¼Œæå‡å¸‚åœºç«äº‰åŠ›ï¼Œå°†ç»„ç»‡ä¼˜åŠ¿è½¬åŒ–ä¸ºä¸šç»©æˆæœã€‚';
            } else {
                enterpriseType = 'ç”Ÿå­˜å±æœºå‹';
                typeDesc = 'æ‚¨çš„ä¼ä¸šåœ¨ä¸šç»©å’Œç»„ç»‡èƒ½åŠ›æ–¹é¢éƒ½éœ€è¦åŠ å¼ºã€‚å»ºè®®ç³»ç»Ÿæ€§åœ°åˆ†æé—®é¢˜ï¼Œåˆ¶å®šå…¨é¢çš„æå‡ç­–ç•¥ï¼Œé€æ­¥æ”¹å–„ä¼ä¸šç«äº‰åŠ›ã€‚';
            }

            // ä¿å­˜æ¯é“é¢˜çš„åŸå§‹ç­”æ¡ˆï¼ˆç”¨äºè¯¦ç»†è¯Šæ–­ï¼‰
            const questionAnswers = {};
            dimensions.forEach((dim, dimIndex) => {
                const dimQuestions = window.organizedQuestions[dimIndex] || [];
                questionAnswers[dim] = dimQuestions.map((q) => {
                    const globalIndex = currentQuestions.indexOf(q);
                    return answers[globalIndex] || 3; // é»˜è®¤å€¼ä»5æ”¹ä¸º3
                });
            });

            // æ˜¾ç¤ºç»“æœ
            showResults({
                dimensionScores,
                P_avg,
                O_avg,
                B_avg,
                D_avg,
                CBI,
                enterpriseType,
                typeDesc,
                questionAnswers // ä¿å­˜æ¯é“é¢˜çš„ç­”æ¡ˆ
            });
        }

        // æ˜¾ç¤ºç»“æœ
        function showResults(results) {
            // æ˜¾ç¤ºè¯Šæ–­ç»“æœ
            document.getElementById('diagnosisResult').innerHTML = `
                <div class="diagnosis-type">${results.enterpriseType}</div>
                <div class="diagnosis-desc">${results.typeDesc}</div>
            `;

            // æ˜¾ç¤ºCBIåˆ†æ•°å’Œè¯Šæ–­
            document.getElementById('cbiScore').textContent = results.CBI.toFixed(2);
            displayCBIDiagnosis(results.CBI);

            // ç»˜åˆ¶å››è±¡é™å›¾
            drawQuadrantChart(results.P_avg, results.O_avg, results.enterpriseType);
            
            // æ˜¾ç¤ºå››å®«æ ¼å®šä½æè¿°
            displayQuadrantDescription(results.P_avg, results.O_avg, results.enterpriseType);

            // ç»˜åˆ¶é›·è¾¾å›¾ï¼ˆå¼‚æ­¥ç­‰å¾… Chart.js åŠ è½½ï¼‰
            drawRadarChart(results.dimensionScores).catch(error => {
                console.error('ç»˜åˆ¶é›·è¾¾å›¾å¤±è´¥:', error);
            });

            // æ˜¾ç¤ºç»“æ„å¾—åˆ†
            displayDimensionScores(results.dimensionScores);

            // ä¿å­˜ç»“æœåˆ°å…¨å±€å˜é‡
            window.testResults = results;

            showScreen('resultScreen');
        }

        // ç»˜åˆ¶å››è±¡é™å›¾
        function drawQuadrantChart(P_avg, O_avg, type) {
            const canvas = document.getElementById('quadrantChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const width = 400;
            const height = 400;
            const padding = 50;
            const chartWidth = width - padding * 2;
            const chartHeight = height - padding * 2;
            
            // æ¸…ç©ºç”»å¸ƒ
            ctx.clearRect(0, 0, width, height);
            
            // ç»˜åˆ¶èƒŒæ™¯
            ctx.fillStyle = '#fafafa';
            ctx.fillRect(0, 0, width, height);
            
            // ç»˜åˆ¶åæ ‡è½´ï¼ˆä»¥å·¦ä¸‹è§’ä¸ºåŸç‚¹ï¼‰
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            
            // Xè½´ï¼ˆç»„ç»‡èƒ½åŠ›ï¼Œä»å·¦åˆ°å³ï¼‰
            ctx.beginPath();
            ctx.moveTo(padding, height - padding);
            ctx.lineTo(width - padding, height - padding);
            ctx.stroke();
            
            // Yè½´ï¼ˆä¸šç»©èƒ½åŠ›ï¼Œä»ä¸‹åˆ°ä¸Šï¼‰
            ctx.beginPath();
            ctx.moveTo(padding, height - padding);
            ctx.lineTo(padding, padding);
            ctx.stroke();
            
            // ç»˜åˆ¶ç½‘æ ¼çº¿å’Œåˆ»åº¦ï¼ˆ0-5ï¼Œé—´éš”0.5ï¼‰
            ctx.strokeStyle = '#ddd';
            ctx.lineWidth = 1;
            ctx.font = '12px Arial';
            ctx.fillStyle = '#666';
            
            // Xè½´åˆ»åº¦ï¼ˆç»„ç»‡èƒ½åŠ›ï¼Œ0-5ï¼Œé—´éš”0.5ï¼‰
            for (let i = 0; i <= 10; i++) {
                const value = i * 0.5;
                const x = padding + (value / 5) * chartWidth;
                
                // ç»˜åˆ¶åˆ»åº¦çº¿
                ctx.beginPath();
                ctx.moveTo(x, height - padding);
                ctx.lineTo(x, height - padding + 5);
                ctx.stroke();
                
                // ç»˜åˆ¶åˆ»åº¦å€¼
                if (i % 2 === 0) { // åªæ˜¾ç¤ºæ•´æ•°åˆ»åº¦
                    ctx.fillText(value.toString(), x - 5, height - padding + 20);
                }
            }
            
            // Yè½´åˆ»åº¦ï¼ˆä¸šç»©èƒ½åŠ›ï¼Œ0-5ï¼Œé—´éš”0.5ï¼Œä»ä¸‹å¾€ä¸Šï¼‰
            for (let i = 0; i <= 10; i++) {
                const value = i * 0.5;
                const y = height - padding - (value / 5) * chartHeight;
                
                // ç»˜åˆ¶åˆ»åº¦çº¿
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(padding - 5, y);
                ctx.stroke();
                
                // ç»˜åˆ¶åˆ»åº¦å€¼
                if (i % 2 === 0) { // åªæ˜¾ç¤ºæ•´æ•°åˆ»åº¦
                    ctx.fillText(value.toString(), padding - 25, y + 4);
                }
            }
            
            // ç»˜åˆ¶ä¸­å¿ƒçº¿ï¼ˆ3.5åˆ†ä½ç½®ï¼Œç”¨äºåˆ’åˆ†è±¡é™ï¼‰
            ctx.strokeStyle = '#999';
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]);
            
            // å‚ç›´ä¸­å¿ƒçº¿ï¼ˆç»„ç»‡èƒ½åŠ›3.5åˆ†ï¼‰
            const centerX = padding + (3.5 / 5) * chartWidth;
            ctx.beginPath();
            ctx.moveTo(centerX, padding);
            ctx.lineTo(centerX, height - padding);
            ctx.stroke();
            
            // æ°´å¹³ä¸­å¿ƒçº¿ï¼ˆä¸šç»©èƒ½åŠ›3.5åˆ†ï¼‰
            const centerY = height - padding - (3.5 / 5) * chartHeight;
            ctx.beginPath();
            ctx.moveTo(padding, centerY);
            ctx.lineTo(width - padding, centerY);
            ctx.stroke();
            
            ctx.setLineDash([]);
            
            // ç»˜åˆ¶è±¡é™æ ‡ç­¾
            ctx.font = 'bold 16px Arial';
            
            // å³ä¸Šè±¡é™ï¼šè¡Œä¸šé¢†è·‘å‹ï¼ˆé«˜ä¸šç»©ã€é«˜ç»„ç»‡ï¼‰
            ctx.fillStyle = '#4caf50';
            ctx.fillText('è¡Œä¸šé¢†è·‘å‹', width - padding - 100, padding + 20);
            
            // å·¦ä¸Šè±¡é™ï¼šæœºä¼šé©±åŠ¨å‹ï¼ˆé«˜ä¸šç»©ã€ä½ç»„ç»‡ï¼‰
            ctx.fillStyle = '#ff9800';
            ctx.fillText('æœºä¼šé©±åŠ¨å‹', padding + 10, padding + 20);
            
            // å·¦ä¸‹è±¡é™ï¼šèƒ½åŠ›å‚¨å¤‡å‹ï¼ˆä½ä¸šç»©ã€é«˜ç»„ç»‡ï¼‰
            ctx.fillStyle = '#2196f3';
            ctx.fillText('èƒ½åŠ›å‚¨å¤‡å‹', padding + 10, height - padding - 10);
            
            // å³ä¸‹è±¡é™ï¼šç”Ÿå­˜å±æœºå‹ï¼ˆä½ä¸šç»©ã€ä½ç»„ç»‡ï¼‰
            ctx.fillStyle = '#f44336';
            ctx.fillText('ç”Ÿå­˜å±æœºå‹', width - padding - 100, height - padding - 10);
            
            // ç»˜åˆ¶åæ ‡è½´æ ‡ç­¾
            ctx.font = 'bold 13px Arial';
            ctx.fillStyle = '#555';
            
            // Xè½´æ ‡ç­¾ï¼šç»„ç»‡èƒ½åŠ›
            ctx.fillText('ä½', width - padding - 10, height - padding + 20);
            ctx.fillText('é«˜', padding - 10, height - padding + 20);
            
            // Yè½´æ ‡ç­¾ï¼šä¸šç»©èƒ½åŠ›
            ctx.fillText('é«˜', padding - 25, padding + 5);
            ctx.fillText('ä½', padding - 25, height - padding + 5);
            
            // ç»˜åˆ¶è½ç‚¹
            const pointX = padding + (O_avg / 5) * chartWidth;
            const pointY = height - padding - (P_avg / 5) * chartHeight;
            
            // ç»˜åˆ¶åœ†ç‚¹
            ctx.fillStyle = '#667eea';
            ctx.beginPath();
            ctx.arc(pointX, pointY, 8, 0, Math.PI * 2);
            ctx.fill();
            
            // ç»˜åˆ¶åœ†ç‚¹è¾¹æ¡†
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 3;
            ctx.stroke();
            
            // ç»˜åˆ¶æ ‡ç­¾ï¼ˆæ‹¬å·ä¸­æ ‡ç¤ºå¾—åˆ†ï¼‰
            ctx.font = 'bold 14px Arial';
            ctx.fillStyle = '#333';
            const labelText = `(${P_avg.toFixed(1)}, ${O_avg.toFixed(1)})`;
            const labelWidth = ctx.measureText(labelText).width;
            
            // åœ¨åœ†ç‚¹å³ä¾§æ˜¾ç¤ºæ ‡ç­¾ï¼Œå¦‚æœå¤ªé å³åˆ™æ˜¾ç¤ºåœ¨å·¦ä¾§
            let labelX = pointX + 15;
            if (labelX + labelWidth > width - padding) {
                labelX = pointX - labelWidth - 15;
            }
            
            // ç»˜åˆ¶æ ‡ç­¾èƒŒæ™¯
            ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
            ctx.fillRect(labelX - 5, pointY - 12, labelWidth + 10, 20);
            
            // ç»˜åˆ¶æ ‡ç­¾æ–‡å­—
            ctx.fillStyle = '#333';
            ctx.fillText(labelText, labelX, pointY + 4);
        }
        
        // æ˜¾ç¤ºå››å®«æ ¼å®šä½æè¿°
        function displayQuadrantDescription(P_avg, O_avg, type) {
            const container = document.getElementById('quadrantDescription');
            if (!container) return;
            
            let description = '';
            if (type === 'è¡Œä¸šé¢†è·‘å‹') {
                description = `
                    <h4 style="color: #4caf50; margin-bottom: 15px;">ğŸ“ æ‚¨å½“å‰å¤„äºï¼š<strong>è¡Œä¸šé¢†è·‘å‹</strong>è±¡é™</h4>
                    <p style="font-size: 16px; line-height: 1.8; margin-bottom: 15px;">
                        <strong>ä¸šç»©èƒ½åŠ›å¾—åˆ†ï¼š</strong>${P_avg.toFixed(1)}åˆ†<br>
                        <strong>ç»„ç»‡èƒ½åŠ›å¾—åˆ†ï¼š</strong>${O_avg.toFixed(1)}åˆ†
                    </p>
                    <p style="font-size: 15px; line-height: 1.8; color: #666;">
                        æ‚¨çš„ä¼ä¸šåœ¨ä¸šç»©å’Œç»„ç»‡èƒ½åŠ›æ–¹é¢éƒ½è¡¨ç°ä¼˜ç§€ï¼Œå¤„äºè¡Œä¸šé¢†å…ˆåœ°ä½ã€‚å»ºè®®ç»§ç»­ä¿æŒä¼˜åŠ¿ï¼ŒæŒç»­åˆ›æ–°ï¼Œæ‰©å¤§å¸‚åœºä»½é¢ã€‚
                    </p>
                `;
            } else if (type === 'æœºä¼šé©±åŠ¨å‹') {
                description = `
                    <h4 style="color: #ff9800; margin-bottom: 15px;">ğŸ“ æ‚¨å½“å‰å¤„äºï¼š<strong>æœºä¼šé©±åŠ¨å‹</strong>è±¡é™</h4>
                    <p style="font-size: 16px; line-height: 1.8; margin-bottom: 15px;">
                        <strong>ä¸šç»©èƒ½åŠ›å¾—åˆ†ï¼š</strong>${P_avg.toFixed(1)}åˆ†<br>
                        <strong>ç»„ç»‡èƒ½åŠ›å¾—åˆ†ï¼š</strong>${O_avg.toFixed(1)}åˆ†
                    </p>
                    <p style="font-size: 15px; line-height: 1.8; color: #666;">
                        æ‚¨çš„ä¼ä¸šä¸šç»©è¡¨ç°è‰¯å¥½ï¼Œä½†ç»„ç»‡èƒ½åŠ›æœ‰å¾…æå‡ã€‚å»ºè®®åŠ å¼ºå†…éƒ¨ç®¡ç†ï¼Œæå‡ç»„ç»‡æ•ˆèƒ½ï¼Œé¿å…ä¸šç»©è™šé«˜ä½†ååŠ²ä¸è¶³çš„æƒ…å†µã€‚
                    </p>
                `;
            } else if (type === 'èƒ½åŠ›å‚¨å¤‡å‹') {
                description = `
                    <h4 style="color: #2196f3; margin-bottom: 15px;">ğŸ“ æ‚¨å½“å‰å¤„äºï¼š<strong>èƒ½åŠ›å‚¨å¤‡å‹</strong>è±¡é™</h4>
                    <p style="font-size: 16px; line-height: 1.8; margin-bottom: 15px;">
                        <strong>ä¸šç»©èƒ½åŠ›å¾—åˆ†ï¼š</strong>${P_avg.toFixed(1)}åˆ†<br>
                        <strong>ç»„ç»‡èƒ½åŠ›å¾—åˆ†ï¼š</strong>${O_avg.toFixed(1)}åˆ†
                    </p>
                    <p style="font-size: 15px; line-height: 1.8; color: #666;">
                        æ‚¨çš„ä¼ä¸šç»„ç»‡èƒ½åŠ›è¾ƒå¼ºï¼Œä½†ä¸šç»©è¡¨ç°ä¸ä½³ã€‚å»ºè®®ä¼˜åŒ–ä¸šåŠ¡æ¨¡å¼ï¼Œæå‡å¸‚åœºç«äº‰åŠ›ï¼Œå°†ç»„ç»‡ä¼˜åŠ¿è½¬åŒ–ä¸ºä¸šç»©æˆæœã€‚
                    </p>
                `;
            } else {
                description = `
                    <h4 style="color: #f44336; margin-bottom: 15px;">ğŸ“ æ‚¨å½“å‰å¤„äºï¼š<strong>ç”Ÿå­˜å±æœºå‹</strong>è±¡é™</h4>
                    <p style="font-size: 16px; line-height: 1.8; margin-bottom: 15px;">
                        <strong>ä¸šç»©èƒ½åŠ›å¾—åˆ†ï¼š</strong>${P_avg.toFixed(1)}åˆ†<br>
                        <strong>ç»„ç»‡èƒ½åŠ›å¾—åˆ†ï¼š</strong>${O_avg.toFixed(1)}åˆ†
                    </p>
                    <p style="font-size: 15px; line-height: 1.8; color: #666;">
                        æ‚¨çš„ä¼ä¸šåœ¨ä¸šç»©å’Œç»„ç»‡èƒ½åŠ›æ–¹é¢éƒ½éœ€è¦åŠ å¼ºã€‚å»ºè®®ç³»ç»Ÿæ€§åœ°åˆ†æé—®é¢˜ï¼Œåˆ¶å®šå…¨é¢çš„æå‡ç­–ç•¥ï¼Œé€æ­¥æ”¹å–„ä¼ä¸šç«äº‰åŠ›ã€‚
                    </p>
                `;
            }
            
            container.innerHTML = description;
        }
        
        // æ˜¾ç¤ºCBIè¯Šæ–­åˆ†æ
        function displayCBIDiagnosis(CBI) {
            const container = document.getElementById('cbiDiagnosis');
            if (!container) return;
            
            let diagnosis = '';
            // é€‚é…æ–°çš„1-5åˆ†èŒƒå›´å’ŒCBIè®¡ç®—å…¬å¼
            if (CBI >= 4.0 && CBI <= 6.25) {
                diagnosis = `
                    <h4 style="color: #4caf50; margin-bottom: 15px;">ğŸ† å„æ–­çº§å£å’ (${CBI.toFixed(2)}åˆ†)</h4>
                    <p style="font-size: 15px; line-height: 1.8; color: #333;">
                        ä¼ä¸šå·²æ„å»ºèµ·æå…·éŸ§æ€§çš„é˜²å¾¡æ€§èµ„äº§ï¼Œå½¢æˆäº†éš¾ä»¥é€¾è¶Šçš„ç»“æ„æ€§æŠ¤åŸæ²³ã€‚è¿™ç§å„æ–­çº§å£å’ä¸ä»…æºäºç‹¬ç‰¹çš„ä»·å€¼å®šä½ï¼Œæ›´å¾—ç›Šäºç»„ç»‡èƒ½åŠ›ä¸ä¸šåŠ¡é€»è¾‘çš„æ·±åº¦è€¦åˆï¼Œä»¥åŠæ•°å­—åŒ–èµ„äº§çš„æŒç»­æ²‰æ·€ã€‚åœ¨è¯¥åˆ†å€¼åŒºé—´å†…ï¼Œä¼ä¸šå±•ç°å‡ºå“è¶Šçš„è®®ä»·èƒ½åŠ›ä¸æŠ—å‘¨æœŸéŸ§æ€§ã€‚å¯¹æ‰‹å³ä¾¿æŠ•å…¥å·¨é‡èµ„æœ¬ï¼Œä¹Ÿéš¾ä»¥åœ¨çŸ­å‘¨æœŸå†…é€šè¿‡ç®€å•çš„èµ„æºå †ç Œå®ç°èµ¶è¶…ã€‚å»ºè®®æœªæ¥èšç„¦äºæè‡´æ•ˆç‡çš„ç²¾è¿›ï¼Œåˆ©ç”¨æŠ€æœ¯æ æ†å®ç°ä»"é¢†è·‘"å‘"è¡Œä¸šæ ‡å‡†åˆ¶å®šè€…"çš„è·¨è¶Šã€‚
                    </p>
                `;
            } else if (CBI >= 2.5 && CBI < 4.0) {
                diagnosis = `
                    <h4 style="color: #ff9800; margin-bottom: 15px;">ğŸ›¡ï¸ å®‰å…¨çº§å£å’ (${CBI.toFixed(2)}åˆ†)</h4>
                    <p style="font-size: 15px; line-height: 1.8; color: #333;">
                        ä¼ä¸šå…·å¤‡æ˜ç¡®çš„æˆ˜ç•¥é”šç‚¹ï¼Œåœ¨ç»†åˆ†é¢†åŸŸå†…ç¡®ç«‹äº†ç¨³å¥çš„ç«äº‰èº«ä½ï¼Œå¹¶å±•ç°å‡ºè¾ƒå¼ºçš„è¿è¥æ‰§è¡ŒåŠ›ã€‚ç„¶è€Œï¼Œè¿™ç§å®‰å…¨è¾¹é™…å°šæœªè½¬åŒ–ä¸ºç»å¯¹çš„ç»“æ„æ€§ä¼˜åŠ¿ï¼Œç°æœ‰çš„å£å’ä»å…·ä¸€å®šçš„æ¸—é€å¯èƒ½æ€§ã€‚éšç€å¸‚åœºè¾¹ç•Œçš„æ¨¡ç³Šä¸ç«äº‰å¼ºåº¦çš„æå‡ï¼Œç»„ç»‡å†…éƒ¨æ½œåœ¨çš„çŸ­æ¿ï¼ˆå¦‚å†³ç­–é“¾æ¡å†—ä½™æˆ–æ¿€åŠ±æœºåˆ¶æ»åï¼‰å¯èƒ½æˆä¸ºè¢«å¯¹æ‰‹ç©¿é€çš„ç ´å£ã€‚æ­¤ç±»ä¼ä¸šåº”åœ¨ç¨³å›ºå­˜é‡èµ„äº§çš„åŒæ—¶ï¼ŒåŠ é€Ÿè¡¥é½ç»“æ„æ€§æ®‹ç¼ºï¼Œä»¥é˜²åœ¨æ¿€çƒˆçš„å¸‚åœºå˜å±€ä¸­ä¸§å¤±å…ˆæ‰‹æƒã€‚
                    </p>
                `;
            } else {
                diagnosis = `
                    <h4 style="color: #f44336; margin-bottom: 15px;">âš ï¸ è„†å¼±çº§å¢é•¿ (${CBI.toFixed(2)}åˆ†)</h4>
                    <p style="font-size: 15px; line-height: 1.8; color: #333;">
                        é«˜å¢é•¿çš„è¡¨è±¡ä¸‹å¾€å¾€æ½œä¼ç€ä¸¥é‡çš„ç»“æ„æ€§ä¾µèš€é£é™©ã€‚ä¼ä¸šçš„åˆ©æ¶¦è·å–é«˜åº¦ä¾èµ–å¤–éƒ¨ç¯å¢ƒå˜é‡æˆ–å•ç‚¹ä¸šåŠ¡æœºä¼šï¼Œç¼ºä¹å¯æ²‰æ·€çš„æˆ˜ç•¥èµ„äº§ä¸ç³»ç»ŸåŒ–çš„ç»„ç»‡æ”¯æ’‘ã€‚åœ¨è¯¥åˆ†å€¼åŒºé—´ï¼Œä½è½¬åŒ–æ•ˆç‡æ„å‘³ç€ç»è¥èƒ½é‡æ­£åœ¨é«˜ç†µçŠ¶æ€ä¸‹å¿«é€ŸæŸè€—ï¼Œä¼ä¸šåœ¨åŒè´¨åŒ–åšå¼ˆä¸­ææ˜“é™·å…¥"å¢äº§ä¸å¢æ”¶"çš„å›°å±€ã€‚è¿™ç§å¢é•¿æ˜¯ä¸å¯æŒç»­çš„ï¼Œå½“å‰éœ€ç«‹å³å¯åŠ¨åº•å±‚å¢é•¿å¼•æ“çš„è¯Šæ–­ä¸é‡æ„ï¼Œå®Œæˆç”±"æœºä¼šé©±åŠ¨"å‘"ç»“æ„é©±åŠ¨"çš„æˆ˜ç•¥è½¬å‹ã€‚
                    </p>
                `;
            }
            
            container.innerHTML = diagnosis;
        }

        // ç»˜åˆ¶é›·è¾¾å›¾
        async function drawRadarChart(dimensionScores) {
            // ç¡®ä¿ Chart.js å·²åŠ è½½
            if (typeof Chart === 'undefined') {
                console.log('ç­‰å¾… Chart.js åŠ è½½...');
                try {
                    await loadChartJS();
                } catch (error) {
                    console.error('Chart.js åŠ è½½å¤±è´¥:', error);
                    const chartContainer = document.getElementById('radarChart');
                    if (chartContainer && chartContainer.parentElement) {
                        chartContainer.parentElement.innerHTML = 
                            '<div style="padding: 40px; text-align: center; background: #fff; border-radius: 8px;">' +
                            '<p style="color: #f44336; font-size: 16px; margin-bottom: 10px; font-weight: 500;">å›¾è¡¨åº“åŠ è½½å¤±è´¥</p>' +
                            '<p style="color: #666; margin-bottom: 20px; font-size: 14px;">è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ååˆ·æ–°é¡µé¢</p>' +
                            '<button onclick="location.reload()" style="padding: 12px 24px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; transition: background 0.3s;">åˆ·æ–°é¡µé¢</button>' +
                            '</div>';
                    }
                    throw error;
                }
            }
            
            const chartElement = document.getElementById('radarChart');
            if (!chartElement) {
                console.error('æ‰¾ä¸åˆ°é›·è¾¾å›¾å®¹å™¨å…ƒç´ ');
                return;
            }
            
            const ctx = chartElement.getContext('2d');
            
            if (radarChart) {
                radarChart.destroy();
            }

            radarChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: dimensions,
                    datasets: [{
                        label: 'ç»“æ„å¾—åˆ†',
                        data: dimensions.map(dim => dimensionScores[dim]),
                        backgroundColor: 'rgba(102, 126, 234, 0.2)',
                        borderColor: 'rgba(102, 126, 234, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(102, 126, 234, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(102, 126, 234, 1)'
                    }]
                },
                options: {
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 5,  // ä»10æ”¹ä¸º5
                            ticks: {
                                stepSize: 1  // ä»2æ”¹ä¸º1
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // æ˜¾ç¤ºç»“æ„å¾—åˆ†
        function displayDimensionScores(dimensionScores) {
            const container = document.getElementById('dimensionScores');
            container.innerHTML = dimensions.map(dim => `
                <div class="dimension-score-item">
                    <div class="name">${dim}ç»“æ„</div>
                    <div class="score">${dimensionScores[dim].toFixed(1)}åˆ†</div>
                </div>
            `).join('');
        }


        // ç”ŸæˆPDFæŠ¥å‘Š
        function generatePDFReport(data) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // è®¾ç½®å­—ä½“å¤§å°
            doc.setFontSize(20);
            // ä½¿ç”¨è‹±æ–‡æ ‡é¢˜é¿å…ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜ï¼Œæˆ–ä½¿ç”¨æ”¯æŒä¸­æ–‡çš„å­—ä½“
            doc.text('Enterprise Competitiveness Assessment Report', 105, 20, { align: 'center' });

            doc.setFontSize(12);
            doc.text(`Name: ${data.userName}`, 20, 40);
            doc.text(`Company: ${data.companyName}`, 20, 50);
            doc.text(`Phone: ${data.userPhone}`, 20, 60);

            doc.setFontSize(16);
            doc.text('Assessment Results', 20, 80);

            doc.setFontSize(12);
            doc.text(`Enterprise Type: ${data.results.enterpriseType}`, 20, 95);
            doc.text(`CBI Index: ${data.results.CBI.toFixed(2)}`, 20, 105);
            doc.text(`Performance Avg: ${data.results.P_avg.toFixed(2)}`, 20, 115);
            doc.text(`Organization Avg: ${data.results.O_avg.toFixed(2)}`, 20, 125);
            doc.text(`Barrier Avg: ${data.results.B_avg.toFixed(2)}`, 20, 135);
            doc.text(`Digitalization Avg: ${data.results.D_avg.toFixed(2)}`, 20, 145);

            doc.setFontSize(14);
            doc.text('Dimension Scores', 20, 160);
            
            let yPos = 170;
            dimensions.forEach(dim => {
                doc.setFontSize(12);
                doc.text(`${dim}: ${data.results.dimensionScores[dim].toFixed(1)}`, 20, yPos);
                yPos += 10;
            });

            doc.setFontSize(12);
            // å°†ä¸­æ–‡æè¿°è½¬æ¢ä¸ºè‹±æ–‡æˆ–ä½¿ç”¨æ”¯æŒä¸­æ–‡çš„åº“
            const descEn = data.results.typeDesc.length > 100 
                ? data.results.typeDesc.substring(0, 100) + '...'
                : data.results.typeDesc;
            doc.text(descEn, 20, yPos + 10, { maxWidth: 170 });

            // ä¿å­˜PDF
            const fileName = `Competitiveness_Report_${data.userName}_${new Date().getTime()}.pdf`;
            doc.save(fileName);
            
            alert('PDFæŠ¥å‘Šå·²ç”Ÿæˆå¹¶ä¸‹è½½ï¼\nPDF report has been generated and downloaded!');
        }

        // å°è¯•ä»CSVæ–‡ä»¶åŠ è½½é¢˜ç›®ï¼ˆéœ€è¦æœåŠ¡å™¨ç¯å¢ƒï¼‰
        async function loadQuestionsFromCSV() {
            try {
                // è¿™é‡Œéœ€è¦æ ¹æ®å®é™…çš„CSVæ–‡ä»¶ç»“æ„æ¥è§£æ
                // ç”±äºæµè§ˆå™¨å®‰å…¨é™åˆ¶ï¼Œå¯èƒ½éœ€è¦åç«¯æ”¯æŒæˆ–æ‰‹åŠ¨è¾“å…¥
                console.log('éœ€è¦ä»CSVæ–‡ä»¶åŠ è½½é¢˜ç›®');
            } catch (error) {
                console.error('åŠ è½½é¢˜ç›®å¤±è´¥:', error);
            }
        }
    </script>
</body>
</html>
